(function(d){var b,c;d.uaMatch=function(f){f=f.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(f)||/(webkit)[ \/]([\w.]+)/.exec(f)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(f)||/(msie) ([\w.]+)/.exec(f)||f.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(f)||[];return{browser:e[1]||"",version:e[2]||"0"}};if(!d.browser){b=d.uaMatch(navigator.userAgent);c={};if(b.browser){c[b.browser]=true;c.version=b.version}if(c.chrome){c.webkit=true}else{if(c.webkit){c.safari=true}}d.browser=c}}(jQuery));
/*!
 * Patch for deprecated jQuery internal handlers
 */
jQuery.event.handle=jQuery.event.dispatch;(function(b){b.extend(b.fn,{validate:function(c){if(!this.length){c&&c.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return}var d=b.data(this[0],"validator");if(d){return d}this.attr("novalidate","novalidate");d=new b.validator(c,this[0]);b.data(this[0],"validator",d);if(d.settings.onsubmit){var e=this.find("input, button");e.filter(".cancel").click(function(){d.cancelSubmit=true});if(d.settings.submitHandler){e.filter(":submit").click(function(){d.submitButton=this})}this.submit(function(f){if(d.settings.debug){f.preventDefault()}function g(){if(d.settings.submitHandler){if(d.submitButton){var h=b("<input type='hidden'/>").attr("name",d.submitButton.name).val(d.submitButton.value).appendTo(d.currentForm)}d.settings.submitHandler.call(d,d.currentForm);if(d.submitButton){h.remove()}return false}return true}if(d.cancelSubmit){d.cancelSubmit=false;return g()}if(d.form()){if(d.pendingRequest){d.formSubmitted=true;return false}return g()}else{d.focusInvalid();return false}})}return d},valid:function(){if(b(this[0]).is("form")){return this.validate().form()}else{var d=true;var c=b(this[0].form).validate();this.each(function(){d&=c.element(this)});return d}},removeAttrs:function(e){var c={},d=this;b.each(e.split(/\s/),function(f,g){c[g]=d.attr(g);d.removeAttr(g)});return c},rules:function(f,c){var h=this[0];if(f){var e=b.data(h.form,"validator").settings;var k=e.rules;var l=b.validator.staticRules(h);switch(f){case"add":b.extend(l,b.validator.normalizeRule(c));k[h.name]=l;if(c.messages){e.messages[h.name]=b.extend(e.messages[h.name],c.messages)}break;case"remove":if(!c){delete k[h.name];return l}var j={};b.each(c.split(/\s/),function(m,n){j[n]=l[n];delete l[n]});return j}}var g=b.validator.normalizeRules(b.extend({},b.validator.metadataRules(h),b.validator.classRules(h),b.validator.attributeRules(h),b.validator.staticRules(h)),h);if(g.required){var d=g.required;delete g.required;g=b.extend({required:d},g)}return g}});b.extend(b.expr[":"],{blank:function(c){return !b.trim(""+c.value)},filled:function(c){return !!b.trim(""+c.value)},unchecked:function(c){return !c.checked}});b.validator=function(c,d){this.settings=b.extend(true,{},b.validator.defaults,c);this.currentForm=d;this.init()};b.validator.format=function(c,d){if(arguments.length==1){return function(){var e=b.makeArray(arguments);e.unshift(c);return b.validator.format.apply(this,e)}}if(arguments.length>2&&d.constructor!=Array){d=b.makeArray(arguments).slice(1)}if(d.constructor!=Array){d=[d]}b.each(d,function(e,f){c=c.replace(new RegExp("\\{"+e+"\\}","g"),f)});return c};b.extend(b.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:b([]),errorLabelContainer:b([]),onsubmit:true,ignore:":hidden",ignoreTitle:false,onfocusin:function(c,d){this.lastActive=c;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,c,this.settings.errorClass,this.settings.validClass);this.addWrapper(this.errorsFor(c)).hide()}},onfocusout:function(c,d){if(!this.checkable(c)&&(c.name in this.submitted||!this.optional(c))){this.element(c)}},onkeyup:function(c,d){if(c.name in this.submitted||c==this.lastElement){this.element(c)}},onclick:function(c,d){if(c.name in this.submitted){this.element(c)}else{if(c.parentNode.name in this.submitted){this.element(c.parentNode)}}},highlight:function(e,c,d){if(e.type==="radio"){this.findByName(e.name).addClass(c).removeClass(d)}else{b(e).addClass(c).removeClass(d)}},unhighlight:function(e,c,d){if(e.type==="radio"){this.findByName(e.name).removeClass(c).addClass(d)}else{b(e).removeClass(c).addClass(d)}}},setDefaults:function(c){b.extend(b.validator.defaults,c)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:b.validator.format("Please enter no more than {0} characters."),minlength:b.validator.format("Please enter at least {0} characters."),rangelength:b.validator.format("Please enter a value between {0} and {1} characters long."),range:b.validator.format("Please enter a value between {0} and {1}."),max:b.validator.format("Please enter a value less than or equal to {0}."),min:b.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=b(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||b(this.currentForm);this.containers=b(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var c=(this.groups={});b.each(this.settings.groups,function(f,g){b.each(g.split(/\s/),function(j,h){c[h]=f})});var e=this.settings.rules;b.each(e,function(f,g){e[f]=b.validator.normalizeRule(g)});function d(h){var g=b.data(this[0].form,"validator"),f="on"+h.type.replace(/^validate/,"");g.settings[f]&&g.settings[f].call(g,this[0],h)}b(this.currentForm).validateDelegate("[type='text'], [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",d).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",d);if(this.settings.invalidHandler){b(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)}},form:function(){this.checkForm();b.extend(this.submitted,this.errorMap);this.invalid=b.extend({},this.errorMap);if(!this.valid()){b(this.currentForm).triggerHandler("invalid-form",[this])}this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var c=0,d=(this.currentElements=this.elements());d[c];c++){this.check(d[c])}return this.valid()},element:function(d){d=this.validationTargetFor(this.clean(d));this.lastElement=d;this.prepareElement(d);this.currentElements=b(d);var c=this.check(d);if(c){delete this.invalid[d.name]}else{this.invalid[d.name]=true}if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers)}this.showErrors();return c},showErrors:function(d){if(d){b.extend(this.errorMap,d);this.errorList=[];for(var c in d){this.errorList.push({message:d[c],element:this.findByName(c)[0]})}this.successList=b.grep(this.successList,function(e){return !(e.name in d)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){if(b.fn.resetForm){b(this.currentForm).resetForm()}this.submitted={};this.lastElement=null;this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(e){var d=0;for(var c in e){d++}return d},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid){try{b(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(c){}}},findLastActive:function(){var c=this.lastActive;return c&&b.grep(this.errorList,function(d){return d.element.name==c.name}).length==1&&c},elements:function(){var d=this,c={};return b(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&d.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in c||!d.objectLength(b(this).rules())){return false}c[this.name]=true;return true})},clean:function(c){return b(c)[0]},errors:function(){return b(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=b([]);this.toHide=b([]);this.currentElements=b([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},prepareElement:function(c){this.reset();this.toHide=this.errorsFor(c)},check:function(d){d=this.validationTargetFor(this.clean(d));var j=b(d).rules();var f=false;for(var k in j){var h={method:k,parameters:j[k]};try{var c=b.validator.methods[k].call(this,d.value.replace(/\r/g,""),d,h.parameters);if(c=="dependency-mismatch"){f=true;continue}f=false;if(c=="pending"){this.toHide=this.toHide.not(this.errorsFor(d));return}if(!c){this.formatAndAdd(d,h);return false}}catch(g){this.settings.debug&&window.console&&console.log("exception occured when checking element "+d.id+", check the '"+h.method+"' method",g);throw g}}if(f){return}if(this.objectLength(j)){this.successList.push(d)}return true},customMetaMessage:function(c,e){if(!b.metadata){return}var d=this.settings.meta?b(c).metadata()[this.settings.meta]:b(c).metadata();return d&&d.messages&&d.messages[e]},customMessage:function(d,e){var c=this.settings.messages[d];return c&&(c.constructor==String?c:c[e])},findDefined:function(){for(var c=0;c<arguments.length;c++){if(arguments[c]!==undefined){return arguments[c]}}return undefined},defaultMessage:function(c,d){return this.findDefined(this.customMessage(c.name,d),this.customMetaMessage(c,d),!this.settings.ignoreTitle&&c.title||undefined,b.validator.messages[d],"<strong>Warning: No message defined for "+c.name+"</strong>")},formatAndAdd:function(d,f){var e=this.defaultMessage(d,f.method),c=/\$?\{(\d+)\}/g;if(typeof e=="function"){e=e.call(this,f.parameters,d)}else{if(c.test(e)){e=jQuery.format(e.replace(c,"{$1}"),f.parameters)}}this.errorList.push({message:e,element:d});this.errorMap[d.name]=e;this.submitted[d.name]=e},addWrapper:function(c){if(this.settings.wrapper){c=c.add(c.parent(this.settings.wrapper))}return c},defaultShowErrors:function(){for(var d=0;this.errorList[d];d++){var c=this.errorList[d];this.settings.highlight&&this.settings.highlight.call(this,c.element,this.settings.errorClass,this.settings.validClass);this.showLabel(c.element,c.message)}if(this.errorList.length){this.toShow=this.toShow.add(this.containers)}if(this.settings.success){for(var d=0;this.successList[d];d++){this.showLabel(this.successList[d])}}if(this.settings.unhighlight){for(var d=0,e=this.validElements();e[d];d++){this.settings.unhighlight.call(this,e[d],this.settings.errorClass,this.settings.validClass)}}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return b(this.errorList).map(function(){return this.element})},showLabel:function(d,e){var c=this.errorsFor(d);if(c.length){c.removeClass(this.settings.validClass).addClass(this.settings.errorClass);c.attr("generated")&&c.html(e)}else{c=b("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(d),generated:true}).addClass(this.settings.errorClass).html(e||"");if(this.settings.wrapper){c=c.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()}if(!this.labelContainer.append(c).length){this.settings.errorPlacement?this.settings.errorPlacement(c,b(d)):c.insertAfter(d)}}if(!e&&this.settings.success){c.text("");typeof this.settings.success=="string"?c.addClass(this.settings.success):this.settings.success(c)}this.toShow=this.toShow.add(c)},errorsFor:function(d){var c=this.idOrName(d);return this.errors().filter(function(){return b(this).attr("for")==c})},idOrName:function(c){return this.groups[c.name]||(this.checkable(c)?c.name:c.id||c.name)},validationTargetFor:function(c){if(this.checkable(c)){c=this.findByName(c.name).not(this.settings.ignore)[0]}return c},checkable:function(c){return/radio|checkbox/i.test(c.type)},findByName:function(c){var d=this.currentForm;return b(document.getElementsByName(c)).map(function(e,f){return f.form==d&&f.name==c&&f||null})},getLength:function(d,c){switch(c.nodeName.toLowerCase()){case"select":return b("option:selected",c).length;case"input":if(this.checkable(c)){return this.findByName(c.name).filter(":checked").length}}return d.length},depend:function(d,c){return this.dependTypes[typeof d]?this.dependTypes[typeof d](d,c):true},dependTypes:{"boolean":function(d,c){return d},string:function(d,c){return !!b(d,c.form).length},"function":function(d,c){return d(c)}},optional:function(c){return !b.validator.methods.required.call(this,b.trim(c.value),c)&&"dependency-mismatch"},startRequest:function(c){if(!this.pending[c.name]){this.pendingRequest++;this.pending[c.name]=true}},stopRequest:function(c,d){this.pendingRequest--;if(this.pendingRequest<0){this.pendingRequest=0}delete this.pending[c.name];if(d&&this.pendingRequest==0&&this.formSubmitted&&this.form()){b(this.currentForm).submit();this.formSubmitted=false}else{if(!d&&this.pendingRequest==0&&this.formSubmitted){b(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false}}},previousValue:function(c){return b.data(c,"previousValue")||b.data(c,"previousValue",{old:null,valid:true,message:this.defaultMessage(c,"remote")})}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(c,d){c.constructor==String?this.classRuleSettings[c]=d:b.extend(this.classRuleSettings,c)},classRules:function(d){var e={};var c=b(d).attr("class");c&&b.each(c.split(" "),function(){if(this in b.validator.classRuleSettings){b.extend(e,b.validator.classRuleSettings[this])}});return e},attributeRules:function(d){var f={};var c=b(d);for(var g in b.validator.methods){var e;if(g==="required"&&typeof b.fn.prop==="function"){e=c.prop(g)}else{e=c.attr(g)}if(e){f[g]=e}else{if(c[0].getAttribute("type")===g){f[g]=true}}}if(f.maxlength&&/-1|2147483647|524288/.test(f.maxlength)){delete f.maxlength}return f},metadataRules:function(c){if(!b.metadata){return{}}var d=b.data(c.form,"validator").settings.meta;return d?b(c).metadata()[d]:b(c).metadata()},staticRules:function(d){var e={};var c=b.data(d.form,"validator");if(c.settings.rules){e=b.validator.normalizeRule(c.settings.rules[d.name])||{}}return e},normalizeRules:function(d,c){b.each(d,function(g,f){if(f===false){delete d[g];return}if(f.param||f.depends){var e=true;switch(typeof f.depends){case"string":e=!!b(f.depends,c.form).length;break;case"function":e=f.depends.call(c,c);break}if(e){d[g]=f.param!==undefined?f.param:true}else{delete d[g]}}});b.each(d,function(e,f){d[e]=b.isFunction(f)?f(c):f});b.each(["minlength","maxlength","min","max"],function(){if(d[this]){d[this]=Number(d[this])}});b.each(["rangelength","range"],function(){if(d[this]){d[this]=[Number(d[this][0]),Number(d[this][1])]}});if(b.validator.autoCreateRanges){if(d.min&&d.max){d.range=[d.min,d.max];delete d.min;delete d.max}if(d.minlength&&d.maxlength){d.rangelength=[d.minlength,d.maxlength];delete d.minlength;delete d.maxlength}}if(d.messages){delete d.messages}return d},normalizeRule:function(d){if(typeof d=="string"){var c={};b.each(d.split(/\s/),function(){c[this]=true});d=c}return d},addMethod:function(c,e,d){b.validator.methods[c]=e;b.validator.messages[c]=d!=undefined?d:b.validator.messages[c];if(e.length<3){b.validator.addClassRules(c,b.validator.normalizeRule(c))}},methods:{required:function(d,c,f){if(!this.depend(f,c)){return"dependency-mismatch"}switch(c.nodeName.toLowerCase()){case"select":var e=b(c).val();return e&&e.length>0;case"input":if(this.checkable(c)){return this.getLength(d,c)>0}default:return b.trim(d).length>0}},remote:function(g,d,h){if(this.optional(d)){return"dependency-mismatch"}var e=this.previousValue(d);if(!this.settings.messages[d.name]){this.settings.messages[d.name]={}}e.originalMessage=this.settings.messages[d.name].remote;this.settings.messages[d.name].remote=e.message;h=typeof h=="string"&&{url:h}||h;if(this.pending[d.name]){return"pending"}if(e.old===g){return e.valid}e.old=g;var c=this;this.startRequest(d);var f={};f[d.name]=g;b.ajax(b.extend(true,{url:h,mode:"abort",port:"validate"+d.name,dataType:"json",data:f,success:function(k){c.settings.messages[d.name].remote=e.originalMessage;var m=k===true;if(m){var j=c.formSubmitted;c.prepareElement(d);c.formSubmitted=j;c.successList.push(d);c.showErrors()}else{var n={};var l=k||c.defaultMessage(d,"remote");n[d.name]=e.message=b.isFunction(l)?l(g):l;c.showErrors(n)}e.valid=m;c.stopRequest(d,m)}},h));return"pending"},minlength:function(d,c,e){return this.optional(c)||this.getLength(b.trim(d),c)>=e},maxlength:function(d,c,e){return this.optional(c)||this.getLength(b.trim(d),c)<=e},rangelength:function(e,c,f){var d=this.getLength(b.trim(e),c);return this.optional(c)||(d>=f[0]&&d<=f[1])},min:function(d,c,e){return this.optional(c)||d>=e},max:function(d,c,e){return this.optional(c)||d<=e},range:function(d,c,e){return this.optional(c)||(d>=e[0]&&d<=e[1])},email:function(d,c){return this.optional(c)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(d)},url:function(d,c){return this.optional(c)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(d)},date:function(d,c){return this.optional(c)||!/Invalid|NaN/.test(new Date(d))},dateISO:function(d,c){return this.optional(c)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(d)},number:function(d,c){return this.optional(c)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(d)},digits:function(d,c){return this.optional(c)||/^\d+$/.test(d)},creditcard:function(g,d){if(this.optional(d)){return"dependency-mismatch"}if(/[^0-9 -]+/.test(g)){return false}var h=0,f=0,c=false;g=g.replace(/\D/g,"");for(var j=g.length-1;j>=0;j--){var e=g.charAt(j);var f=parseInt(e,10);if(c){if((f*=2)>9){f-=9}}h+=f;c=!c}return(h%10)==0},accept:function(d,c,e){e=typeof e=="string"?e.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(c)||d.match(new RegExp(".("+e+")$","i"))},equalTo:function(d,c,f){var e=b(f).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){b(c).valid()});return d==e.val()}}});b.format=b.validator.format})(jQuery);(function(d){var b={};if(d.ajaxPrefilter){d.ajaxPrefilter(function(g,f,h){var e=g.port;if(g.mode=="abort"){if(b[e]){b[e].abort()}b[e]=h}})}else{var c=d.ajax;d.ajax=function(f){var g=("mode" in f?f:d.ajaxSettings).mode,e=("port" in f?f:d.ajaxSettings).port;if(g=="abort"){if(b[e]){b[e].abort()}return(b[e]=c.apply(this,arguments))}return c.apply(this,arguments)}}})(jQuery);(function(b){if(!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener){b.each({focus:"focusin",blur:"focusout"},function(d,c){b.event.special[c]={setup:function(){this.addEventListener(d,e,true)},teardown:function(){this.removeEventListener(d,e,true)},handler:function(f){arguments[0]=b.event.fix(f);arguments[0].type=c;return b.event.handle.apply(this,arguments)}};function e(f){f=b.event.fix(f);f.type=c;return b.event.handle.call(this,f)}})}b.extend(b.fn,{validateDelegate:function(e,d,c){return this.bind(d,function(f){var g=b(f.target);if(g.is(e)){return c.apply(g,arguments)}})}})})(jQuery);
/*!
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function(b){if(typeof define==="function"&&define.amd){define(["jquery"],b)}else{b(jQuery)}}(function(f){var b=/\+/g;function e(h){return h}function c(h){return decodeURIComponent(h.replace(b," "))}function g(h){if(h.indexOf('"')===0){h=h.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{return d.json?JSON.parse(h):h}catch(j){}}var d=f.cookie=function(q,p,w){if(p!==undefined){w=f.extend({},d.defaults,w);if(typeof w.expires==="number"){var r=w.expires,v=w.expires=new Date();v.setDate(v.getDate()+r)}p=d.json?JSON.stringify(p):String(p);return(document.cookie=[d.raw?q:encodeURIComponent(q),"=",d.raw?p:encodeURIComponent(p),w.expires?"; expires="+w.expires.toUTCString():"",w.path?"; path="+w.path:"",w.domain?"; domain="+w.domain:"",w.secure?"; secure":""].join(""))}var h=d.raw?e:c;var u=document.cookie.split("; ");var x=q?undefined:{};for(var o=0,m=u.length;o<m;o++){var n=u[o].split("=");var j=h(n.shift());var k=h(n.join("="));if(q&&q===j){x=g(k);break}if(!q){x[j]=g(k)}}return x};d.defaults={};f.removeCookie=function(j,h){if(f.cookie(j)!==undefined){f.cookie(j,"",f.extend({},h,{expires:-1}));return true}return false}}));
/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
(function(e){var c=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks){for(var b=c.length;b;){e.event.fixHooks[c[--b]]=e.event.mouseHooks}}e.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var f=c.length;f;){this.addEventListener(c[--f],d,false)}}else{this.onmousewheel=d}},teardown:function(){if(this.removeEventListener){for(var f=c.length;f;){this.removeEventListener(c[--f],d,false)}}else{this.onmousewheel=null}}};e.fn.extend({mousewheel:function(f){return f?this.bind("mousewheel",f):this.trigger("mousewheel")},unmousewheel:function(f){return this.unbind("mousewheel",f)}});function d(l){var j=l||window.event,h=[].slice.call(arguments,1),m=0,k=true,g=0,f=0;l=e.event.fix(j);l.type="mousewheel";if(j.wheelDelta){m=j.wheelDelta/120}if(j.detail){m=-j.detail/3}f=m;if(j.axis!==undefined&&j.axis===j.HORIZONTAL_AXIS){f=0;g=-1*m}if(j.wheelDeltaY!==undefined){f=j.wheelDeltaY/120}if(j.wheelDeltaX!==undefined){g=-1*j.wheelDeltaX/120}h.unshift(l,m,g,f);return(e.event.dispatch||e.event.handle).apply(this,h)}})(jQuery);(function(f){f.support.touch="ontouchend" in document;if(!f.support.touch){return}var k=f.ui.mouse.prototype,h=k._mouseInit,g;function j(d,c){if(d.originalEvent.touches.length>1){return}d.preventDefault();var b=d.originalEvent.changedTouches[0],e=document.createEvent("MouseEvents");e.initMouseEvent(c,true,true,window,1,b.screenX,b.screenY,b.clientX,b.clientY,false,false,false,false,0,null);d.target.dispatchEvent(e)}k._touchStart=function(b){var c=this;if(g||!c._mouseCapture(b.originalEvent.changedTouches[0])){return}g=true;c._touchMoved=false;j(b,"mouseover");j(b,"mousemove");j(b,"mousedown")};k._touchMove=function(b){if(!g){return}this._touchMoved=true;j(b,"mousemove")};k._touchEnd=function(b){if(!g){return}j(b,"mouseup");j(b,"mouseout");if(!this._touchMoved){j(b,"click")}g=false};k._mouseInit=function(){var b=this;b.element.bind("touchstart",f.proxy(b,"_touchStart")).bind("touchmove",f.proxy(b,"_touchMove")).bind("touchend",f.proxy(b,"_touchEnd"));h.call(b)}})(jQuery);
/*!
 * :::Extracted, linted, cleaned + lightly modified from:::
 * jQuery BBQ: Back Button & Query Library - v1.3pre - 8/26/2010
 * http://benalman.com/projects/jquery-bbq-plugin/
 * :::::::::::::::::::::::::::::::::::<3, Liam:::::::::::::
 */
(function(c,b){c.deparam=function(f){var e={},d=b.decodeURIComponent;c.each(f.replace(/\+/g," ").split("&"),function(k,p){var h=p.split("="),o=d(h[0]),g,n=e,l,q=o.split("]["),m=q.length-1;if(/\[/.test(q[0])&&/\]$/.test(q[m])){q[m]=q[m].replace(/\]$/,"");q=q.shift().split("[").concat(q);m=q.length-1}else{m=0}if(h.length===2){g=d(h[1]);if(m){for(l=0;l<=m;l+=1){o=q[l]===""?n.length:q[l];n=n[o]=l<m?n[o]||(q[l+1]&&isNaN(q[l+1])?{}:[]):g}}else{if(c.isArray(e[o])){e[o].push(g)}else{if(e[o]!==undefined){e[o]=[e[o],g]}else{e[o]=g}}}}else{if(o){e[o]=""}}});return e}}(jQuery,this));+function(c){var d=function(f,e){this.$element=c(f);this.options=c.extend({},d.DEFAULTS,e);this.transitioning=null;if(this.options.parent){this.$parent=c(this.options.parent)}if(this.options.toggle){this.toggle()}};d.DEFAULTS={toggle:true};d.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"};d.prototype.show=function(){if(this.transitioning||this.$element.hasClass("in")){return}var f=c.Event("show.bs.collapse");this.$element.trigger(f);if(f.isDefaultPrevented()){return}var j=this.$parent&&this.$parent.find("> .panel > .in");if(j&&j.length){var g=j.data("bs.collapse");if(g&&g.transitioning){return}j.collapse("hide");g||j.data("bs.collapse",null)}var k=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[k](0);this.transitioning=1;var e=function(){this.$element.removeClass("collapsing").addClass("in")[k]("auto");this.transitioning=0;this.$element.trigger("shown.bs.collapse")};if(!c.support.transition){return e.call(this)}var h=c.camelCase(["scroll",k].join("-"));this.$element.one(c.support.transition.end,c.proxy(e,this)).emulateTransitionEnd(350)[k](this.$element[0][h])};d.prototype.hide=function(){if(this.transitioning||!this.$element.hasClass("in")){return}var f=c.Event("hide.bs.collapse");this.$element.trigger(f);if(f.isDefaultPrevented()){return}var g=this.dimension();this.$element[g](this.$element[g]())[0].offsetHeight;this.$element.addClass("collapsing").removeClass("collapse").removeClass("in");this.transitioning=1;var e=function(){this.transitioning=0;this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};if(!c.support.transition){return e.call(this)}this.$element[g](0).one(c.support.transition.end,c.proxy(e,this)).emulateTransitionEnd(350)};d.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var b=c.fn.collapse;c.fn.collapse=function(e){return this.each(function(){var h=c(this);var g=h.data("bs.collapse");var f=c.extend({},d.DEFAULTS,h.data(),typeof e=="object"&&e);if(!g){h.data("bs.collapse",(g=new d(this,f)))}if(typeof e=="string"){g[e]()}})};c.fn.collapse.Constructor=d;c.fn.collapse.noConflict=function(){c.fn.collapse=b;return this};c(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(l){var n=c(this),f;var m=n.attr("data-target")||l.preventDefault()||(f=n.attr("href"))&&f.replace(/.*(?=#[^\s]+$)/,"");var g=c(m);var j=g.data("bs.collapse");var k=j?"toggle":n.data();var o=n.attr("data-parent");var h=o&&c(o);if(!j||!j.transitioning){if(h){h.find('[data-toggle=collapse][data-parent="'+o+'"]').not(n).addClass("collapsed")}n[g.hasClass("in")?"addClass":"removeClass"]("collapsed")}g.collapse(k)})}(jQuery);+function(h){var f=".dropdown-backdrop";var c="[data-toggle=dropdown]";var b=function(j){h(j).on("click.bs.dropdown",this.toggle)};b.prototype.toggle=function(m){var l=h(this);if(l.is(".disabled, :disabled")){return}var k=g(l);var j=k.hasClass("open");e();if(!j){if("ontouchstart" in document.documentElement&&!k.closest(".navbar-nav").length){h('<div class="dropdown-backdrop"/>').insertAfter(h(this)).on("click",e)}k.trigger(m=h.Event("show.bs.dropdown"));if(m.isDefaultPrevented()){return}k.toggleClass("open").trigger("shown.bs.dropdown");l.focus()}return false};b.prototype.keydown=function(n){if(!/(38|40|27)/.test(n.keyCode)){return}var m=h(this);n.preventDefault();n.stopPropagation();if(m.is(".disabled, :disabled")){return}var l=g(m);var k=l.hasClass("open");if(!k||(k&&n.keyCode==27)){if(n.which==27){l.find(c).focus()}return m.click()}var o=h("[role=menu] li:not(.divider):visible a",l);if(!o.length){return}var j=o.index(o.filter(":focus"));if(n.keyCode==38&&j>0){j--}if(n.keyCode==40&&j<o.length-1){j++}if(!~j){j=0}o.eq(j).focus()};function e(){h(f).remove();h(c).each(function(k){var j=g(h(this));if(!j.hasClass("open")){return}j.trigger(k=h.Event("hide.bs.dropdown"));if(k.isDefaultPrevented()){return}j.removeClass("open").trigger("hidden.bs.dropdown")})}function g(l){var j=l.attr("data-target");if(!j){j=l.attr("href");j=j&&/#/.test(j)&&j.replace(/.*(?=#[^\s]*$)/,"")}var k=j&&h(j);return k&&k.length?k:l.parent()}var d=h.fn.dropdown;h.fn.dropdown=function(j){return this.each(function(){var l=h(this);var k=l.data("bs.dropdown");if(!k){l.data("bs.dropdown",(k=new b(this)))}if(typeof j=="string"){k[j].call(l)}})};h.fn.dropdown.Constructor=b;h.fn.dropdown.noConflict=function(){h.fn.dropdown=d;return this};h(document).on("click.bs.dropdown.data-api",e).on("click.bs.dropdown.data-api",".dropdown form",function(j){j.stopPropagation()}).on("click.bs.dropdown.data-api",c,b.prototype.toggle).on("keydown.bs.dropdown.data-api",c+", [role=menu]",b.prototype.keydown)}(jQuery);+function(d){var c=function(f,e){this.options=e;this.$element=d(f);this.$backdrop=this.isShown=null;if(this.options.remote){this.$element.load(this.options.remote)}};c.DEFAULTS={backdrop:true,keyboard:true,show:true};c.prototype.toggle=function(e){return this[!this.isShown?"show":"hide"](e)};c.prototype.show=function(h){var f=this;var g=d.Event("show.bs.modal",{relatedTarget:h});this.$element.trigger(g);if(this.isShown||g.isDefaultPrevented()){return}this.isShown=true;this.escape();this.$element.on("click.dismiss.modal",'[data-dismiss="modal"]',d.proxy(this.hide,this));this.backdrop(function(){var k=d.support.transition&&f.$element.hasClass("fade");if(!f.$element.parent().length){f.$element.appendTo(document.body)}f.$element.show();if(k){f.$element[0].offsetWidth}f.$element.addClass("in").attr("aria-hidden",false);f.enforceFocus();var j=d.Event("shown.bs.modal",{relatedTarget:h});k?f.$element.find(".modal-dialog").one(d.support.transition.end,function(){f.$element.focus().trigger(j)}).emulateTransitionEnd(300):f.$element.focus().trigger(j)})};c.prototype.hide=function(f){if(f){f.preventDefault()}f=d.Event("hide.bs.modal");this.$element.trigger(f);if(!this.isShown||f.isDefaultPrevented()){return}this.isShown=false;this.escape();d(document).off("focusin.bs.modal");this.$element.removeClass("in").attr("aria-hidden",true).off("click.dismiss.modal");d.support.transition&&this.$element.hasClass("fade")?this.$element.one(d.support.transition.end,d.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal()};c.prototype.enforceFocus=function(){d(document).off("focusin.bs.modal").on("focusin.bs.modal",d.proxy(function(f){if(this.$element[0]!==f.target&&!this.$element.has(f.target).length){this.$element.focus()}},this))};c.prototype.escape=function(){if(this.isShown&&this.options.keyboard){this.$element.on("keyup.dismiss.bs.modal",d.proxy(function(f){f.which==27&&this.hide()},this))}else{if(!this.isShown){this.$element.off("keyup.dismiss.bs.modal")}}};c.prototype.hideModal=function(){var e=this;this.$element.hide();this.backdrop(function(){e.removeBackdrop();e.$element.trigger("hidden.bs.modal")})};c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove();this.$backdrop=null};c.prototype.backdrop=function(h){var g=this;var f=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var e=d.support.transition&&f;this.$backdrop=d('<div class="modal-backdrop '+f+'" />').appendTo(document.body);this.$element.on("click.dismiss.modal",d.proxy(function(j){if(j.target!==j.currentTarget){return}this.options.backdrop=="static"?this.$element[0].focus.call(this.$element[0]):this.hide.call(this)},this));if(e){this.$backdrop[0].offsetWidth}this.$backdrop.addClass("in");if(!h){return}e?this.$backdrop.one(d.support.transition.end,h).emulateTransitionEnd(150):h()}else{if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");d.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(d.support.transition.end,h).emulateTransitionEnd(150):h()}else{if(h){h()}}}};var b=d.fn.modal;d.fn.modal=function(e,f){return this.each(function(){var j=d(this);var h=j.data("bs.modal");var g=d.extend({},c.DEFAULTS,j.data(),typeof e=="object"&&e);if(!h){j.data("bs.modal",(h=new c(this,g)))}if(typeof e=="string"){h[e](f)}else{if(g.show){h.show(f)}}})};d.fn.modal.Constructor=c;d.fn.modal.noConflict=function(){d.fn.modal=b;return this};d(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(k){var j=d(this);var g=j.attr("href");var f=d(j.attr("data-target")||(g&&g.replace(/.*(?=#[^\s]+$)/,"")));var h=f.data("modal")?"toggle":d.extend({remote:!/#/.test(g)&&g},f.data(),j.data());k.preventDefault();f.modal(h,this).one("hide",function(){j.is(":visible")&&j.focus()})});d(document).on("show.bs.modal",".modal",function(){d(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){d(document.body).removeClass("modal-open")})}(jQuery);+function(c){function b(){var f=document.createElement("bootstrap");var e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var d in e){if(f.style[d]!==undefined){return{end:e[d]}}}}c.fn.emulateTransitionEnd=function(f){var e=false,d=this;c(this).one(c.support.transition.end,function(){e=true});var g=function(){if(!e){c(d).trigger(c.support.transition.end)}};setTimeout(g,f);return this};c(function(){c.support.transition=b()})}(jQuery);+function(d){var c=function(e){this.element=d(e)};c.prototype.show=function(){var l=this.element;var h=l.closest("ul:not(.dropdown-menu)");var g=l.data("target");if(!g){g=l.attr("href");g=g&&g.replace(/.*(?=#[^\s]*$)/,"")}if(l.parent("li").hasClass("active")){return}var j=h.find(".active:last a")[0];var k=d.Event("show.bs.tab",{relatedTarget:j});l.trigger(k);if(k.isDefaultPrevented()){return}var f=d(g);this.activate(l.parent("li"),h);this.activate(f,f.parent(),function(){l.trigger({type:"shown.bs.tab",relatedTarget:j})})};c.prototype.activate=function(g,f,k){var e=f.find("> .active");var j=k&&d.support.transition&&e.hasClass("fade");function h(){e.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");g.addClass("active");if(j){g[0].offsetWidth;g.addClass("in")}else{g.removeClass("fade")}if(g.parent(".dropdown-menu")){g.closest("li.dropdown").addClass("active")}k&&k()}j?e.one(d.support.transition.end,h).emulateTransitionEnd(150):h();e.removeClass("in")};var b=d.fn.tab;d.fn.tab=function(e){return this.each(function(){var g=d(this);var f=g.data("bs.tab");if(!f){g.data("bs.tab",(f=new c(this)))}if(typeof e=="string"){f[e]()}})};d.fn.tab.Constructor=c;d.fn.tab.noConflict=function(){d.fn.tab=b;return this};d(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(f){f.preventDefault();d(this).tab("show")})}(jQuery);+function(d){var c=function(f,e){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null;this.init("tooltip",f,e)};c.DEFAULTS={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:false,container:false};c.prototype.init=function(l,j,g){this.enabled=true;this.type=l;this.$element=d(j);this.options=this.getOptions(g);var k=this.options.trigger.split(" ");for(var h=k.length;h--;){var f=k[h];if(f=="click"){this.$element.on("click."+this.type,this.options.selector,d.proxy(this.toggle,this))}else{if(f!="manual"){var m=f=="hover"?"mouseenter":"focus";var e=f=="hover"?"mouseleave":"blur";this.$element.on(m+"."+this.type,this.options.selector,d.proxy(this.enter,this));this.$element.on(e+"."+this.type,this.options.selector,d.proxy(this.leave,this))}}}this.options.selector?(this._options=d.extend({},this.options,{trigger:"manual",selector:""})):this.fixTitle()};c.prototype.getDefaults=function(){return c.DEFAULTS};c.prototype.getOptions=function(e){e=d.extend({},this.getDefaults(),this.$element.data(),e);if(e.delay&&typeof e.delay=="number"){e.delay={show:e.delay,hide:e.delay}}return e};c.prototype.getDelegateOptions=function(){var e={};var f=this.getDefaults();this._options&&d.each(this._options,function(g,h){if(f[g]!=h){e[g]=h}});return e};c.prototype.enter=function(f){var e=f instanceof this.constructor?f:d(f.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(e.timeout);e.hoverState="in";if(!e.options.delay||!e.options.delay.show){return e.show()}e.timeout=setTimeout(function(){if(e.hoverState=="in"){e.show()}},e.options.delay.show)};c.prototype.leave=function(f){var e=f instanceof this.constructor?f:d(f.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);clearTimeout(e.timeout);e.hoverState="out";if(!e.options.delay||!e.options.delay.hide){return e.hide()}e.timeout=setTimeout(function(){if(e.hoverState=="out"){e.hide()}},e.options.delay.hide)};c.prototype.show=function(){var p=d.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(p);if(p.isDefaultPrevented()){return}var l=this.tip();this.setContent();if(this.options.animation){l.addClass("fade")}var k=typeof this.options.placement=="function"?this.options.placement.call(this,l[0],this.$element[0]):this.options.placement;var u=/\s?auto?\s?/i;var v=u.test(k);if(v){k=k.replace(u,"")||"top"}l.detach().css({top:0,left:0,display:"block"}).addClass(k);this.options.container?l.appendTo(this.options.container):l.insertAfter(this.$element);var q=this.getPosition();var f=l[0].offsetWidth;var n=l[0].offsetHeight;if(v){var j=this.$element.parent();var h=k;var r=document.documentElement.scrollTop||document.body.scrollTop;var t=this.options.container=="body"?window.innerWidth:j.outerWidth();var o=this.options.container=="body"?window.innerHeight:j.outerHeight();var m=this.options.container=="body"?0:j.offset().left;k=k=="bottom"&&q.top+q.height+n-r>o?"top":k=="top"&&q.top-r-n<0?"bottom":k=="right"&&q.right+f>t?"left":k=="left"&&q.left-f<m?"right":k;l.removeClass(h).addClass(k)}var g=this.getCalculatedOffset(k,q,f,n);this.applyPlacement(g,k);this.$element.trigger("shown.bs."+this.type)}};c.prototype.applyPlacement=function(k,l){var h;var m=this.tip();var g=m[0].offsetWidth;var p=m[0].offsetHeight;var f=parseInt(m.css("margin-top"),10);var j=parseInt(m.css("margin-left"),10);if(isNaN(f)){f=0}if(isNaN(j)){j=0}k.top=k.top+f;k.left=k.left+j;m.offset(k).addClass("in");var e=m[0].offsetWidth;var n=m[0].offsetHeight;if(l=="top"&&n!=p){h=true;k.top=k.top+p-n}if(/bottom|top/.test(l)){var o=0;if(k.left<0){o=k.left*-2;k.left=0;m.offset(k);e=m[0].offsetWidth;n=m[0].offsetHeight}this.replaceArrow(o-g+e,e,"left")}else{this.replaceArrow(n-p,n,"top")}if(h){m.offset(k)}};c.prototype.replaceArrow=function(g,f,e){this.arrow().css(e,g?(50*(1-g/f)+"%"):"")};c.prototype.setContent=function(){var f=this.tip();var e=this.getTitle();f.find(".tooltip-inner")[this.options.html?"html":"text"](e);f.removeClass("fade in top bottom left right")};c.prototype.hide=function(){var g=this;var j=this.tip();var h=d.Event("hide.bs."+this.type);function f(){if(g.hoverState!="in"){j.detach()}}this.$element.trigger(h);if(h.isDefaultPrevented()){return}j.removeClass("in");d.support.transition&&this.$tip.hasClass("fade")?j.one(d.support.transition.end,f).emulateTransitionEnd(150):f();this.$element.trigger("hidden.bs."+this.type);return this};c.prototype.fixTitle=function(){var e=this.$element;if(e.attr("title")||typeof(e.attr("data-original-title"))!="string"){e.attr("data-original-title",e.attr("title")||"").attr("title","")}};c.prototype.hasContent=function(){return this.getTitle()};c.prototype.getPosition=function(){var e=this.$element[0];return d.extend({},(typeof e.getBoundingClientRect=="function")?e.getBoundingClientRect():{width:e.offsetWidth,height:e.offsetHeight},this.$element.offset())};c.prototype.getCalculatedOffset=function(e,h,f,g){return e=="bottom"?{top:h.top+h.height,left:h.left+h.width/2-f/2}:e=="top"?{top:h.top-g,left:h.left+h.width/2-f/2}:e=="left"?{top:h.top+h.height/2-g/2,left:h.left-f}:{top:h.top+h.height/2-g/2,left:h.left+h.width}};c.prototype.getTitle=function(){var g;var e=this.$element;var f=this.options;g=e.attr("data-original-title")||(typeof f.title=="function"?f.title.call(e[0]):f.title);return g};c.prototype.tip=function(){return this.$tip=this.$tip||d(this.options.template)};c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")};c.prototype.validate=function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}};c.prototype.enable=function(){this.enabled=true};c.prototype.disable=function(){this.enabled=false};c.prototype.toggleEnabled=function(){this.enabled=!this.enabled};c.prototype.toggle=function(g){var f=g?d(g.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;f.tip().hasClass("in")?f.leave(f):f.enter(f)};c.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var b=d.fn.tooltip;d.fn.tooltip=function(e){return this.each(function(){var h=d(this);var g=h.data("bs.tooltip");var f=typeof e=="object"&&e;if(!g){h.data("bs.tooltip",(g=new c(this,f)))}if(typeof e=="string"){g[e]()}})};d.fn.tooltip.Constructor=c;d.fn.tooltip.noConflict=function(){d.fn.tooltip=b;return this}}(jQuery);
/*!
 * bootstrap-select v1.3.7
 * http://silviomoreto.github.io/bootstrap-select/
 *
 * Copyright 2013 bootstrap-select
 * Licensed under the MIT license
 */
!function(c){c.expr[":"].icontains=function(f,d,e){return c(f).text().toUpperCase().indexOf(e[3].toUpperCase())>=0};var b=function(f,d,g){if(g){g.stopPropagation();g.preventDefault()}this.$element=c(f);this.$newElement=null;this.$button=null;this.$menu=null;this.options=c.extend({},c.fn.selectpicker.defaults,this.$element.data(),typeof d=="object"&&d);if(this.options.title==null){this.options.title=this.$element.attr("title")}this.val=b.prototype.val;this.render=b.prototype.render;this.refresh=b.prototype.refresh;this.setStyle=b.prototype.setStyle;this.selectAll=b.prototype.selectAll;this.deselectAll=b.prototype.deselectAll;this.init()};b.prototype={constructor:b,init:function(){this.$element.hide();this.multiple=this.$element.prop("multiple");var e=this.$element.attr("id");this.$newElement=this.createView();this.$element.after(this.$newElement);this.$menu=this.$newElement.find("> .dropdown-menu");this.$button=this.$newElement.find("> button");this.$searchbox=this.$newElement.find("input");if(e!==undefined){var d=this;this.$button.attr("data-id",e);c('label[for="'+e+'"]').click(function(f){f.preventDefault();d.$button.focus()})}this.checkDisabled();this.clickListener();if(this.options.liveSearch){this.liveSearchListener()}this.render();this.liHeight();this.setStyle();this.setWidth();if(this.options.container){this.selectPosition()}this.$menu.data("this",this);this.$newElement.data("this",this)},createDropdown:function(){var d=this.multiple?" show-tick":"";var g=this.options.header?'<div class="popover-title"><button type="button" class="close" aria-hidden="true">&times;</button>'+this.options.header+"</div>":"";var f=this.options.liveSearch?'<div class="bootstrap-select-searchbox"><input type="text" class="input-block-level form-control" /></div>':"";var e="<div class='btn-group bootstrap-select"+d+"'><button type='button' class='btn dropdown-toggle selectpicker' data-toggle='dropdown'><span class='filter-option pull-left'></span>&nbsp;<span class='caret'></span></button><div class='dropdown-menu open'>"+g+f+"<ul class='dropdown-menu inner selectpicker' role='menu'></ul></div></div>";return c(e)},createView:function(){var d=this.createDropdown();var e=this.createLi();d.find("ul").append(e);return d},reloadLi:function(){this.destroyLi();var d=this.createLi();this.$menu.find("ul").append(d)},destroyLi:function(){this.$menu.find("li").remove()},createLi:function(){var e=this,f=[],d="";this.$element.find("option").each(function(){var k=c(this);var h=k.attr("class")||"";var j=k.attr("style")||"";var o=k.data("content")?k.data("content"):k.html();var m=k.data("subtext")!==undefined?'<small class="muted text-muted">'+k.data("subtext")+"</small>":"";var l=k.data("icon")!==undefined?'<i class="glyphicon '+k.data("icon")+'"></i> ':"";if(l!==""&&(k.is(":disabled")||k.parent().is(":disabled"))){l="<span>"+l+"</span>"}if(!k.data("content")){o=l+'<span class="text">'+o+m+"</span>"}if(e.options.hideDisabled&&(k.is(":disabled")||k.parent().is(":disabled"))){f.push('<a style="min-height: 0; padding: 0"></a>')}else{if(k.parent().is("optgroup")&&k.data("divider")!==true){if(k.index()==0){var n=k.parent().attr("label");var p=k.parent().data("subtext")!==undefined?'<small class="muted text-muted">'+k.parent().data("subtext")+"</small>":"";var g=k.parent().data("icon")?'<i class="'+k.parent().data("icon")+'"></i> ':"";n=g+'<span class="text">'+n+p+"</span>";if(k[0].index!=0){f.push('<div class="div-contain"><div class="divider"></div></div><dt>'+n+"</dt>"+e.createA(o,"opt "+h,j))}else{f.push("<dt>"+n+"</dt>"+e.createA(o,"opt "+h,j))}}else{f.push(e.createA(o,"opt "+h,j))}}else{if(k.data("divider")===true){f.push('<div class="div-contain"><div class="divider"></div></div>')}else{if(c(this).data("hidden")===true){f.push("")}else{f.push(e.createA(o,h,j))}}}}});c.each(f,function(g,h){d+="<li rel="+g+">"+h+"</li>"});if(!this.multiple&&this.$element.find("option:selected").length==0&&!this.options.title){this.$element.find("option").eq(0).prop("selected",true).attr("selected","selected")}return c(d)},createA:function(f,d,e){return'<a tabindex="0" class="'+d+'" style="'+e+'">'+f+'<i class="glyphicon glyphicon-ok icon-ok check-mark"></i></a>'},render:function(){var e=this;this.$element.find("option").each(function(j){e.setDisabled(j,c(this).is(":disabled")||c(this).parent().is(":disabled"));e.setSelected(j,c(this).is(":selected"))});this.tabIndex();var h=this.$element.find("option:selected").map(function(){var l=c(this);var k=l.data("icon")&&e.options.showIcon?'<i class="glyphicon '+l.data("icon")+'"></i> ':"";var j;if(e.options.showSubtext&&l.attr("data-subtext")&&!e.multiple){j=' <small class="muted text-muted">'+l.data("subtext")+"</small>"}else{j=""}if(l.data("content")&&e.options.showContent){return l.data("content")}else{if(l.attr("title")!=undefined){return l.attr("title")}else{return k+l.html()+j}}}).toArray();var g=!this.multiple?h[0]:h.join(", ");if(this.multiple&&this.options.selectedTextFormat.indexOf("count")>-1){var d=this.options.selectedTextFormat.split(">");var f=this.options.hideDisabled?":not([disabled])":"";if((d.length>1&&h.length>d[1])||(d.length==1&&h.length>=2)){g=this.options.countSelectedText.replace("{0}",h.length).replace("{1}",this.$element.find('option:not([data-divider="true"]):not([data-hidden="true"])'+f).length)}}if(!g){g=this.options.title!=undefined?this.options.title:this.options.noneSelectedText}this.$newElement.find(".filter-option").html(g)},setStyle:function(f,e){if(this.$element.attr("class")){this.$newElement.addClass(this.$element.attr("class").replace(/selectpicker|mobile-device/gi,""))}var d=f?f:this.options.style;if(e=="add"){this.$button.addClass(d)}else{if(e=="remove"){this.$button.removeClass(d)}else{this.$button.removeClass(this.options.style);this.$button.addClass(d)}}},liHeight:function(){var f=this.$menu.parent().clone().appendTo("body"),g=f.addClass("open").find("> .dropdown-menu"),e=g.find("li > a").outerHeight(),d=this.options.header?g.find(".popover-title").outerHeight():0,h=this.options.liveSearch?g.find(".bootstrap-select-searchbox").outerHeight():0;f.remove();this.$newElement.data("liHeight",e).data("headerHeight",d).data("searchHeight",h)},setSize:function(){var j=this,e=this.$menu,k=e.find(".inner"),w=this.$newElement.outerHeight(),g=this.$newElement.data("liHeight"),u=this.$newElement.data("headerHeight"),n=this.$newElement.data("searchHeight"),m=e.find("li .divider").outerHeight(true),t=parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom"))+parseInt(e.css("border-top-width"))+parseInt(e.css("border-bottom-width")),q=this.options.hideDisabled?":not(.disabled)":"",p=c(window),h=t+parseInt(e.css("margin-top"))+parseInt(e.css("margin-bottom"))+2,r,x,v,l=function(){x=j.$newElement.offset().top-p.scrollTop();v=p.height()-x-w};l();if(this.options.header){e.css("padding-top",0)}if(this.options.size=="auto"){var f=function(){var y;l();r=v-h;if(j.options.dropupAuto){j.$newElement.toggleClass("dropup",(x>v)&&((r-h)<e.height()))}if(j.$newElement.hasClass("dropup")){r=x-h}if((e.find("li").length+e.find("dt").length)>3){y=g*3+h-2}else{y=0}e.css({"max-height":r+"px",overflow:"hidden","min-height":y+"px"});k.css({"max-height":r-u-n-t+"px","overflow-y":"auto","min-height":y-t+"px"})};f();c(window).resize(f);c(window).scroll(f)}else{if(this.options.size&&this.options.size!="auto"&&e.find("li"+q).length>this.options.size){var o=e.find("li"+q+" > *").filter(":not(.div-contain)").slice(0,this.options.size).last().parent().index();var d=e.find("li").slice(0,o+1).find(".div-contain").length;r=g*this.options.size+d*m+t;if(j.options.dropupAuto){this.$newElement.toggleClass("dropup",(x>v)&&(r<e.height()))}e.css({"max-height":r+u+n+"px",overflow:"hidden"});k.css({"max-height":r-t+"px","overflow-y":"auto"})}}},setWidth:function(){if(this.options.width=="auto"){this.$menu.css("min-width","0");var e=this.$newElement.clone().appendTo("body");var d=e.find("> .dropdown-menu").css("width");e.remove();this.$newElement.css("width",d)}else{if(this.options.width=="fit"){this.$menu.css("min-width","");this.$newElement.css("width","").addClass("fit-width")}else{if(this.options.width){this.$menu.css("min-width","");this.$newElement.css("width",this.options.width)}else{this.$menu.css("min-width","");this.$newElement.css("width","")}}}if(this.$newElement.hasClass("fit-width")&&this.options.width!=="fit"){this.$newElement.removeClass("fit-width")}},selectPosition:function(){var f=this,e="<div />",g=c(e),j,h,d=function(k){g.addClass(k.attr("class")).toggleClass("dropup",k.hasClass("dropup"));j=k.offset();h=k.hasClass("dropup")?0:k[0].offsetHeight;g.css({top:j.top+h,left:j.left,width:k[0].offsetWidth,position:"absolute"})};this.$newElement.on("click",function(){d(c(this));g.appendTo(f.options.container);g.toggleClass("open",!c(this).hasClass("open"));g.append(f.$menu)});c(window).resize(function(){d(f.$newElement)});c(window).on("scroll",function(){d(f.$newElement)});c("html").on("click",function(k){if(c(k.target).closest(f.$newElement).length<1){g.removeClass("open")}})},mobile:function(){this.$element.addClass("mobile-device").appendTo(this.$newElement);if(this.options.container){this.$menu.hide()}},refresh:function(){this.reloadLi();this.render();this.setWidth();this.setStyle();this.checkDisabled();this.liHeight()},update:function(){this.reloadLi();this.setWidth();this.setStyle();this.checkDisabled();this.liHeight()},setSelected:function(d,e){this.$menu.find("li").eq(d).toggleClass("selected",e)},setDisabled:function(d,e){if(e){this.$menu.find("li").eq(d).addClass("disabled").find("a").attr("href","#").attr("tabindex",-1)}else{this.$menu.find("li").eq(d).removeClass("disabled").find("a").removeAttr("href").attr("tabindex",0)}},isDisabled:function(){return this.$element.is(":disabled")},checkDisabled:function(){var d=this;if(this.isDisabled()){this.$button.addClass("disabled").attr("tabindex",-1)}else{if(this.$button.hasClass("disabled")){this.$button.removeClass("disabled")}if(this.$button.attr("tabindex")==-1){if(!this.$element.data("tabindex")){this.$button.removeAttr("tabindex")}}}this.$button.click(function(){return !d.isDisabled()})},tabIndex:function(){if(this.$element.is("[tabindex]")){this.$element.data("tabindex",this.$element.attr("tabindex"));this.$button.attr("tabindex",this.$element.data("tabindex"))}},clickListener:function(){var d=this;c("body").on("touchstart.dropdown",".dropdown-menu",function(f){f.stopPropagation()});this.$newElement.on("click",function(){d.setSize();if(!d.options.liveSearch&&!d.multiple){setTimeout(function(){d.$menu.find(".selected a").focus()},10)}});this.$menu.on("click","li a",function(m){var h=c(this).parent().index(),l=d.$element.val(),g=d.$element.prop("selectedIndex");if(d.multiple){m.stopPropagation()}m.preventDefault();if(!d.isDisabled()&&!c(this).parent().hasClass("disabled")){var f=d.$element.find("option");var k=f.eq(h);if(!d.multiple){f.prop("selected",false);k.prop("selected",true)}else{var j=k.prop("selected");k.prop("selected",!j)}if(!d.multiple){d.$button.focus()}else{if(d.options.liveSearch){d.$searchbox.focus()}}if((l!=d.$element.val()&&d.multiple)||(g!=d.$element.prop("selectedIndex")&&!d.multiple)){d.$element.change()}}});this.$menu.on("click","li.disabled a, li dt, li .div-contain, .popover-title, .popover-title :not(.close)",function(f){if(f.target==this){f.preventDefault();f.stopPropagation();if(!d.options.liveSearch){d.$button.focus()}else{d.$searchbox.focus()}}});this.$menu.on("click",".popover-title .close",function(){d.$button.focus()});this.$searchbox.on("click",function(f){f.stopPropagation()});this.$element.change(function(){d.render()})},liveSearchListener:function(){var e=this,d=c('<li class="no-results"></li>');this.$newElement.on("click.dropdown.data-api",function(){e.$menu.find(".active").removeClass("active");if(!!e.$searchbox.val()){e.$searchbox.val("");e.$menu.find("li").show();d.remove()}if(!e.multiple){e.$menu.find(".selected").addClass("active")}setTimeout(function(){e.$searchbox.focus()},10)});this.$searchbox.on("input propertychange",function(){if(e.$searchbox.val()){e.$menu.find("li").show().not(":icontains("+e.$searchbox.val()+")").hide();if(!e.$menu.find("li").filter(":visible:not(.no-results)").length){d.remove();d.html('No results match "'+e.$searchbox.val()+'"').show();e.$menu.find("li").last().after(d)}else{d.remove()}}else{e.$menu.find("li").show()}e.$menu.find("li.active").removeClass("active");e.$menu.find("li").filter(":visible:not(.divider)").eq(0).addClass("active").find("a").focus();c(this).focus()});this.$menu.on("mouseenter","a",function(f){e.$menu.find(".active").removeClass("active");c(f.currentTarget).parent().not(".disabled").addClass("active")});this.$menu.on("mouseleave","a",function(){e.$menu.find(".active").removeClass("active")})},val:function(d){if(d!=undefined){this.$element.val(d);this.$element.change();return this.$element}else{return this.$element.val()}},selectAll:function(){this.$element.find("option").prop("selected",true).attr("selected","selected");this.render()},deselectAll:function(){this.$element.find("option").prop("selected",false).removeAttr("selected");this.render()},keydown:function(r){var t,q,k,p,m,l,u,g,j,o,f,v,h={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"};t=c(this);k=t.parent();if(t.is("input")){k=t.parent().parent()}o=k.data("this");if(o.options.liveSearch){k=t.parent().parent()}if(o.options.container){k=o.$menu}q=c("[role=menu] li:not(.divider) a",k);v=o.$menu.parent().hasClass("open");if(o.options.liveSearch){if(/(^9$|27)/.test(r.keyCode)&&v&&o.$menu.find(".active").length==0){r.preventDefault();o.$menu.parent().removeClass("open");o.$button.focus()}q=c("[role=menu] li:not(.divider):visible",k);if(!t.val()&&!/(38|40)/.test(r.keyCode)){if(q.filter(".active").length==0){q=o.$newElement.find("li").filter(":icontains("+h[r.keyCode]+")")}}}if(!q.length){return}if(/(38|40)/.test(r.keyCode)){if(!v){o.$menu.parent().addClass("open")}p=q.index(q.filter(":focus"));l=q.parent(":not(.disabled):visible").first().index();u=q.parent(":not(.disabled):visible").last().index();m=q.eq(p).parent().nextAll(":not(.disabled):visible").eq(0).index();g=q.eq(p).parent().prevAll(":not(.disabled):visible").eq(0).index();j=q.eq(m).parent().prevAll(":not(.disabled):visible").eq(0).index();if(o.options.liveSearch){q.each(function(e){if(c(this).is(":not(.disabled)")){c(this).data("index",e)}});p=q.index(q.filter(".active"));l=q.filter(":not(.disabled):visible").first().data("index");u=q.filter(":not(.disabled):visible").last().data("index");m=q.eq(p).nextAll(":not(.disabled):visible").eq(0).data("index");g=q.eq(p).prevAll(":not(.disabled):visible").eq(0).data("index");j=q.eq(m).prevAll(":not(.disabled):visible").eq(0).data("index")}f=t.data("prevIndex");if(r.keyCode==38){if(o.options.liveSearch){p-=1}if(p!=j&&p>g){p=g}if(p<l){p=l}if(p==f){p=u}}if(r.keyCode==40){if(o.options.liveSearch){p+=1}if(p==-1){p=0}if(p!=j&&p<m){p=m}if(p>u){p=u}if(p==f){p=l}}t.data("prevIndex",p);if(!o.options.liveSearch){q.eq(p).focus()}else{r.preventDefault();if(!t.is(".dropdown-toggle")){q.removeClass("active");q.eq(p).addClass("active").find("a").focus();t.focus()}}}else{if(!t.is("input")){var d=[];q.each(function(){if(c(this).parent().is(":not(.disabled)")){if(c.trim(c(this).text().toLowerCase()).substring(0,1)==h[r.keyCode]){d.push(c(this).parent().index())}}});var n=c(document).data("keycount");n++;c(document).data("keycount",n);var w=c.trim(c(":focus").text().toLowerCase()).substring(0,1);if(w!=h[r.keyCode]){n=1;c(document).data("keycount",n)}else{if(n>=d.length){c(document).data("keycount",0)}}q.eq(d[n-1]).focus()}}if(/(13|32|^9$)/.test(r.keyCode)&&v){if(!/(32)/.test(r.keyCode)){r.preventDefault()}if(!o.options.liveSearch){c(":focus").click()}else{if(!/(32)/.test(r.keyCode)){o.$menu.find(".active a").click();t.focus()}}c(document).data("keycount",0)}if((/(^9$|27)/.test(r.keyCode)&&v&&(o.multiple||o.options.liveSearch))||(/(27)/.test(r.keyCode)&&!v)){o.$menu.parent().removeClass("open");o.$button.focus()}},hide:function(){this.$newElement.hide()},show:function(){this.$newElement.show()},destroy:function(){this.$newElement.remove();this.$element.remove()}};c.fn.selectpicker=function(f,g){var d=arguments;var h;var e=this.each(function(){if(c(this).is("select")){var n=c(this),m=n.data("selectpicker"),j=typeof f=="object"&&f;if(!m){n.data("selectpicker",(m=new b(this,j,g)))}else{if(j){for(var k in j){m.options[k]=j[k]}}}if(typeof f=="string"){var l=f;if(m[l] instanceof Function){[].shift.apply(d);h=m[l].apply(m,d)}else{h=m.options[l]}}}});if(h!=undefined){return h}else{return e}};c.fn.selectpicker.defaults={style:"btn-default",size:"auto",title:null,selectedTextFormat:"values",noneSelectedText:"Nothing selected",countSelectedText:"{0} of {1} selected",width:false,container:false,hideDisabled:false,showSubtext:false,showIcon:true,showContent:true,dropupAuto:true,header:false,liveSearch:false};c(document).data("keycount",0).on("keydown",".bootstrap-select [data-toggle=dropdown], .bootstrap-select [role=menu], .bootstrap-select-searchbox input",b.prototype.keydown)}(window.jQuery);
/*!
 * typeahead.js 0.9.3
 * https://github.com/twitter/typeahead
 * Copyright 2013 Twitter, Inc. and other contributors; Licensed MIT
 */
(function(d){var n="0.9.3";var l={isMsie:function(){var o=/(msie) ([\w.]+)/i.exec(navigator.userAgent);return o?parseInt(o[2],10):false},isBlankString:function(o){return !o||/^\s*$/.test(o)},escapeRegExChars:function(o){return o.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(o){return typeof o==="string"},isNumber:function(o){return typeof o==="number"},isArray:d.isArray,isFunction:d.isFunction,isObject:d.isPlainObject,isUndefined:function(o){return typeof o==="undefined"},bind:d.proxy,bindAll:function(p){var q;for(var o in p){d.isFunction(q=p[o])&&(p[o]=d.proxy(q,p))}},indexOf:function(p,q){for(var o=0;o<p.length;o++){if(p[o]===q){return o}}return -1},each:d.each,map:d.map,filter:d.grep,every:function(p,q){var o=true;if(!p){return o}d.each(p,function(r,t){if(!(o=q.call(null,t,r,p))){return false}});return !!o},some:function(p,q){var o=false;if(!p){return o}d.each(p,function(r,t){if(o=q.call(null,t,r,p)){return false}});return !!o},mixin:d.extend,getUniqueId:function(){var o=0;return function(){return o++}}(),defer:function(o){setTimeout(o,0)},debounce:function(q,t,p){var r,o;return function(){var x=this,w=arguments,v,u;v=function(){r=null;if(!p){o=q.apply(x,w)}};u=p&&!r;clearTimeout(r);r=setTimeout(v,t);if(u){o=q.apply(x,w)}return o}},throttle:function(u,w){var r,q,v,o,t,p;t=0;p=function(){t=new Date();v=null;o=u.apply(r,q)};return function(){var x=new Date(),y=w-(x-t);r=this;q=arguments;if(y<=0){clearTimeout(v);v=null;t=x;o=u.apply(r,q)}else{if(!v){v=setTimeout(p,y)}}return o}},tokenizeQuery:function(o){return d.trim(o).toLowerCase().split(/[\s]+/)},tokenizeText:function(o){return d.trim(o).toLowerCase().split(/[\s\-_]+/)},normalizeChars:function(p,o){d.each(o,function(r,q){r=new RegExp("["+l.escapeRegExChars(r)+"]","gi");p=p.replace(r,q)});return p},getProtocol:function(){return location.protocol},noop:function(){}};var m=function(){var o=/\s+/;return{on:function(p,r){var q;if(!r){return this}this._callbacks=this._callbacks||{};p=p.split(o);while(q=p.shift()){this._callbacks[q]=this._callbacks[q]||[];this._callbacks[q].push(r)}return this},trigger:function(q,u){var t,r;if(!this._callbacks){return this}q=q.split(o);while(t=q.shift()){if(r=this._callbacks[t]){for(var p=0;p<r.length;p+=1){r[p].call(this,{type:t,data:u})}}}return this}}}();var f=function(){var p="typeahead:";function o(q){if(!q||!q.el){d.error("EventBus initialized without el")}this.$el=d(q.el)}l.mixin(o.prototype,{trigger:function(r){var q=[].slice.call(arguments,1);this.$el.trigger(p+r,q)}});return o}();var h=function(){var o,p;try{o=window.localStorage;o.setItem("~~~","!");o.removeItem("~~~")}catch(u){o=null}function r(w){this.prefix=["__",w,"__"].join("");this.ttlKey="__ttl__";this.keyMatcher=new RegExp("^"+this.prefix)}if(o&&window.JSON){p={_prefix:function(w){return this.prefix+w},_ttlKey:function(w){return this._prefix(w)+this.ttlKey},get:function(w){if(this.isExpired(w)){this.remove(w)}return v(o.getItem(this._prefix(w)))},set:function(x,y,w){if(l.isNumber(w)){o.setItem(this._ttlKey(x),t(q()+w))}else{o.removeItem(this._ttlKey(x))}return o.setItem(this._prefix(x),t(y))},remove:function(w){o.removeItem(this._ttlKey(w));o.removeItem(this._prefix(w));return this},clear:function(){var y,x,z=[],w=o.length;for(y=0;y<w;y++){if((x=o.key(y)).match(this.keyMatcher)){z.push(x.replace(this.keyMatcher,""))}}for(y=z.length;y--;){this.remove(z[y])}return this},isExpired:function(x){var w=v(o.getItem(this._ttlKey(x)));return l.isNumber(w)&&q()>w?true:false}}}else{p={get:l.noop,set:l.noop,remove:l.noop,clear:l.noop,isExpired:l.noop}}l.mixin(r.prototype,p);return r;function q(){return new Date().getTime()}function t(w){return JSON.stringify(l.isUndefined(w)?null:w)}function v(w){return JSON.parse(w)}}();var k=function(){function o(p){l.bindAll(this);p=p||{};this.sizeLimit=p.sizeLimit||10;this.cache={};this.cachedKeysByAge=[]}l.mixin(o.prototype,{get:function(p){return this.cache[p]},set:function(q,r){var p;if(this.cachedKeysByAge.length===this.sizeLimit){p=this.cachedKeysByAge.shift();delete this.cache[p]}this.cache[q]=r;this.cachedKeysByAge.push(q)}});return o}();var e=function(){var p=0,t={},o,v;function w(x){l.bindAll(this);x=l.isString(x)?{url:x}:x;v=v||new k();o=l.isNumber(x.maxParallelRequests)?x.maxParallelRequests:o||6;this.url=x.url;this.wildcard=x.wildcard||"%QUERY";this.filter=x.filter;this.replace=x.replace;this.ajaxSettings={type:"get",cache:x.cache,timeout:x.timeout,dataType:x.dataType||"json",beforeSend:x.beforeSend};this._get=(/^throttle$/i.test(x.rateLimitFn)?l.throttle:l.debounce)(this._get,x.rateLimitWait||300)}l.mixin(w.prototype,{_get:function(z,x){var A=this;if(r()){this._sendRequest(z).done(y)}else{this.onDeckRequestArgs=[].slice.call(arguments,0)}function y(C){var B=A.filter?A.filter(C):C;x&&x(B);v.set(z,C)}},_sendRequest:function(y){var A=this,z=t[y];if(!z){q();z=t[y]=d.ajax(y,this.ajaxSettings).always(x)}return z;function x(){u();t[y]=null;if(A.onDeckRequestArgs){A._get.apply(A,A.onDeckRequestArgs);A.onDeckRequestArgs=null}}},get:function(B,x){var A=this,z=encodeURIComponent(B||""),y,C;x=x||l.noop;y=this.replace?this.replace(this.url,z):this.url.replace(this.wildcard,z);if(C=v.get(y)){l.defer(function(){x(A.filter?A.filter(C):C)})}else{this._get(y,x)}return !!C}});return w;function q(){p++}function u(){p--}function r(){return p<o}}();var b=function(){var q={thumbprint:"thumbprint",protocol:"protocol",itemHash:"itemHash",adjacencyList:"adjacencyList"};function p(r){l.bindAll(this);if(l.isString(r.template)&&!r.engine){d.error("no template engine specified")}if(!r.local&&!r.prefetch&&!r.remote){d.error("one of local, prefetch, or remote is required")}this.name=r.name||l.getUniqueId();this.limit=r.limit||5;this.minLength=r.minLength||1;this.header=r.header;this.footer=r.footer;this.valueKey=r.valueKey||"value";this.charMap=r.charMap;this.template=o(r.template,r.engine,this.valueKey);this.local=r.local;this.prefetch=r.prefetch;this.remote=r.remote;this.itemHash={};this.adjacencyList={};this.storage=r.name?new h(r.name):null}l.mixin(p.prototype,{_processLocalData:function(r){this._mergeProcessedData(this._processData(r))},_loadPrefetchData:function(t){var w=this,B=n+(t.thumbprint||""),z,u,x,r,v,A;if(this.storage){z=this.storage.get(q.thumbprint);u=this.storage.get(q.protocol);x=this.storage.get(q.itemHash);r=this.storage.get(q.adjacencyList)}v=z!==B||u!==l.getProtocol();t=l.isString(t)?{url:t}:t;t.ttl=l.isNumber(t.ttl)?t.ttl:24*60*60*1000;if(x&&r&&!v){this._mergeProcessedData({itemHash:x,adjacencyList:r});A=d.Deferred().resolve()}else{A=d.getJSON(t.url).done(y)}return A;function y(G){var F=t.filter?t.filter(G):G,E=w._processData(F),C=E.itemHash,D=E.adjacencyList;if(w.storage){w.storage.set(q.itemHash,C,t.ttl);w.storage.set(q.adjacencyList,D,t.ttl);w.storage.set(q.thumbprint,B,t.ttl);w.storage.set(q.protocol,l.getProtocol(),t.ttl)}w._mergeProcessedData(E)}},_transformDatum:function(r){var v=l.isString(r)?r:r[this.valueKey],w=r.tokens||l.tokenizeText(v),u={value:v,tokens:w},t=this.charMap;if(l.isString(r)){u.datum={};u.datum[this.valueKey]=r}else{u.datum=r}u.tokens=l.filter(u.tokens,function(x){return !l.isBlankString(x)});u.tokens=l.map(u.tokens,function(x){x=x.toLowerCase();return t?l.normalizeChars(x,t):x});return u},_processData:function(v){var u=this,r={},t={};l.each(v,function(x,w){var y=u._transformDatum(w),z=l.getUniqueId(y.value);r[z]=y;l.each(y.tokens,function(B,A){var D=A.charAt(0),C=t[D]||(t[D]=[z]);!~l.indexOf(C,z)&&C.push(z)})});return{itemHash:r,adjacencyList:t}},_mergeProcessedData:function(r){var t=this;l.mixin(this.itemHash,r.itemHash);l.each(r.adjacencyList,function(w,v){var u=t.adjacencyList[w];t.adjacencyList[w]=u?u.concat(v):v})},_getLocalSuggestions:function(x){var w=this,v=[],t=[],u,r=[];l.each(x,function(z,y){var A=y.charAt(0);!~l.indexOf(v,A)&&v.push(A)});l.each(v,function(y,z){var A=w.adjacencyList[z];if(!A){return false}t.push(A);if(!u||A.length<u.length){u=A}});if(t.length<v.length){return[]}l.each(u,function(y,C){var A=w.itemHash[C],B,z;B=l.every(t,function(D){return ~l.indexOf(D,C)});z=B&&l.every(x,function(D){return l.some(A.tokens,function(E){return E.indexOf(D)===0})});z&&r.push(A)});return r},initialize:function(){var r;this.local&&this._processLocalData(this.local);this.transport=this.remote?new e(this.remote):null;r=this.prefetch?this._loadPrefetchData(this.prefetch):d.Deferred().resolve();this.local=this.prefetch=this.remote=null;this.initialize=function(){return r};return r},getSuggestions:function(x,t){var w=this,v,r,u=false;if(x.length<this.minLength){return}v=l.tokenizeQuery(x);if(this.charMap){v=l.map(v,function(z){return l.normalizeChars(z,w.charMap)})}r=this._getLocalSuggestions(v).slice(0,this.limit);if(r.length<this.limit&&this.transport){u=this.transport.get(x,y)}!u&&t&&t(r);function y(z){r=r.slice(0);l.each(z,function(C,B){var D=w._transformDatum(B),A;A=l.some(r,function(E){return D.value===E.value});!A&&r.push(D);return r.length<w.limit});t&&t(r)}}});return p;function o(v,u,w){var t,r;if(l.isFunction(v)){t=v}else{if(l.isString(v)){r=u.compile(v);t=l.bind(r.render,r)}else{t=function(x){return"<p>"+x[w]+"</p>"}}}return t}}();var c=function(){function p(t){var r=this;l.bindAll(this);this.specialKeyCodeMap={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};this.$hint=d(t.hint);this.$input=d(t.input).on("blur.tt",this._handleBlur).on("focus.tt",this._handleFocus).on("keydown.tt",this._handleSpecialKeyEvent);if(!l.isMsie()){this.$input.on("input.tt",this._compareQueryToInputValue)}else{this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(u){if(r.specialKeyCodeMap[u.which||u.keyCode]){return}l.defer(r._compareQueryToInputValue)})}this.query=this.$input.val();this.$overflowHelper=q(this.$input)}l.mixin(p.prototype,m,{_handleFocus:function(){this.trigger("focused")},_handleBlur:function(){this.trigger("blured")},_handleSpecialKeyEvent:function(r){var t=this.specialKeyCodeMap[r.which||r.keyCode];t&&this.trigger(t+"Keyed",r)},_compareQueryToInputValue:function(){var r=this.getInputValue(),u=o(this.query,r),t=u?this.query.length!==r.length:false;if(t){this.trigger("whitespaceChanged",{value:this.query})}else{if(!u){this.trigger("queryChanged",{value:this.query=r})}}},destroy:function(){this.$hint.off(".tt");this.$input.off(".tt");this.$hint=this.$input=this.$overflowHelper=null},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(r){this.query=r},getInputValue:function(){return this.$input.val()},setInputValue:function(t,r){this.$input.val(t);!r&&this._compareQueryToInputValue()},getHintValue:function(){return this.$hint.val()},setHintValue:function(r){this.$hint.val(r)},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},isOverflow:function(){this.$overflowHelper.text(this.getInputValue());return this.$overflowHelper.width()>this.$input.width()},isCursorAtEnd:function(){var t=this.$input.val().length,u=this.$input[0].selectionStart,r;if(l.isNumber(u)){return u===t}else{if(document.selection){r=document.selection.createRange();r.moveStart("character",-t);return t===r.text.length}}return true}});return p;function q(r){return d("<span></span>").css({position:"absolute",left:"-9999px",visibility:"hidden",whiteSpace:"nowrap",fontFamily:r.css("font-family"),fontSize:r.css("font-size"),fontStyle:r.css("font-style"),fontVariant:r.css("font-variant"),fontWeight:r.css("font-weight"),wordSpacing:r.css("word-spacing"),letterSpacing:r.css("letter-spacing"),textIndent:r.css("text-indent"),textRendering:r.css("text-rendering"),textTransform:r.css("text-transform")}).insertAfter(r)}function o(t,r){t=(t||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ");r=(r||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ");return t===r}}();var g=function(){var q={suggestionsList:'<span class="tt-suggestions"></span>'},p={suggestionsList:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"}};function r(t){l.bindAll(this);this.isOpen=false;this.isEmpty=true;this.isMouseOverDropdown=false;this.$menu=d(t.menu).on("mouseenter.tt",this._handleMouseenter).on("mouseleave.tt",this._handleMouseleave).on("click.tt",".tt-suggestion",this._handleSelection).on("mouseover.tt",".tt-suggestion",this._handleMouseover)}l.mixin(r.prototype,m,{_handleMouseenter:function(){this.isMouseOverDropdown=true},_handleMouseleave:function(){this.isMouseOverDropdown=false},_handleMouseover:function(u){var t=d(u.currentTarget);this._getSuggestions().removeClass("tt-is-under-cursor");t.addClass("tt-is-under-cursor")},_handleSelection:function(u){var t=d(u.currentTarget);this.trigger("suggestionSelected",o(t))},_show:function(){this.$menu.css("display","block")},_hide:function(){this.$menu.hide()},_moveCursor:function(v){var x,u,t,w;if(!this.isVisible()){return}x=this._getSuggestions();u=x.filter(".tt-is-under-cursor");u.removeClass("tt-is-under-cursor");t=x.index(u)+v;t=(t+1)%(x.length+1)-1;if(t===-1){this.trigger("cursorRemoved");return}else{if(t<-1){t=x.length-1}}w=x.eq(t).addClass("tt-is-under-cursor");this._ensureVisibility(w);this.trigger("cursorMoved",o(w))},_getSuggestions:function(){return this.$menu.find(".tt-suggestions > .tt-suggestion")},_ensureVisibility:function(w){var x=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),u=this.$menu.scrollTop(),t=w.position().top,v=t+w.outerHeight(true);if(t<0){this.$menu.scrollTop(u+t)}else{if(x<v){this.$menu.scrollTop(u+(v-x))}}},destroy:function(){this.$menu.off(".tt");this.$menu=null},isVisible:function(){return this.isOpen&&!this.isEmpty},closeUnlessMouseIsOverDropdown:function(){if(!this.isMouseOverDropdown){this.close()}},close:function(){if(this.isOpen){this.isOpen=false;this.isMouseOverDropdown=false;this._hide();this.$menu.find(".tt-suggestions > .tt-suggestion").removeClass("tt-is-under-cursor");this.trigger("closed")}},open:function(){if(!this.isOpen){this.isOpen=true;!this.isEmpty&&this._show();this.trigger("opened")}},setLanguageDirection:function(t){var u={left:"0",right:"auto"},v={left:"auto",right:" 0"};t==="ltr"?this.$menu.css(u):this.$menu.css(v)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(+1)},getSuggestionUnderCursor:function(){var t=this._getSuggestions().filter(".tt-is-under-cursor").first();return t.length>0?o(t):null},getFirstSuggestion:function(){var t=this._getSuggestions().first();return t.length>0?o(t):null},renderSuggestions:function(w,x){var t="tt-dataset-"+w.name,u='<div class="tt-suggestion">%body</div>',A,z,B=this.$menu.find("."+t),v,y,C;if(B.length===0){z=d(q.suggestionsList).css(p.suggestionsList);B=d("<div></div>").addClass(t).append(w.header).append(z).append(w.footer).appendTo(this.$menu)}if(x.length>0){this.isEmpty=false;this.isOpen&&this._show();v=document.createElement("div");y=document.createDocumentFragment();l.each(x,function(E,D){D.dataset=w.name;A=w.template(D.datum);v.innerHTML=u.replace("%body",A);C=d(v.firstChild).css(p.suggestion).data("suggestion",D);C.children().each(function(){d(this).css(p.suggestionChild)});y.appendChild(C[0])});B.show().find(".tt-suggestions").html(y)}else{this.clearSuggestions(w.name)}this.trigger("suggestionsRendered")},clearSuggestions:function(v){var t=v?this.$menu.find(".tt-dataset-"+v):this.$menu.find('[class^="tt-dataset-"]'),u=t.find(".tt-suggestions");t.hide();u.empty();if(this._getSuggestions().length===0){this.isEmpty=true;this._hide()}}});return r;function o(t){return t.data("suggestion")}}();var j=function(){var t={wrapper:'<span class="twitter-typeahead"></span>',hint:'<input class="tt-hint" type="text" autocomplete="off" spellcheck="off" disabled>',dropdown:'<span class="tt-dropdown-menu"></span>'},r={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none"},query:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"}};if(l.isMsie()){l.mixin(r.query,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"})}if(l.isMsie()&&l.isMsie()<=7){l.mixin(r.wrapper,{display:"inline",zoom:"1"});l.mixin(r.query,{marginTop:"-1px"})}function p(w){var v,x,u;l.bindAll(this);this.$node=o(w.input);this.datasets=w.datasets;this.dir=null;this.eventBus=w.eventBus;v=this.$node.find(".tt-dropdown-menu");x=this.$node.find(".tt-query");u=this.$node.find(".tt-hint");this.dropdownView=new g({menu:v}).on("suggestionSelected",this._handleSelection).on("cursorMoved",this._clearHint).on("cursorMoved",this._setInputValueToSuggestionUnderCursor).on("cursorRemoved",this._setInputValueToQuery).on("cursorRemoved",this._updateHint).on("suggestionsRendered",this._updateHint).on("opened",this._updateHint).on("closed",this._clearHint).on("opened closed",this._propagateEvent);this.inputView=new c({input:x,hint:u}).on("focused",this._openDropdown).on("blured",this._closeDropdown).on("blured",this._setInputValueToQuery).on("enterKeyed tabKeyed",this._handleSelection).on("queryChanged",this._clearHint).on("queryChanged",this._clearSuggestions).on("queryChanged",this._getSuggestions).on("whitespaceChanged",this._updateHint).on("queryChanged whitespaceChanged",this._openDropdown).on("queryChanged whitespaceChanged",this._setLanguageDirection).on("escKeyed",this._closeDropdown).on("escKeyed",this._setInputValueToQuery).on("tabKeyed upKeyed downKeyed",this._managePreventDefault).on("upKeyed downKeyed",this._moveDropdownCursor).on("upKeyed downKeyed",this._openDropdown).on("tabKeyed leftKeyed rightKeyed",this._autocomplete)}l.mixin(p.prototype,m,{_managePreventDefault:function(x){var w=x.data,y,u,v=false;switch(x.type){case"tabKeyed":y=this.inputView.getHintValue();u=this.inputView.getInputValue();v=y&&y!==u;break;case"upKeyed":case"downKeyed":v=!w.shiftKey&&!w.ctrlKey&&!w.metaKey;break}v&&w.preventDefault()},_setLanguageDirection:function(){var u=this.inputView.getLanguageDirection();if(u!==this.dir){this.dir=u;this.$node.css("direction",u);this.dropdownView.setLanguageDirection(u)}},_updateHint:function(){var x=this.dropdownView.getFirstSuggestion(),w=x?x.value:null,A=this.dropdownView.isVisible(),z=this.inputView.isOverflow(),v,B,C,u,y;if(w&&A&&!z){v=this.inputView.getInputValue();B=v.replace(/\s{2,}/g," ").replace(/^\s+/g,"");C=l.escapeRegExChars(B);u=new RegExp("^(?:"+C+")(.*$)","i");y=u.exec(w);this.inputView.setHintValue(v+(y?y[1]:""))}},_clearHint:function(){this.inputView.setHintValue("")},_clearSuggestions:function(){this.dropdownView.clearSuggestions()},_setInputValueToQuery:function(){this.inputView.setInputValue(this.inputView.getQuery())},_setInputValueToSuggestionUnderCursor:function(v){var u=v.data;this.inputView.setInputValue(u.value,true)},_openDropdown:function(){this.dropdownView.open()},_closeDropdown:function(u){this.dropdownView[u.type==="blured"?"closeUnlessMouseIsOverDropdown":"close"]()},_moveDropdownCursor:function(v){var u=v.data;if(!u.shiftKey&&!u.ctrlKey&&!u.metaKey){this.dropdownView[v.type==="upKeyed"?"moveCursorUp":"moveCursorDown"]()}},_handleSelection:function(w){var v=w.type==="suggestionSelected",u=v?w.data:this.dropdownView.getSuggestionUnderCursor();if(u){this.inputView.setInputValue(u.value);v?this.inputView.focus():w.data.preventDefault();v&&l.isMsie()?l.defer(this.dropdownView.close):this.dropdownView.close();this.eventBus.trigger("selected",u.datum,u.dataset)}},_getSuggestions:function(){var u=this,v=this.inputView.getQuery();if(l.isBlankString(v)){return}l.each(this.datasets,function(w,x){x.getSuggestions(v,function(y){if(v===u.inputView.getQuery()){u.dropdownView.renderSuggestions(x,y)}})})},_autocomplete:function(y){var v,u,x,z,w;if(y.type==="rightKeyed"||y.type==="leftKeyed"){v=this.inputView.isCursorAtEnd();u=this.inputView.getLanguageDirection()==="ltr"?y.type==="leftKeyed":y.type==="rightKeyed";if(!v||u){return}}x=this.inputView.getQuery();z=this.inputView.getHintValue();if(z!==""&&x!==z){w=this.dropdownView.getFirstSuggestion();this.inputView.setInputValue(w.value);this.eventBus.trigger("autocompleted",w.datum,w.dataset)}},_propagateEvent:function(u){this.eventBus.trigger(u.type)},destroy:function(){this.inputView.destroy();this.dropdownView.destroy();q(this.$node);this.$node=null},setQuery:function(u){this.inputView.setQuery(u);this.inputView.setInputValue(u);this._clearHint();this._clearSuggestions();this._getSuggestions()}});return p;function o(u){var w=d(t.wrapper),y=d(t.dropdown),z=d(u),v=d(t.hint);w=w.css(r.wrapper);y=y.css(r.dropdown);v.css(r.hint).css({backgroundAttachment:z.css("background-attachment"),backgroundClip:z.css("background-clip"),backgroundColor:z.css("background-color"),backgroundImage:z.css("background-image"),backgroundOrigin:z.css("background-origin"),backgroundPosition:z.css("background-position"),backgroundRepeat:z.css("background-repeat"),backgroundSize:z.css("background-size")});z.data("ttAttrs",{dir:z.attr("dir"),autocomplete:z.attr("autocomplete"),spellcheck:z.attr("spellcheck"),style:z.attr("style")});z.addClass("tt-query").attr({autocomplete:"off",spellcheck:false}).css(r.query);try{!z.attr("dir")&&z.attr("dir","auto")}catch(x){}return z.wrap(w).parent().prepend(v).append(y)}function q(u){var v=u.find(".tt-query");l.each(v.data("ttAttrs"),function(w,x){l.isUndefined(x)?v.removeAttr(w):v.attr(w,x)});v.detach().removeData("ttAttrs").removeClass("tt-query").insertAfter(u);u.remove()}}();(function(){var p={},q="ttView",o;o={initialize:function(u){var t;u=l.isArray(u)?u:[u];if(u.length===0){d.error("no datasets provided")}t=l.map(u,function(w){var v=p[w.name]?p[w.name]:new b(w);if(w.name){p[w.name]=v}return v});return this.each(r);function r(){var x=d(this),w,v=new f({el:x});w=l.map(t,function(y){return y.initialize()});x.data(q,new j({input:x,eventBus:v=new f({el:x}),datasets:t}));d.when.apply(d,w).always(function(){l.defer(function(){v.trigger("initialized")})})}},destroy:function(){return this.each(r);function r(){var u=d(this),t=u.data(q);if(t){t.destroy();u.removeData(q)}}},setQuery:function(r){return this.each(t);function t(){var u=d(this).data(q);u&&u.setQuery(r)}}};jQuery.fn.typeahead=function(r){if(o[r]){return o[r].apply(this,[].slice.call(arguments,1))}else{return o.initialize.apply(this,arguments)}}})()})(window.jQuery);if(typeof JSON!=="object"){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function(){var z=this;var m=z._;var G={};var F=Array.prototype,g=Object.prototype,u=Function.prototype;var J=F.push,q=F.slice,B=F.concat,e=g.toString,l=g.hasOwnProperty;var N=F.forEach,t=F.map,H=F.reduce,d=F.reduceRight,c=F.filter,E=F.every,r=F.some,p=F.indexOf,n=F.lastIndexOf,x=Array.isArray,f=Object.keys,I=u.bind;var O=function(P){if(P instanceof O){return P}if(!(this instanceof O)){return new O(P)}this._wrapped=P};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=O}exports._=O}else{z._=O}O.VERSION="1.4.4";var K=O.each=O.forEach=function(U,T,S){if(U==null){return}if(N&&U.forEach===N){U.forEach(T,S)}else{if(U.length===+U.length){for(var R=0,P=U.length;R<P;R++){if(T.call(S,U[R],R,U)===G){return}}}else{for(var Q in U){if(O.has(U,Q)){if(T.call(S,U[Q],Q,U)===G){return}}}}}};O.map=O.collect=function(S,R,Q){var P=[];if(S==null){return P}if(t&&S.map===t){return S.map(R,Q)}K(S,function(V,T,U){P[P.length]=R.call(Q,V,T,U)});return P};var h="Reduce of empty array with no initial value";O.reduce=O.foldl=O.inject=function(T,S,P,R){var Q=arguments.length>2;if(T==null){T=[]}if(H&&T.reduce===H){if(R){S=O.bind(S,R)}return Q?T.reduce(S,P):T.reduce(S)}K(T,function(W,U,V){if(!Q){P=W;Q=true}else{P=S.call(R,P,W,U,V)}});if(!Q){throw new TypeError(h)}return P};O.reduceRight=O.foldr=function(V,S,P,R){var Q=arguments.length>2;if(V==null){V=[]}if(d&&V.reduceRight===d){if(R){S=O.bind(S,R)}return Q?V.reduceRight(S,P):V.reduceRight(S)}var U=V.length;if(U!==+U){var T=O.keys(V);U=T.length}K(V,function(Y,W,X){W=T?T[--U]:--U;if(!Q){P=V[W];Q=true}else{P=S.call(R,P,V[W],W,X)}});if(!Q){throw new TypeError(h)}return P};O.find=O.detect=function(S,R,Q){var P;D(S,function(V,T,U){if(R.call(Q,V,T,U)){P=V;return true}});return P};O.filter=O.select=function(S,R,Q){var P=[];if(S==null){return P}if(c&&S.filter===c){return S.filter(R,Q)}K(S,function(V,T,U){if(R.call(Q,V,T,U)){P[P.length]=V}});return P};O.reject=function(R,Q,P){return O.filter(R,function(U,S,T){return !Q.call(P,U,S,T)},P)};O.every=O.all=function(S,R,Q){R||(R=O.identity);var P=true;if(S==null){return P}if(E&&S.every===E){return S.every(R,Q)}K(S,function(V,T,U){if(!(P=P&&R.call(Q,V,T,U))){return G}});return !!P};var D=O.some=O.any=function(S,R,Q){R||(R=O.identity);var P=false;if(S==null){return P}if(r&&S.some===r){return S.some(R,Q)}K(S,function(V,T,U){if(P||(P=R.call(Q,V,T,U))){return G}});return !!P};O.contains=O.include=function(Q,P){if(Q==null){return false}if(p&&Q.indexOf===p){return Q.indexOf(P)!=-1}return D(Q,function(R){return R===P})};O.invoke=function(R,S){var P=q.call(arguments,2);var Q=O.isFunction(S);return O.map(R,function(T){return(Q?S:T[S]).apply(T,P)})};O.pluck=function(Q,P){return O.map(Q,function(R){return R[P]})};O.where=function(Q,P,R){if(O.isEmpty(P)){return R?null:[]}return O[R?"find":"filter"](Q,function(T){for(var S in P){if(P[S]!==T[S]){return false}}return true})};O.findWhere=function(Q,P){return O.where(Q,P,true)};O.max=function(S,R,Q){if(!R&&O.isArray(S)&&S[0]===+S[0]&&S.length<65535){return Math.max.apply(Math,S)}if(!R&&O.isEmpty(S)){return -Infinity}var P={computed:-Infinity,value:-Infinity};K(S,function(W,T,V){var U=R?R.call(Q,W,T,V):W;U>=P.computed&&(P={value:W,computed:U})});return P.value};O.min=function(S,R,Q){if(!R&&O.isArray(S)&&S[0]===+S[0]&&S.length<65535){return Math.min.apply(Math,S)}if(!R&&O.isEmpty(S)){return Infinity}var P={computed:Infinity,value:Infinity};K(S,function(W,T,V){var U=R?R.call(Q,W,T,V):W;U<P.computed&&(P={value:W,computed:U})});return P.value};O.shuffle=function(S){var R;var Q=0;var P=[];K(S,function(T){R=O.random(Q++);P[Q-1]=P[R];P[R]=T});return P};var b=function(P){return O.isFunction(P)?P:function(Q){return Q[P]}};O.sortBy=function(S,R,P){var Q=b(R);return O.pluck(O.map(S,function(V,T,U){return{value:V,index:T,criteria:Q.call(P,V,T,U)}}).sort(function(W,V){var U=W.criteria;var T=V.criteria;if(U!==T){if(U>T||U===void 0){return 1}if(U<T||T===void 0){return -1}}return W.index<V.index?-1:1}),"value")};var w=function(U,T,Q,S){var P={};var R=b(T||O.identity);K(U,function(X,V){var W=R.call(Q,X,V,U);S(P,W,X)});return P};O.groupBy=function(R,Q,P){return w(R,Q,P,function(S,T,U){(O.has(S,T)?S[T]:(S[T]=[])).push(U)})};O.countBy=function(R,Q,P){return w(R,Q,P,function(S,T){if(!O.has(S,T)){S[T]=0}S[T]++})};O.sortedIndex=function(W,V,S,R){S=S==null?O.identity:b(S);var U=S.call(R,V);var P=0,T=W.length;while(P<T){var Q=(P+T)>>>1;S.call(R,W[Q])<U?P=Q+1:T=Q}return P};O.toArray=function(P){if(!P){return[]}if(O.isArray(P)){return q.call(P)}if(P.length===+P.length){return O.map(P,O.identity)}return O.values(P)};O.size=function(P){if(P==null){return 0}return(P.length===+P.length)?P.length:O.keys(P).length};O.first=O.head=O.take=function(R,Q,P){if(R==null){return void 0}return(Q!=null)&&!P?q.call(R,0,Q):R[0]};O.initial=function(R,Q,P){return q.call(R,0,R.length-((Q==null)||P?1:Q))};O.last=function(R,Q,P){if(R==null){return void 0}if((Q!=null)&&!P){return q.call(R,Math.max(R.length-Q,0))}else{return R[R.length-1]}};O.rest=O.tail=O.drop=function(R,Q,P){return q.call(R,(Q==null)||P?1:Q)};O.compact=function(P){return O.filter(P,O.identity)};var A=function(Q,R,P){K(Q,function(S){if(O.isArray(S)){R?J.apply(P,S):A(S,R,P)}else{P.push(S)}});return P};O.flatten=function(Q,P){return A(Q,P,[])};O.without=function(P){return O.difference(P,q.call(arguments,1))};O.uniq=O.unique=function(V,U,T,S){if(O.isFunction(U)){S=T;T=U;U=false}var Q=T?O.map(V,T,S):V;var R=[];var P=[];K(Q,function(X,W){if(U?(!W||P[P.length-1]!==X):!O.contains(P,X)){P.push(X);R.push(V[W])}});return R};O.union=function(){return O.uniq(B.apply(F,arguments))};O.intersection=function(Q){var P=q.call(arguments,1);return O.filter(O.uniq(Q),function(R){return O.every(P,function(S){return O.indexOf(S,R)>=0})})};O.difference=function(Q){var P=B.apply(F,q.call(arguments,1));return O.filter(Q,function(R){return !O.contains(P,R)})};O.zip=function(){var P=q.call(arguments);var S=O.max(O.pluck(P,"length"));var R=new Array(S);for(var Q=0;Q<S;Q++){R[Q]=O.pluck(P,""+Q)}return R};O.object=function(T,R){if(T==null){return{}}var P={};for(var S=0,Q=T.length;S<Q;S++){if(R){P[T[S]]=R[S]}else{P[T[S][0]]=T[S][1]}}return P};O.indexOf=function(T,R,S){if(T==null){return -1}var Q=0,P=T.length;if(S){if(typeof S=="number"){Q=(S<0?Math.max(0,P+S):S)}else{Q=O.sortedIndex(T,R);return T[Q]===R?Q:-1}}if(p&&T.indexOf===p){return T.indexOf(R,S)}for(;Q<P;Q++){if(T[Q]===R){return Q}}return -1};O.lastIndexOf=function(T,R,S){if(T==null){return -1}var P=S!=null;if(n&&T.lastIndexOf===n){return P?T.lastIndexOf(R,S):T.lastIndexOf(R)}var Q=(P?S:T.length);while(Q--){if(T[Q]===R){return Q}}return -1};O.range=function(U,S,T){if(arguments.length<=1){S=U||0;U=0}T=arguments[2]||1;var Q=Math.max(Math.ceil((S-U)/T),0);var P=0;var R=new Array(Q);while(P<Q){R[P++]=U;U+=T}return R};O.bind=function(R,Q){if(R.bind===I&&I){return I.apply(R,q.call(arguments,1))}var P=q.call(arguments,2);return function(){return R.apply(Q,P.concat(q.call(arguments)))}};O.partial=function(Q){var P=q.call(arguments,1);return function(){return Q.apply(this,P.concat(q.call(arguments)))}};O.bindAll=function(Q){var P=q.call(arguments,1);if(P.length===0){P=O.functions(Q)}K(P,function(R){Q[R]=O.bind(Q[R],Q)});return Q};O.memoize=function(R,Q){var P={};Q||(Q=O.identity);return function(){var S=Q.apply(this,arguments);return O.has(P,S)?P[S]:(P[S]=R.apply(this,arguments))}};O.delay=function(Q,R){var P=q.call(arguments,2);return setTimeout(function(){return Q.apply(null,P)},R)};O.defer=function(P){return O.delay.apply(O,[P,1].concat(q.call(arguments,1)))};O.throttle=function(U,W){var S,R,V,P;var T=0;var Q=function(){T=new Date;V=null;P=U.apply(S,R)};return function(){var X=new Date;var Y=W-(X-T);S=this;R=arguments;if(Y<=0){clearTimeout(V);V=null;T=X;P=U.apply(S,R)}else{if(!V){V=setTimeout(Q,Y)}}return P}};O.debounce=function(R,T,Q){var S,P;return function(){var X=this,W=arguments;var V=function(){S=null;if(!Q){P=R.apply(X,W)}};var U=Q&&!S;clearTimeout(S);S=setTimeout(V,T);if(U){P=R.apply(X,W)}return P}};O.once=function(R){var P=false,Q;return function(){if(P){return Q}P=true;Q=R.apply(this,arguments);R=null;return Q}};O.wrap=function(P,Q){return function(){var R=[P];J.apply(R,arguments);return Q.apply(this,R)}};O.compose=function(){var P=arguments;return function(){var Q=arguments;for(var R=P.length-1;R>=0;R--){Q=[P[R].apply(this,Q)]}return Q[0]}};O.after=function(Q,P){if(Q<=0){return P()}return function(){if(--Q<1){return P.apply(this,arguments)}}};O.keys=f||function(R){if(R!==Object(R)){throw new TypeError("Invalid object")}var Q=[];for(var P in R){if(O.has(R,P)){Q[Q.length]=P}}return Q};O.values=function(R){var P=[];for(var Q in R){if(O.has(R,Q)){P.push(R[Q])}}return P};O.pairs=function(R){var Q=[];for(var P in R){if(O.has(R,P)){Q.push([P,R[P]])}}return Q};O.invert=function(R){var P={};for(var Q in R){if(O.has(R,Q)){P[R[Q]]=Q}}return P};O.functions=O.methods=function(R){var Q=[];for(var P in R){if(O.isFunction(R[P])){Q.push(P)}}return Q.sort()};O.extend=function(P){K(q.call(arguments,1),function(Q){if(Q){for(var R in Q){P[R]=Q[R]}}});return P};O.pick=function(Q){var R={};var P=B.apply(F,q.call(arguments,1));K(P,function(S){if(S in Q){R[S]=Q[S]}});return R};O.omit=function(R){var S={};var Q=B.apply(F,q.call(arguments,1));for(var P in R){if(!O.contains(Q,P)){S[P]=R[P]}}return S};O.defaults=function(P){K(q.call(arguments,1),function(Q){if(Q){for(var R in Q){if(P[R]==null){P[R]=Q[R]}}}});return P};O.clone=function(P){if(!O.isObject(P)){return P}return O.isArray(P)?P.slice():O.extend({},P)};O.tap=function(Q,P){P(Q);return Q};var L=function(W,V,Q,R){if(W===V){return W!==0||1/W==1/V}if(W==null||V==null){return W===V}if(W instanceof O){W=W._wrapped}if(V instanceof O){V=V._wrapped}var T=e.call(W);if(T!=e.call(V)){return false}switch(T){case"[object String]":return W==String(V);case"[object Number]":return W!=+W?V!=+V:(W==0?1/W==1/V:W==+V);case"[object Date]":case"[object Boolean]":return +W==+V;case"[object RegExp]":return W.source==V.source&&W.global==V.global&&W.multiline==V.multiline&&W.ignoreCase==V.ignoreCase}if(typeof W!="object"||typeof V!="object"){return false}var P=Q.length;while(P--){if(Q[P]==W){return R[P]==V}}Q.push(W);R.push(V);var Y=0,Z=true;if(T=="[object Array]"){Y=W.length;Z=Y==V.length;if(Z){while(Y--){if(!(Z=L(W[Y],V[Y],Q,R))){break}}}}else{var U=W.constructor,S=V.constructor;if(U!==S&&!(O.isFunction(U)&&(U instanceof U)&&O.isFunction(S)&&(S instanceof S))){return false}for(var X in W){if(O.has(W,X)){Y++;if(!(Z=O.has(V,X)&&L(W[X],V[X],Q,R))){break}}}if(Z){for(X in V){if(O.has(V,X)&&!(Y--)){break}}Z=!Y}}Q.pop();R.pop();return Z};O.isEqual=function(Q,P){return L(Q,P,[],[])};O.isEmpty=function(Q){if(Q==null){return true}if(O.isArray(Q)||O.isString(Q)){return Q.length===0}for(var P in Q){if(O.has(Q,P)){return false}}return true};O.isElement=function(P){return !!(P&&P.nodeType===1)};O.isArray=x||function(P){return e.call(P)=="[object Array]"};O.isObject=function(P){return P===Object(P)};K(["Arguments","Function","String","Number","Date","RegExp"],function(P){O["is"+P]=function(Q){return e.call(Q)=="[object "+P+"]"}});if(!O.isArguments(arguments)){O.isArguments=function(P){return !!(P&&O.has(P,"callee"))}}if(typeof(/./)!=="function"){O.isFunction=function(P){return typeof P==="function"}}O.isFinite=function(P){return isFinite(P)&&!isNaN(parseFloat(P))};O.isNaN=function(P){return O.isNumber(P)&&P!=+P};O.isBoolean=function(P){return P===true||P===false||e.call(P)=="[object Boolean]"};O.isNull=function(P){return P===null};O.isUndefined=function(P){return P===void 0};O.has=function(Q,P){return l.call(Q,P)};O.noConflict=function(){z._=m;return this};O.identity=function(P){return P};O.times=function(T,S,R){var P=Array(T);for(var Q=0;Q<T;Q++){P[Q]=S.call(R,Q)}return P};O.random=function(Q,P){if(P==null){P=Q;Q=0}return Q+Math.floor(Math.random()*(P-Q+1))};var o={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};o.unescape=O.invert(o.escape);var M={escape:new RegExp("["+O.keys(o.escape).join("")+"]","g"),unescape:new RegExp("("+O.keys(o.unescape).join("|")+")","g")};O.each(["escape","unescape"],function(P){O[P]=function(Q){if(Q==null){return""}return(""+Q).replace(M[P],function(R){return o[P][R]})}});O.result=function(P,R){if(P==null){return null}var Q=P[R];return O.isFunction(Q)?Q.call(P):Q};O.mixin=function(P){K(O.functions(P),function(Q){var R=O[Q]=P[Q];O.prototype[Q]=function(){var S=[this._wrapped];J.apply(S,arguments);return v.call(this,R.apply(O,S))}})};var C=0;O.uniqueId=function(P){var Q=++C+"";return P?P+Q:Q};O.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var y=/(.)^/;var j={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var k=/\\|'|\r|\n|\t|\u2028|\u2029/g;O.template=function(X,S,R){var Q;R=O.defaults({},R,O.templateSettings);var T=new RegExp([(R.escape||y).source,(R.interpolate||y).source,(R.evaluate||y).source].join("|")+"|$","g");var U=0;var P="__p+='";X.replace(T,function(Z,aa,Y,ac,ab){P+=X.slice(U,ab).replace(k,function(ad){return"\\"+j[ad]});if(aa){P+="'+\n((__t=("+aa+"))==null?'':_.escape(__t))+\n'"}if(Y){P+="'+\n((__t=("+Y+"))==null?'':__t)+\n'"}if(ac){P+="';\n"+ac+"\n__p+='"}U=ab+Z.length;return Z});P+="';\n";if(!R.variable){P="with(obj||{}){\n"+P+"}\n"}P="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+P+"return __p;\n";try{Q=new Function(R.variable||"obj","_",P)}catch(V){V.source=P;throw V}if(S){return Q(S,O)}var W=function(Y){return Q.call(this,Y,O)};W.source="function("+(R.variable||"obj")+"){\n"+P+"}";return W};O.chain=function(P){return O(P).chain()};var v=function(P){return this._chain?O(P).chain():P};O.mixin(O);K(["pop","push","reverse","shift","sort","splice","unshift"],function(P){var Q=F[P];O.prototype[P]=function(){var R=this._wrapped;Q.apply(R,arguments);if((P=="shift"||P=="splice")&&R.length===0){delete R[0]}return v.call(this,R)}});K(["concat","join","slice"],function(P){var Q=F[P];O.prototype[P]=function(){return v.call(this,Q.apply(this._wrapped,arguments))}});O.extend(O.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);(function(){var x=this;var E=x.Backbone;var h=[];var G=h.push;var p=h.slice;var w=h.splice;var C;if(typeof exports!=="undefined"){C=exports}else{C=x.Backbone={}}C.VERSION="1.0.0";var O=x._;if(!O&&(typeof require!=="undefined")){O=require("underscore")}C.$=x.jQuery||x.Zepto||x.ender||x.$;C.noConflict=function(){x.Backbone=E;return this};C.emulateHTTP=false;C.emulateJSON=false;var M=C.Events={on:function(P,S,R){if(!A(this,"on",P,[S,R])||!S){return this}this._events||(this._events={});var Q=this._events[P]||(this._events[P]=[]);Q.push({callback:S,context:R,ctx:R||this});return this},once:function(Q,T,R){if(!A(this,"once",Q,[T,R])||!T){return this}var P=this;var S=O.once(function(){P.off(Q,S);T.apply(this,arguments)});S._callback=T;return this.on(Q,S,R)},off:function(P,Y,Q){var W,X,Z,V,U,R,T,S;if(!this._events||!A(this,"off",P,[Y,Q])){return this}if(!P&&!Y&&!Q){this._events={};return this}V=P?[P]:O.keys(this._events);for(U=0,R=V.length;U<R;U++){P=V[U];if(Z=this._events[P]){this._events[P]=W=[];if(Y||Q){for(T=0,S=Z.length;T<S;T++){X=Z[T];if((Y&&Y!==X.callback&&Y!==X.callback._callback)||(Q&&Q!==X.context)){W.push(X)}}}if(!W.length){delete this._events[P]}}}return this},trigger:function(R){if(!this._events){return this}var Q=p.call(arguments,1);if(!A(this,"trigger",R,Q)){return this}var S=this._events[R];var P=this._events.all;if(S){c(S,Q)}if(P){c(P,arguments)}return this},stopListening:function(S,P,U){var Q=this._listeners;if(!Q){return this}var R=!P&&!U;if(typeof P==="object"){U=this}if(S){(Q={})[S._listenerId]=S}for(var T in Q){Q[T].off(P,U,this);if(R){delete this._listeners[T]}}return this}};var z=/\s+/;var A=function(W,U,Q,T){if(!Q){return true}if(typeof Q==="object"){for(var S in Q){W[U].apply(W,[S,Q[S]].concat(T))}return false}if(z.test(Q)){var V=Q.split(z);for(var R=0,P=V.length;R<P;R++){W[U].apply(W,[V[R]].concat(T))}return false}return true};var c=function(U,S){var V,T=-1,R=U.length,Q=S[0],P=S[1],W=S[2];switch(S.length){case 0:while(++T<R){(V=U[T]).callback.call(V.ctx)}return;case 1:while(++T<R){(V=U[T]).callback.call(V.ctx,Q)}return;case 2:while(++T<R){(V=U[T]).callback.call(V.ctx,Q,P)}return;case 3:while(++T<R){(V=U[T]).callback.call(V.ctx,Q,P,W)}return;default:while(++T<R){(V=U[T]).callback.apply(V.ctx,S)}}};var F={listenTo:"on",listenToOnce:"once"};O.each(F,function(P,Q){M[Q]=function(T,R,V){var S=this._listeners||(this._listeners={});var U=T._listenerId||(T._listenerId=O.uniqueId("l"));S[U]=T;if(typeof R==="object"){V=this}T[P](R,V,this);return this}});M.bind=M.on;M.unbind=M.off;O.extend(C,M);var H=C.Model=function(P,R){var S;var Q=P||{};R||(R={});this.cid=O.uniqueId("c");this.attributes={};O.extend(this,O.pick(R,I));if(R.parse){Q=this.parse(Q,R)||{}}if(S=O.result(this,"defaults")){Q=O.defaults({},Q,S)}this.set(Q,R);this.changed={};this.initialize.apply(this,arguments)};var I=["url","urlRoot","collection"];O.extend(H.prototype,M,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(P){return O.clone(this.attributes)},sync:function(){return C.sync.apply(this,arguments)},get:function(P){return this.attributes[P]},escape:function(P){return O.escape(this.get(P))},has:function(P){return this.get(P)!=null},set:function(X,P,ab){var V,Y,Z,W,U,aa,R,T;if(X==null){return this}if(typeof X==="object"){Y=X;ab=P}else{(Y={})[X]=P}ab||(ab={});if(!this._validate(Y,ab)){return false}Z=ab.unset;U=ab.silent;W=[];aa=this._changing;this._changing=true;if(!aa){this._previousAttributes=O.clone(this.attributes);this.changed={}}T=this.attributes,R=this._previousAttributes;if(this.idAttribute in Y){this.id=Y[this.idAttribute]}for(V in Y){P=Y[V];if(!O.isEqual(T[V],P)){W.push(V)}if(!O.isEqual(R[V],P)){this.changed[V]=P}else{delete this.changed[V]}Z?delete T[V]:T[V]=P}if(!U){if(W.length){this._pending=true}for(var S=0,Q=W.length;S<Q;S++){this.trigger("change:"+W[S],this,T[W[S]],ab)}}if(aa){return this}if(!U){while(this._pending){this._pending=false;this.trigger("change",this,ab)}}this._pending=false;this._changing=false;return this},unset:function(P,Q){return this.set(P,void 0,O.extend({},Q,{unset:true}))},clear:function(Q){var P={};for(var R in this.attributes){P[R]=void 0}return this.set(P,O.extend({},Q,{unset:true}))},hasChanged:function(P){if(P==null){return !O.isEmpty(this.changed)}return O.has(this.changed,P)},changedAttributes:function(R){if(!R){return this.hasChanged()?O.clone(this.changed):false}var T,S=false;var Q=this._changing?this._previousAttributes:this.attributes;for(var P in R){if(O.isEqual(Q[P],(T=R[P]))){continue}(S||(S={}))[P]=T}return S},previous:function(P){if(P==null||!this._previousAttributes){return null}return this._previousAttributes[P]},previousAttributes:function(){return O.clone(this._previousAttributes)},fetch:function(Q){Q=Q?O.clone(Q):{};if(Q.parse===void 0){Q.parse=true}var P=this;var R=Q.success;Q.success=function(S){if(!P.set(P.parse(S,Q),Q)){return false}if(R){R(P,S,Q)}P.trigger("sync",P,S,Q)};K(this,Q);return this.sync("read",this,Q)},save:function(T,Q,X){var U,P,W,R=this.attributes;if(T==null||typeof T==="object"){U=T;X=Q}else{(U={})[T]=Q}if(U&&(!X||!X.wait)&&!this.set(U,X)){return false}X=O.extend({validate:true},X);if(!this._validate(U,X)){return false}if(U&&X.wait){this.attributes=O.extend({},R,U)}if(X.parse===void 0){X.parse=true}var S=this;var V=X.success;X.success=function(Z){S.attributes=R;var Y=S.parse(Z,X);if(X.wait){Y=O.extend(U||{},Y)}if(O.isObject(Y)&&!S.set(Y,X)){return false}if(V){V(S,Z,X)}S.trigger("sync",S,Z,X)};K(this,X);P=this.isNew()?"create":(X.patch?"patch":"update");if(P==="patch"){X.attrs=U}W=this.sync(P,this,X);if(U&&X.wait){this.attributes=R}return W},destroy:function(Q){Q=Q?O.clone(Q):{};var P=this;var T=Q.success;var R=function(){P.trigger("destroy",P,P.collection,Q)};Q.success=function(U){if(Q.wait||P.isNew()){R()}if(T){T(P,U,Q)}if(!P.isNew()){P.trigger("sync",P,U,Q)}};if(this.isNew()){Q.success();return false}K(this,Q);var S=this.sync("delete",this,Q);if(!Q.wait){R()}return S},url:function(){var P=O.result(this,"urlRoot")||O.result(this.collection,"url")||u();if(this.isNew()){return P}return P+(P.charAt(P.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(Q,P){return Q},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(P){return this._validate({},O.extend(P||{},{validate:true}))},_validate:function(R,Q){if(!Q.validate||!this.validate){return true}R=O.extend({},this.attributes,R);var P=this.validationError=this.validate(R,Q)||null;if(!P){return true}this.trigger("invalid",this,P,O.extend(Q||{},{validationError:P}));return false}});var b=["keys","values","pairs","invert","pick","omit"];O.each(b,function(P){H.prototype[P]=function(){var Q=p.call(arguments);Q.unshift(this.attributes);return O[P].apply(O,Q)}});var d=C.Collection=function(Q,P){P||(P={});if(P.url){this.url=P.url}if(P.model){this.model=P.model}if(P.comparator!==void 0){this.comparator=P.comparator}this._reset();this.initialize.apply(this,arguments);if(Q){this.reset(Q,O.extend({silent:true},P))}};var q={add:true,remove:true,merge:true};var N={add:true,merge:false,remove:false};O.extend(d.prototype,M,{model:H,initialize:function(){},toJSON:function(P){return this.map(function(Q){return Q.toJSON(P)})},sync:function(){return C.sync.apply(this,arguments)},add:function(Q,P){return this.set(Q,O.defaults(P||{},N))},remove:function(U,S){U=O.isArray(U)?U.slice():[U];S||(S={});var T,P,R,Q;for(T=0,P=U.length;T<P;T++){Q=this.get(U[T]);if(!Q){continue}delete this._byId[Q.id];delete this._byId[Q.cid];R=this.indexOf(Q);this.models.splice(R,1);this.length--;if(!S.silent){S.index=R;Q.trigger("remove",Q,this,S)}this._removeReference(Q)}return this},set:function(Q,ac){ac=O.defaults(ac||{},q);if(ac.parse){Q=this.parse(Q,ac)}if(!O.isArray(Q)){Q=Q?[Q]:[]}var X,T,Z,aa,R,Y;var S=ac.at;var W=this.comparator&&(S==null)&&ac.sort!==false;var U=O.isString(this.comparator)?this.comparator:null;var ab=[],P=[],V={};for(X=0,T=Q.length;X<T;X++){if(!(Z=this._prepareModel(Q[X],ac))){continue}if(R=this.get(Z)){if(ac.remove){V[R.cid]=true}if(ac.merge){R.set(Z.attributes,ac);if(W&&!Y&&R.hasChanged(U)){Y=true}}}else{if(ac.add){ab.push(Z);Z.on("all",this._onModelEvent,this);this._byId[Z.cid]=Z;if(Z.id!=null){this._byId[Z.id]=Z}}}}if(ac.remove){for(X=0,T=this.length;X<T;++X){if(!V[(Z=this.models[X]).cid]){P.push(Z)}}if(P.length){this.remove(P,ac)}}if(ab.length){if(W){Y=true}this.length+=ab.length;if(S!=null){w.apply(this.models,[S,0].concat(ab))}else{G.apply(this.models,ab)}}if(Y){this.sort({silent:true})}if(ac.silent){return this}for(X=0,T=ab.length;X<T;X++){(Z=ab[X]).trigger("add",Z,this,ac)}if(Y){this.trigger("sort",this,ac)}return this},reset:function(S,Q){Q||(Q={});for(var R=0,P=this.models.length;R<P;R++){this._removeReference(this.models[R])}Q.previousModels=this.models;this._reset();this.add(S,O.extend({silent:true},Q));if(!Q.silent){this.trigger("reset",this,Q)}return this},push:function(Q,P){Q=this._prepareModel(Q,P);this.add(Q,O.extend({at:this.length},P));return Q},pop:function(Q){var P=this.at(this.length-1);this.remove(P,Q);return P},unshift:function(Q,P){Q=this._prepareModel(Q,P);this.add(Q,O.extend({at:0},P));return Q},shift:function(Q){var P=this.at(0);this.remove(P,Q);return P},slice:function(Q,P){return this.models.slice(Q,P)},get:function(P){if(P==null){return void 0}return this._byId[P.id!=null?P.id:P.cid||P]},at:function(P){return this.models[P]},where:function(P,Q){if(O.isEmpty(P)){return Q?void 0:[]}return this[Q?"find":"filter"](function(R){for(var S in P){if(P[S]!==R.get(S)){return false}}return true})},findWhere:function(P){return this.where(P,true)},sort:function(P){if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}P||(P={});if(O.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(O.bind(this.comparator,this))}if(!P.silent){this.trigger("sort",this,P)}return this},sortedIndex:function(P,S,Q){S||(S=this.comparator);var R=O.isFunction(S)?S:function(T){return T.get(S)};return O.sortedIndex(this.models,P,R,Q)},pluck:function(P){return O.invoke(this.models,"get",P)},fetch:function(P){P=P?O.clone(P):{};if(P.parse===void 0){P.parse=true}var R=P.success;var Q=this;P.success=function(S){var T=P.reset?"reset":"set";Q[T](S,P);if(R){R(Q,S,P)}Q.trigger("sync",Q,S,P)};K(this,P);return this.sync("read",this,P)},create:function(Q,P){P=P?O.clone(P):{};if(!(Q=this._prepareModel(Q,P))){return false}if(!P.wait){this.add(Q,P)}var S=this;var R=P.success;P.success=function(T){if(P.wait){S.add(Q,P)}if(R){R(Q,T,P)}};Q.save(null,P);return Q},parse:function(Q,P){return Q},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(R,Q){if(R instanceof H){if(!R.collection){R.collection=this}return R}Q||(Q={});Q.collection=this;var P=new this.model(R,Q);if(!P._validate(R,Q)){this.trigger("invalid",this,R,Q);return false}return P},_removeReference:function(P){if(this===P.collection){delete P.collection}P.off("all",this._onModelEvent,this)},_onModelEvent:function(R,Q,S,P){if((R==="add"||R==="remove")&&S!==this){return}if(R==="destroy"){this.remove(Q,P)}if(Q&&R==="change:"+Q.idAttribute){delete this._byId[Q.previous(Q.idAttribute)];if(Q.id!=null){this._byId[Q.id]=Q}}this.trigger.apply(this,arguments)}});var B=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];O.each(B,function(P){d.prototype[P]=function(){var Q=p.call(arguments);Q.unshift(this.models);return O[P].apply(O,Q)}});var m=["groupBy","countBy","sortBy"];O.each(m,function(P){d.prototype[P]=function(S,Q){var R=O.isFunction(S)?S:function(T){return T.get(S)};return O[P](this.models,R,Q)}});var J=C.View=function(P){this.cid=O.uniqueId("view");this._configure(P||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var y=/^(\S+)\s*(.*)$/;var f=["model","collection","el","id","attributes","className","tagName","events"];O.extend(J.prototype,M,{tagName:"div",$:function(P){return this.$el.find(P)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(P,Q){if(this.$el){this.undelegateEvents()}this.$el=P instanceof C.$?P:C.$(P);this.el=this.$el[0];if(Q!==false){this.delegateEvents()}return this},delegateEvents:function(T){if(!(T||(T=O.result(this,"events")))){return this}this.undelegateEvents();for(var S in T){var U=T[S];if(!O.isFunction(U)){U=this[T[S]]}if(!U){continue}var R=S.match(y);var Q=R[1],P=R[2];U=O.bind(U,this);Q+=".delegateEvents"+this.cid;if(P===""){this.$el.on(Q,U)}else{this.$el.on(Q,P,U)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(P){if(this.options){P=O.extend({},O.result(this,"options"),P)}O.extend(this,O.pick(P,f));this.options=P},_ensureElement:function(){if(!this.el){var P=O.extend({},O.result(this,"attributes"));if(this.id){P.id=O.result(this,"id")}if(this.className){P["class"]=O.result(this,"className")}var Q=C.$("<"+O.result(this,"tagName")+">").attr(P);this.setElement(Q,false)}else{this.setElement(O.result(this,"el"),false)}}});C.sync=function(V,Q,P){var S=l[V];O.defaults(P||(P={}),{emulateHTTP:C.emulateHTTP,emulateJSON:C.emulateJSON});var U={type:S,dataType:"json"};if(!P.url){U.url=O.result(Q,"url")||u()}if(P.data==null&&Q&&(V==="create"||V==="update"||V==="patch")){U.contentType="application/json";U.data=JSON.stringify(P.attrs||Q.toJSON(P))}if(P.emulateJSON){U.contentType="application/x-www-form-urlencoded";U.data=U.data?{model:U.data}:{}}if(P.emulateHTTP&&(S==="PUT"||S==="DELETE"||S==="PATCH")){U.type="POST";if(P.emulateJSON){U.data._method=S}var R=P.beforeSend;P.beforeSend=function(W){W.setRequestHeader("X-HTTP-Method-Override",S);if(R){return R.apply(this,arguments)}}}if(U.type!=="GET"&&!P.emulateJSON){U.processData=false}if(U.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){U.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var T=P.xhr=C.ajax(O.extend(U,P));Q.trigger("request",Q,T,P);return T};var l={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};C.ajax=function(){return C.$.ajax.apply(C.$,arguments)};var r=C.Router=function(P){P||(P={});if(P.routes){this.routes=P.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var t=/\((.*?)\)/g;var v=/(\(\?)?:\w+/g;var e=/\*\w+/g;var j=/[\-{}\[\]+?.,\\\^$|#\s]/g;O.extend(r.prototype,M,{initialize:function(){},route:function(Q,R,S){if(!O.isRegExp(Q)){Q=this._routeToRegExp(Q)}if(O.isFunction(R)){S=R;R=""}if(!S){S=this[R]}var P=this;C.history.route(Q,function(U){var T=P._extractParameters(Q,U);S&&S.apply(P,T);P.trigger.apply(P,["route:"+R].concat(T));P.trigger("route",R,T);C.history.trigger("route",P,R,T)});return this},navigate:function(Q,P){C.history.navigate(Q,P);return this},_bindRoutes:function(){if(!this.routes){return}this.routes=O.result(this,"routes");var Q,P=O.keys(this.routes);while((Q=P.pop())!=null){this.route(Q,this.routes[Q])}},_routeToRegExp:function(P){P=P.replace(j,"\\$&").replace(t,"(?:$1)?").replace(v,function(R,Q){return Q?R:"([^/]+)"}).replace(e,"(.*?)");return new RegExp("^"+P+"$")},_extractParameters:function(P,Q){var R=P.exec(Q).slice(1);return O.map(R,function(S){return S?decodeURIComponent(S):null})}});var k=C.History=function(){this.handlers=[];O.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var D=/^[#\/]|\s+$/g;var g=/^\/+|\/+$/g;var L=/msie [\w.]+/;var o=/\/$/;k.started=false;O.extend(k.prototype,M,{interval:50,getHash:function(Q){var P=(Q||this).location.href.match(/#(.*)$/);return P?P[1]:""},getFragment:function(R,Q){if(R==null){if(this._hasPushState||!this._wantsHashChange||Q){R=this.location.pathname;var P=this.root.replace(o,"");if(!R.indexOf(P)){R=R.substr(P.length)}}else{R=this.getHash()}}return R.replace(D,"")},start:function(R){if(k.started){throw new Error("Backbone.history has already been started")}k.started=true;this.options=O.extend({},{root:"/"},this.options,R);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var Q=this.getFragment();var P=document.documentMode;var T=(L.exec(navigator.userAgent.toLowerCase())&&(!P||P<=7));this.root=("/"+this.root+"/").replace(g,"/");if(T&&this._wantsHashChange){this.iframe=C.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(Q)}if(this._hasPushState){C.$(window).on("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!T){C.$(window).on("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=Q;var U=this.location;var S=U.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!S){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&S&&U.hash){this.fragment=this.getHash().replace(D,"");this.history.replaceState({},document.title,this.root+this.fragment+U.search)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){C.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);k.started=false},route:function(P,Q){this.handlers.unshift({route:P,callback:Q})},checkUrl:function(Q){var P=this.getFragment();if(P===this.fragment&&this.iframe){P=this.getFragment(this.getHash(this.iframe))}if(P===this.fragment){return false}if(this.iframe){this.navigate(P)}this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(R){var Q=this.fragment=this.getFragment(R);var P=O.any(this.handlers,function(S){if(S.route.test(Q)){S.callback(Q);return true}});return P},navigate:function(R,Q){if(!k.started){return false}if(!Q||Q===true){Q={trigger:Q}}R=this.getFragment(R||"");if(this.fragment===R){return}this.fragment=R;var P=this.root+R;if(this._hasPushState){this.history[Q.replace?"replaceState":"pushState"]({},document.title,P)}else{if(this._wantsHashChange){this._updateHash(this.location,R,Q.replace);if(this.iframe&&(R!==this.getFragment(this.getHash(this.iframe)))){if(!Q.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,R,Q.replace)}}else{return this.location.assign(P)}}if(Q.trigger){this.loadUrl(R)}},_updateHash:function(P,R,S){if(S){var Q=P.href.replace(/(javascript:|#).*$/,"");P.replace(Q+"#"+R)}else{P.hash="#"+R}}});C.history=new k;var n=function(P,R){var Q=this;var T;if(P&&O.has(P,"constructor")){T=P.constructor}else{T=function(){return Q.apply(this,arguments)}}O.extend(T,Q,R);var S=function(){this.constructor=T};S.prototype=Q.prototype;T.prototype=new S;if(P){O.extend(T.prototype,P)}T.__super__=Q.prototype;return T};H.extend=d.extend=r.extend=J.extend=k.extend=n;var u=function(){throw new Error('A "url" property or function must be specified')};var K=function(R,Q){var P=Q.error;Q.error=function(S){if(P){P(R,S,Q)}R.trigger("error",R,S,Q)}}}).call(this);(function(b){if(typeof module==="function"){module.exports=b(this.jQuery||require("jquery"))}else{this.NProgress=b(this.jQuery)}})(function(f){var b={};b.version="0.1.2";var c=b.settings={minimum:0.08,easing:"linear",positionUsing:"",speed:300,trickle:true,trickleRate:0.08,trickleSpeed:400,showSpinner:false,template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};b.configure=function(h){f.extend(c,h);return this};b.status=null;b.set=function(o){var j=b.isStarted();o=g(o,c.minimum,1);b.status=(o===1?null:o);var h=b.render(!j),l=h.find('[role="bar"]'),k=c.speed,m=c.easing;h.queue(function(n){if(c.positionUsing===""){c.positionUsing=b.getPositioningCSS()}l.css(d(o,k,m));if(o===1){h.css({transition:"none",opacity:1});setTimeout(function(){h.css({transition:"all "+k+"ms linear",opacity:0});setTimeout(function(){b.remove();n()},k)},k)}else{setTimeout(n,k)}});return this};b.isStarted=function(){return typeof b.status==="number"};b.start=function(){if(!b.status){b.set(0)}var h=function(){setTimeout(function(){if(!b.status){return}b.trickle();h()},c.trickleSpeed)};if(c.trickle){h()}return this};b.done=function(h){if(!h&&!b.status){return this}return b.inc(0.3+0.5*Math.random()).set(1)};b.inc=function(h){var j=b.status;if(!j){return b.start()}else{if(typeof h!=="number"){h=(1-j)*g(Math.random()*j,0.1,0.95)}j=g(j+h,0,0.994);return b.set(j)}};b.trickle=function(){return b.inc(Math.random()*c.trickleRate)};b.render=function(h){if(b.isRendered()){return f("#nprogress")}f("html").addClass("nprogress-busy");var k=f("<div id='nprogress'>").html(c.template);var j=h?"-100":e(b.status||0);k.find('[role="bar"]').css({transition:"all 0 linear",});if(!c.showSpinner){k.find('[role="spinner"]').remove()}k.appendTo(document.body);return k};b.remove=function(){f("html").removeClass("nprogress-busy");f("#nprogress").remove()};b.isRendered=function(){return(f("#nprogress").length>0)};b.getPositioningCSS=function(){return"margin"};function g(k,j,h){if(k<j){return j}if(k>h){return h}return k}function e(h){return(-1+h)*100}function d(l,j,k){var h;h={"margin-left":e(l)+"%"};h.transition="all "+j+"ms "+k;return h}return b});var artspace=(function(b){_.extend((b.templates=b.templates||{}),{"cart-template":_.template(['<div class="arrow-holder"></div>','<div id="item-count">(<%= total %>) ITEMS IN YOUR CART</div>','<ul class="cart-list"></ul>','<div class="btn-holder">','<a href="<%= link %>" id="ddc-button" class="as-btn btn btn-pink">CONTINUE TO CART</a>','<a href="#" class="continue-shopping visible-xs">Continue Shopping</a>',"</div>"].join("")),"cart-item-template":_.template(["<% if (/gcert/gi.test(data.sku)) { %>",'<img id="cart-thumb" src="<%= data.thumbnail_url %>">','<div class="cart-work"><%= data.institution %></div>','<div class="cart-artist"><%= data.name %></div>','<div class="cart-price">Price: <%= data.price %></div>','<div class="cart-quantity">Quantity: <%= data.qty %></div>',"<%  } else { %>",'<a href="<%= data.product_link %>">','<img id="cart-thumb" src="<%= data.thumbnail_url %>">','<div class="cart-work"><%= data.name %></div>','<div class="cart-artist"><span>By</span> <%= data.artist_name %></div>','<div class="cart-price">Price: ',"<% if (data.on_sale) { %>",'<em class="price on-sale"><%= data.original_price %></em>','<em class="sale-price"><%= data.price %></em>',"<% } else { %>",'<em class="price"><%= data.price %></em>',"<% } %>","</div>",'<div class="cart-quantity">Quantity: <%= data.qty %></div>',"</a>",'<a href="#" class="cart-remove">Remove</a>',"<% } %>",].join(""))});return b}(artspace||{}));var artspace=artspace||{};(function(){_.extend((artspace.templates=artspace.templates||{}),{"header-promo-template":_.template(['<table style="width: <%= promos.length * 100 %>%;"><tr>',"<% _.each(promos, function (p, i) { %>","<% if (p.promo_text) { %>",'<td style="width: <%= 100 / promos.length %>%;">',"<div class=\"promo-banner<%= 0 === i ? ' active' : '' %>\" data-campaign=\"<%= p.google_id || 'no-identifier' %>\">",'<% if (p.image) { %><img src="<%= p.image %>" class="hidden-phone"><% } %>',"<%= p.promo_text %>","<% if (p.promo_link && p.cta_text) { %>",' <a href="<%= p.promo_link %>" target="_blank" class="promo-link <%= p.cta_color %>">',"<%= p.cta_text %>",' <i class="caret caret-right"></i>',"</a>","<% } %>","<% if (p.terms_link && p.terms_text) { %>",' <a href="<%= p.terms_link %>" target="_blank" class="terms-link">',"<%= p.terms_text %>","</a>","<% } %>","</div>\n","</td>","<% } %>","<% }) %>","</tr></table>"].join(""))})}());!function(b){b(function(){b.support.transform3d=(function(){var c=(function(){var f=document.createElement("p"),g,e={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(f,null);for(var d in e){if(f.style[d]!==undefined){f.style[d]="translate3d(1px,1px,1px)";g=window.getComputedStyle(f).getPropertyValue(e[d])}}document.body.removeChild(f);return(g!==undefined&&g.length>0&&g!=="none")});return c()})()})}(window.jQuery);var artspace=artspace||{};var isTouch=(("ontouchstart" in window)||(navigator.msMaxTouchPoints>0));$.cookie("currency")||($.cookie("currency",artspace.user.get("currency"),{path:"/",expires:3650,domain:"artspace.com"}),$.cookie("measurement_units",artspace.user.get("units"),{path:"/",expires:3650,domain:"artspace.com"}));$.cookie("country_code")||$.cookie("country_code",artspace.user.get("country"),{path:"/",expires:3650,domain:"artspace.com"});artspace.track=function(b,d,c){if(typeof dataLayer!=="undefined"){dataLayer.push({event:"GAevent",eventCategory:b,eventAction:d,eventLabel:c})}};artspace.social={openPopup:function(c,g,d,b){var e=Math.floor((screen.width-d)/2);var f=Math.floor((screen.height-b)/2);window.open(c,g,"width="+d+",height="+b+",left="+e+",top="+f)},getBitlyUrl:function(b,c){$.post("/api/shorten",{long_url:b},function(d){if("ok"==d.status){c(d.data.url)}},"json")},eventTracking:artspace.track};artspace.geoSwitch={init:function(){$("#geo-toggle .dropdown-menu a").on("click",$.proxy(this.switchCurr,this));$(".unit-toggle").click($.proxy(this.switchUnits,this))},doSwitch:function(c){var b={path:"/",expires:3650,domain:"artspace.com"};c=c.split(":");"unit"===c[0]&&$.cookie("measurement_units",c[1],b);"curr"===c[0]&&$.cookie("currency",c[1],b);window.location.reload(true)},switchCurr:function(b){this.doSwitch($(b.currentTarget).data("value"))},switchUnits:function(b){this.doSwitch("unit:"+$(b.currentTarget).data("unit"))}};$(function(){var d;if(/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent)){var f=$("#cart-link").attr("href");$("html").addClass("isMobile")}else{$("html").addClass("notMobile")}if($("body#partners").length!=0){$(".infinitescroll-container").infinitescroll({navSelector:".infinitescroll-container .navigation",nextSelector:".infinitescroll-container .navigation a:first",itemSelector:".infinitescroll-element",loading:{img:"//m.artspace-static.com/static/common/img/loaders/image-loading-med.gif",msgText:"",finishedMsg:""}})}if($("html").hasClass("notMobile")){$(".as-tip").tooltip()}else{$(".mobile-tip").not("a").tooltip({trigger:"click"})}artspace.geoSwitch.init();$("#follow-enclosure").bind("click",function(n){if($(n.target).hasClass("follow-close")){return false}else{var p,t,u,q,o,v,w;p=$(".follow-anchor").offset().top;t=window.innerHeight;u=window.pageYOffset;q=t+u;o=p+120;v=o-q;w=p-u;if(v>0){$("html, body").animate({scrollTop:u+v},200)}if(w<200){var r=200-w;$("html, body").animate({scrollTop:u-r},200)}}});var l={preload:false,preloadImage:"common/img/loaders/loading-marquee.gif",effect:"fade",generateNextPrev:false};if($("#home").length!=0){console.log("slides init");$("#slides").slides($.extend(l,{fadeSpeed:350,play:7000,pause:2000}))}if($("#collecting_detail").length+$("#promotion_preview").length>0){$(".rslides").responsiveSlides({timeout:8000,pager:true,nav:true,namespace:"rslides",navContainer:".rslides"});$(".rslides_nav").html("").append('<div class="arrow"><div class="caret"></div></div>')}var g=(new Date()).getTime();$(".target").val(window.location.href);$("#search").focus();$.validator.addMethod("phone",function(p,n){if(p==""){return true}var o=p.replace(/[\s()+-]|ext\.?/gi,"");return this.optional(n)||((/^\d{10}$/).test(o))});$("#index a, .static-return-to-top").on("click",j);function j(n){$("body").animate({scrollTop:$(n.currentTarget.hash).position().top-20},1000);n.preventDefault()}$(".selectpicker").selectpicker({dropupAuto:false});if($("html").hasClass("isMobile")){$(".selectpicker").css("visibility","visible").selectpicker("mobile")}artspace.modals.init();artspace.follows.init_follows($(".follow-obj"));var m=window.parseFloat($.cookie("pageviews"))||0;if(document.referrer.indexOf("artspace")>=0){0<=m&&(m+=1);$.cookie("pageviews",m,{path:"/",expires:3650,domain:"artspace.com"})}if(isNaN(parseFloat($.cookie("pageviews")))&&typeof $.cookie("as_entry_params")=="undefined"){var b=window.location.search;$.cookie("as_entry_params",b,{path:"/",expires:3650,domain:"artspace.com"})}if(parseFloat($.cookie("pageviews"))==1&&!artspace.user.logged_in&&window.location.href.indexOf("private-room")<=1){var h=$.cookie("su");if(!h){var e=$.cookie("as_entry_params");var k=parseFloat($.cookie("pageviews"));if(typeof e!="undefined"&&e.indexOf("netaporterpromo")>=0){artspace.modals.show("#net_join");artspace.track("Preference Modal"," View Promo Join","Net-A-Porter")}else{artspace.modals.show("#preference_join");artspace.track("Preference Modal"," View Join","Preference Join")}artspace.modals.init_preferences_join();$(".twitter-typeahead, .tt-dropdown-menu").addClass("col-sm-12");k+=1;$.cookie("pageviews",k,{path:"/",expires:3650,domain:"artspace.com"})}}$("#collector_category_modal, #art_follow_modal, #artist_follow_modal, #partner_follow_modal").find('input[type="checkbox"], input[type="radio"]').customCheckbox();$("#art_follow_modal, #artist_follow_modal, #partner_follow_modal").find('input[type="checkbox"], input[type="radio"]').bind("click",function(){var o=$(this).attr("data-obj-id");var p=$(this).attr("data-obj-type");if($(this).prop("checked")){var n=""}else{var n="1"}artspace.follows.follow(o,p,n,"pref_modal")});$(".art-follow").submit(function(n){n.preventDefault();artspace.modals.show("#artist_follow")});$(".artist-follow").submit(function(n){n.preventDefault();artspace.modals.show("#partner_follow")});$(".partner-follow").submit(function(n){n.preventDefault();artspace.modals.show("#preference_confirm")});$(".preference_hide").bind("click",function(){$("#preference_confirm_modal").modal("hide")});$(".custom-facebook-button").click(function(n){n.preventDefault()});d=$.cookie("artspace-uid");if(isNaN(parseInt(d))){var c=Math.floor(Math.random()*10000000000);$.cookie("artspace-uid",c,{path:"/",expires:36500,domain:"artspace.com"})}if(parseInt(d)>=1){dataLayer.push({"artspace-SID":d.toString()});aid=d.split("/")[0];sub_id=d.split("/")[1];if(parseInt(aid)>=1){dataLayer.push({artspaceID:aid.toString()})}if(parseInt(sub_id)>=1){dataLayer.push({subscriberID:sub_id.toString()})}}});(function(d,c,f){var e={period:1000,toDate:new Date(),callback:function(){}};function b(h,g){this.element=h;this.options=d.extend({},e,g);this.init()}b.prototype={init:function(){this.$el=d(this.element);this.handlers=["seconds","minutes","hours","days","weeks"];this.interval=this.$el.data("countdownInterval");this.currentDate=new Date();this.toDate=this.sanitizeDate(this.options.toDate);this.secondsLeft=Math.floor((this.toDate.valueOf()-this.currentDate.valueOf())/1000);this.values={};this.triggerEvents();this.start()},sanitizeDate:function(g){if(!(g instanceof Date)){if(String(g).match(/^[0-9]*$/)){return new Date(g)}if(g.match(/([0-9]{1,2})\/([0-9]{1,2})\/([0-9]{2,4})\s([0-9]{1,2})\:([0-9]{2})\:([0-9]{2})/)||g.match(/([0-9]{2,4})\/([0-9]{1,2})\/([0-9]{1,2})\s([0-9]{1,2})\:([0-9]{2})\:([0-9]{2})/)){return new Date(g)}if(g.match(/([0-9]{1,2})\/([0-9]{1,2})\/([0-9]{2,4})/)||g.match(/([0-9]{2,4})\/([0-9]{1,2})\/([0-9]{1,2})/)){return new Date(g)}throw new Error("Doesn't seen to be a valid date object or string")}},triggerEvents:function(){if(this.$el.closest("html").length===0){this.dispatchEvent("removed");this.stop();return}var k,h,j,g=this.handlers.length;if(this.secondsLeft>0){k=this.secondsLeft-=1}this.lasting={seconds:k%60,minutes:Math.floor(k/60)%60,hours:Math.floor(k/60/60)%24,days:Math.floor(k/60/60/24),weeks:Math.floor(k/60/60/24/7)};for(j=0;j<g;j+=1){h=this.handlers[j];if(this.values[h]!==this.lasting[h]){this.values[h]=this.lasting[h];this.dispatchEvent(h)}}if(k===0){this.stop();this.dispatchEvent("finished")}},dispatchEvent:function(g){var h=d.Event(g);h.value=this.values[g]||"0";h.toDate=this.toDate;h.lasting=this.lasting;switch(g){case"seconds":case"minutes":case"hours":h.value=h.value<10?"0"+h.value.toString():h.value.toString();break;default:if(h.value){h.value=h.value.toString()}break}this.options.callback.call(this.$el,h)},start:function(){if(this.interval){this.stop()}this.$el.data("countdownInterval",c.setInterval(d.proxy(this.triggerEvents,this),this.options.period));this.interval=this.$el.data("countdownInterval")},stop:function(){c.clearInterval(this.interval)}};d.fn.countdown=function(g){return this.each(function(){if(!d.data(this,"countdown")){d.data(this,"countdown",new b(this,g))}})}}(jQuery,window));artspace.utils=artspace.utils||{};$.extend(true,artspace.utils,{commafy:function(g,f){var e=(g+"").split("."),d=e[0],b=1<e.length?"."+e[1]:"";for(g=/(\d+)(\d{3})/;g.test(d);){d=d.replace(g,"$1,$2")}cs="";if(f){cs=f==="EUR"?"":f==="GBP"?"":"$"}return cs+d+b},form_data:function(b,c){var d={};if(c){d.csrfmiddlewaretoken=artspace.user.csrf_token}b.find("input, select, textarea").filter(".gather").each(function(){var e=$(this);if(e.filter('input[type="checkbox"]').length){d[e.attr("name")]=e.prop("checked")}else{d[e.attr("name")]=e.val()}});return d},make_request:function(d,e,g){e.csrfmiddlewaretoken=artspace.user.csrf_token;g=g||false;if(!g){artspace.q_progress.start()}var b={type:"POST",async:true,data:e};var f=false,c=window.location.procotol+"//"+window.location.host;if(d[0]!="/"&&d.indexOf(c)!=0){f=true}if(window.XDomainRequest&&!jQuery.support.cors){if(f){b.dataType="jsonp"}if(d[0]=="/"){d=window.location.protocol+"//"+window.location.host+d}}else{if(f){b.crossDomain=true;b.xhrFields={withCredentials:true}}}b.url=d;return $.ajax(b).always(function(){if(!g){artspace.q_progress.done()}})},make_api_request:function(c,d,f,e,b){return artspace.utils.make_request(c,d,f).always(function(h,g,j){if(g=="success"&&h.status&&h.status=="ok"){e(h)}else{b(h)}})},numberfy:function(b){return parseFloat(b.replace(/[\s\$,]/g,""))}});artspace.q_progress=artspace.q_progress||{};$.extend(true,artspace.q_progress,{progress_count:0,start:function(){this.progress_count++;if(this.progress_count==1){return NProgress.start()}},done:function(b){this.progress_count=Math.max(this.progress_count-1,0);if(this.progress_count==0){return NProgress.done(b)}return false}});$("#readMore, #readLess").bind("click",function(){$(".auctionDesc").toggle()});(function(c){function b(d,e){var g=this,f=0,h={transition:true},e=c.extend({},h,e);this.init=function(){if(c.support.transition&&!c.support.transition.end){e.transition=false}g.$shortDesc=d.find(".short-desc");g.$fullDesc=d.find(".full-desc");d.toggleClass("animate",e.transition);d.find(".read-more").click(this.showMore);d.find(".read-less").click(this.showLess)};this.toggle=function(){g.$shortDesc.toggle();g.$fullDesc.toggle();d.toggleClass("expanded");d.find(".read-more, .read-less").toggle()};this.showMore=function(){if(e.transition){f=g.$shortDesc.height();g.$fullDesc.css("max-height",f)}g.toggle();if(e.transition){g.$fullDesc.css("max-height",g.$fullDesc[0].scrollHeight)}return false};this.showLess=function(){console.log("showing less");if(e.transition){g.$fullDesc.one(c.support.transition.end,g.toggle);g.$fullDesc.css("max-height",f)}else{g.toggle()}return false};this.init()}c.fn.asExpandable=function(d){return this.each(function(){if(!c(this).data("asExpandable")){c(this).data("asExpandable",new b(c(this),d))}})}})(jQuery);(function($){$.fn.resizeend=function(fn){var timeout,my_function=eval(fn);this.resize(function(){clearTimeout(timeout);timeout=setTimeout(my_function,100)});return this}})(jQuery);var CountdownView=Backbone.View.extend({finished:false,initialize:function(){_.bindAll(this,"callback");this.render()},callback:function(b){if(b.type==="finished"){this.finished=true}else{this.$("."+b.type).html(b.value)}},render:function(){this.$el.countdown({toDate:this.options.end,callback:this.callback})}});(function(c){function b(l,m){var d=this,f={animate:true,container:"html,body",showThreshhold:false,autoDisappear:true},m=c.extend(f,l.data(),m),h=0,j=0,k=Date.now(),e=2000,g=false;this.hideInterval=function(){var n=Date.now();if(n-k>=e){l.removeClass("fade-in");h=window.pageYOffset;clearInterval(g)}};this.scroll=function(n){if(h==window.pageYOffset){return}k=Date.now();if(((j>0&&window.pageYOffset>j)||(j<0&&window.pageYOffset<Math.abs(j)))){if(!l.hasClass("fade-in")){l.addClass("fade-in");if(m.autoDisappear){g=setInterval(d.hideInterval,1000)}}}else{if(l.hasClass("fade-in")){l.removeClass("fade-in")}}};this.resize=function(n){j=m.showThreshhold*c(document).height()};this.toTop=function(n){if(m.animate){c(m.container).animate({scrollTop:0},"slow",function(){l.removeClass("fade-in")})}else{c(m.container).scrollTop(0);l.removeClass("fade-in")}};l.click(this.toTop);if(m.showThreshhold){if(1>m.showThreshhold>0){j=m.showThreshhold*c(document).height();c(window).resizeend(this.resize)}else{j=m.showThreshhold}if("ontouchmove" in document.documentElement){c(window).on("touchmove",this.scroll)}else{c(window).scroll(this.scroll)}}}c.fn.asToTop=function(d){return this.each(function(){if(!c(this).data("asToTop")){c(this).data("asToTop",new b(c(this),d))}})}})(jQuery);(function(c){function b(d,e){var f=this,g={fireOnce:true,visible:function(){}},e=c.extend(g,d.data(),e);this.init=function(){c(window).on("scroll",f.scroll);if("ontouchmove" in document.documentElement){c(window).on("touchmove",f.scroll)}};this.scroll=function(){var h=d[0].getBoundingClientRect();if(h.top>=0&&h.bottom<window.innerHeight&&d.is(":visible")){e.visible();if(e.fireOnce){c(window).off("scroll",f.scroll).off("touchmove",f.scroll)}}};this.init()}c.fn.inViewport=function(d){return this.each(function(){if(!c(this).data("inViewport")){c(this).data("inViewport",new b(c(this),d))}})}})(jQuery);(function(c){function b(e,f){var h=this,k="mobInst",g,d,j={title:false,instruction:false,duration:4000},f=c.extend(j,e.data(),f);this.init=function(){if(f.instruction==false){return}g=c.cookie(k);if(typeof(g)=="string"&&g.indexOf(f.title)>=0){return}h.$instEl=c("<div/>",{html:f.instruction,"class":"mobile-instruction"});var l=e.css("position");if(l=="static"){e.css("position","relative")}e.append(h.$instEl).inViewport({visible:h.show})};this.show=function(){h.$instEl.fadeIn(500);setTimeout(function(){h.$instEl.fadeOut(500)},f.duration);if(f.title){g=c.cookie(k);g=(typeof(g)=="string")?g+"|"+f.title:f.title;c.cookie(k,g,{expires:1,path:"/"})}};this.init()}c.fn.asMobileInstruction=function(d){return this.each(function(){if(!c(this).data("asMobileInstruction")){c(this).data("asMobileInstruction",new b(c(this),d))}})}})(jQuery);artspace.tracking=artspace.tracking||{};$.extend(true,artspace.tracking,{utm_campaign:"",init:function(){var b=$.deparam(window.location.search.substring(1));this.utm_campaign=b.utm_campaign||"";if(b.gclid){this.gclid=b.gclid}},push_conversion_success:function(b){try{b=typeof b!=="undefined"?b:"1";artspace.track("Newsletter Subscribe","Subscribe Success",b)}catch(c){}}});artspace.tracking.init();(function(d,c,f){var e={period:1000,toDate:new Date(),callback:function(){}};function b(h,g){this.element=h;this.options=d.extend({},e,g);this.init()}b.prototype={init:function(){this.$el=d(this.element);this.handlers=["seconds","minutes","hours","days","weeks"];this.interval=this.$el.data("countdownInterval");this.currentDate=new Date();this.toDate=this.sanitizeDate(this.options.toDate);this.secondsLeft=Math.floor((this.toDate.valueOf()-this.currentDate.valueOf())/1000);this.values={};this.triggerEvents();this.start()},sanitizeDate:function(g){if(!(g instanceof Date)){if(String(g).match(/^[0-9]*$/)){return new Date(g)}if(g.match(/([0-9]{1,2})\/([0-9]{1,2})\/([0-9]{2,4})\s([0-9]{1,2})\:([0-9]{2})\:([0-9]{2})/)||g.match(/([0-9]{2,4})\/([0-9]{1,2})\/([0-9]{1,2})\s([0-9]{1,2})\:([0-9]{2})\:([0-9]{2})/)){return new Date(g)}if(g.match(/([0-9]{1,2})\/([0-9]{1,2})\/([0-9]{2,4})/)||g.match(/([0-9]{2,4})\/([0-9]{1,2})\/([0-9]{1,2})/)){return new Date(g)}throw new Error("Doesn't seen to be a valid date object or string")}},triggerEvents:function(){if(this.$el.closest("html").length===0){this.dispatchEvent("removed");this.stop();return}var k,h,j,g=this.handlers.length;if(this.secondsLeft>0){k=this.secondsLeft-=1}this.lasting={seconds:k%60,minutes:Math.floor(k/60)%60,hours:Math.floor(k/60/60)%24,days:Math.floor(k/60/60/24),weeks:Math.floor(k/60/60/24/7)};for(j=0;j<g;j+=1){h=this.handlers[j];if(this.values[h]!==this.lasting[h]){this.values[h]=this.lasting[h];this.dispatchEvent(h)}}if(k===0){this.stop();this.dispatchEvent("finished")}},dispatchEvent:function(g){var h=d.Event(g);h.value=this.values[g]||"0";h.toDate=this.toDate;h.lasting=this.lasting;switch(g){case"seconds":case"minutes":case"hours":h.value=h.value<10?"0"+h.value.toString():h.value.toString();break;default:if(h.value){h.value=h.value.toString()}break}this.options.callback.call(this.$el,h)},start:function(){if(this.interval){this.stop()}this.$el.data("countdownInterval",c.setInterval(d.proxy(this.triggerEvents,this),this.options.period));this.interval=this.$el.data("countdownInterval")},stop:function(){c.clearInterval(this.interval)}};d.fn.countdown=function(g){return this.each(function(){if(!d.data(this,"countdown")){d.data(this,"countdown",new b(this,g))}})}}(jQuery,window));(function(h,g,m){var l=g.event,k;l.special.smartresize={setup:function(){g(this).bind("resize",l.special.smartresize.handler)},teardown:function(){g(this).unbind("resize",l.special.smartresize.handler)},handler:function(f,e){var o=this,n=arguments;f.type="smartresize",k&&clearTimeout(k),k=setTimeout(function(){jQuery.event.handle.apply(o,n)},e==="execAsap"?0:100)}},g.fn.smartresize=function(b){return b?this.bind("smartresize",b):this.trigger("smartresize",["execAsap"])},g.Mason=function(b,d){this.element=g(d),this._create(b),this._init()};var j=["position","height"];g.Mason.settings={isResizable:!0,isAnimated:!1,animationOptions:{queue:!1,duration:500},gutterWidth:0,isRTL:!1,isFitWidth:!1},g.Mason.prototype={_filterFindBricks:function(d){var c=this.options.itemSelector;return c?d.filter(c).add(d.find(c)):d},_getBricks:function(d){var c=this._filterFindBricks(d).css({position:"absolute"}).addClass("masonry-brick");return c},_create:function(r){this.options=g.extend(!0,{},g.Mason.settings,r),this.styleQueue=[],this.reloadItems();var q=this.element[0].style;this.originalStyle={};for(var p=0,o=j.length;p<o;p++){var n=j[p];this.originalStyle[n]=q[n]||null}this.element.css({position:"relative"}),this.horizontalDirection=this.options.isRTL?"right":"left",this.offset={};var f=g(document.createElement("div"));this.element.prepend(f),this.offset.y=Math.round(f.position().top),this.options.isRTL?(f.css({"float":"right",display:"inline-block"}),this.offset.x=Math.round(this.element.outerWidth()-f.position().left)):this.offset.x=Math.round(f.position().left),f.remove();var b=this;setTimeout(function(){b.element.addClass("masonry")},0),this.options.isResizable&&g(h).bind("smartresize.masonry",function(){b.resize()})},_init:function(b){this._getColumns("masonry"),this._reLayout(b)},option:function(b,d){g.isPlainObject(b)&&(this.options=g.extend(!0,this.options,b))},layout:function(C,B){var A,z,y,x,w,v;for(var u=0,t=C.length;u<t;u++){A=g(C[u]),z=Math.ceil(A.outerWidth(!0)/this.columnWidth),z=Math.min(z,this.cols);if(z===1){this._placeBrick(A,this.colYs)}else{y=this.cols+1-z,x=[];for(v=0;v<y;v++){w=this.colYs.slice(v,v+z),x[v]=Math.max.apply(Math,w)}this._placeBrick(A,x)}}var r={};r.height=Math.max.apply(Math,this.colYs)-this.offset.y,this.options.isFitWidth&&(r.width=this.cols*this.columnWidth-this.options.gutterWidth),this.styleQueue.push({$el:this.element,style:r});var q=this.isLaidOut?this.options.isAnimated?"animate":"css":"css",p=this.options.animationOptions,b;for(u=0,t=this.styleQueue.length;u<t;u++){b=this.styleQueue[u],b.$el[q](b.style,p)}this.styleQueue=[],B&&B.call(C),this.isLaidOut=!0},_getColumns:function(){var d=this.options.isFitWidth?this.element.parent():this.element,c=d.width();this.columnWidth=this.options.columnWidth||this.$bricks.outerWidth(!0)||c,this.columnWidth+=this.options.gutterWidth,this.cols=Math.floor((c+this.options.gutterWidth)/this.columnWidth),this.cols=Math.max(this.cols,1)},_placeBrick:function(w,v){var u=Math.min.apply(Math,v),t=0;for(var r=0,q=v.length;r<q;r++){if(v[r]===u){t=r;break}}var p={top:u};p[this.horizontalDirection]=this.columnWidth*t+this.offset.x,this.styleQueue.push({$el:w,style:p});var o=u+w.outerHeight(!0),n=this.cols+1-q;for(r=0;r<n;r++){this.colYs[t+r]=o}},resize:function(){var b=this.cols;this._getColumns("masonry"),this.cols!==b&&this._reLayout()},_reLayout:function(d){var c=this.cols;this.colYs=[];while(c--){this.colYs.push(this.offset.y)}this.layout(this.$bricks,d)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(b){this.reloadItems(),this._init(b)},appended:function(f,e,o){if(e){this._filterFindBricks(f).css({top:this.element.height()});var n=this;setTimeout(function(){n._appended(f,o)},1)}else{this._appended(f,o)}},_appended:function(e,d){var f=this._getBricks(e);this.$bricks=this.$bricks.add(f),this.layout(f,d)},remove:function(b){this.$bricks=this.$bricks.not(b),b.remove()},destroy:function(){this.$bricks.removeClass("masonry-brick").each(function(){this.style.position=null,this.style.top=null,this.style.left=null});var o=this.element[0].style;for(var n=0,f=j.length;n<f;n++){var b=j[n];o[b]=this.originalStyle[b]}this.element.unbind(".masonry").removeClass("masonry").removeData("masonry"),g(h).unbind(".masonry")}},g.fn.imagesLoaded=function(n){var c=this.find("img"),r=c.length,q="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",p=this,o=function(){--r<=0&&this.src!==q&&(n.call(p),c.unbind("load",o))};if(!r){n.call(this);return this}c.bind("load",o).each(function(){if(this.complete||this.complete===m){var b=this.src;this.src=q,this.src=b}});return this},g.fn.masonry=function(b){if(typeof b=="string"){var d=Array.prototype.slice.call(arguments,1);this.each(function(){var c=g.data(this,"masonry");if(!c){return g.error("cannot call methods on masonry prior to initialization; attempted to call method '"+b+"'")}if(!g.isFunction(c[b])||b.charAt(0)==="_"){return g.error("no such method '"+b+"' for masonry instance")}c[b].apply(c,d)})}else{this.each(function(){var e=g.data(this,"masonry");e?(e.option(b||{}),e._init()):g.data(this,"masonry",new g.Mason(b,this))})}return this}})(window,jQuery);WorksGenericModel=Backbone.Model.extend({idAttribute:"work_id",required:{wall:["heights","orig_image_size","image","artist_name","title","units","widths"],zoom:["image","orig_image_size","zoom_path"]},initialize:function(b){var c=this.get("products");if(!(c instanceof Backbone.Collection)){this.set("products",new ProductsCollection(c))}},_valid:function(c){var b=this,d=function(e){return e===undefined||e===null};if(this.required[c]&&!_.some(this.required[c],function(e){return d(b.get(e))})){return true}return false},valid_for_wall:function(){if(this._valid("wall")&&String(this.get("exclude"))!=="true"&&_.some(this.get("heights"),function(b){return parseInt(b)})){return true}return false},valid_for_zoom:function(){return this._valid("zoom")}});WorksGenericCollection=Backbone.Collection.extend({model:WorksGenericModel,valid_for_wall:function(){if(_.some(this.models,function(b){return b.valid_for_wall()})){return true}return false}});ProductModel=Backbone.Model.extend({idAttribute:"product_id"});ProductsCollection=Backbone.Collection.extend({model:ProductModel});artspace.utils=artspace.utils||{};$.extend(true,artspace.utils,{valid_for_wall_model:function(c){var b=["ht","is","l","n","t","u","x"];for(i=0;i<b.length;i++){if(c[b[i]]===undefined||c[b[i]]===null){return false}}if(String(c.x)==="true"||!_.some(c.ht,function(d){return parseInt(d)})){return false}return true},valid_for_wall:function(b){return _.some(b,artspace.utils.valid_for_wall_model)}});(function(d,g,b){var f=Backbone.Model.extend({parse:function(h){return h.cart}}),c=Backbone.View.extend({events:{"click .cart-remove":"remove"},tagName:"li",template:b.templates["cart-item-template"],formatData:function(h){h.artist_name=this.formatText(h.artist);if(h.url){h.product_link=h.url}else{h.product_link="/"+[h.artist,h.work].join("/")}h.thumbnail_url=h.thumbnail_url?h.thumbnail_url:["http://media.artspace.com/media",h.product_link,h.artist+"_"+h.work+"_80x80_c.jpg"].join("/")},formatText:function(h){h=h.replace(/_/g," ");return h.replace(/[^\s]+/g,function(j){return j.substr(0,1).toUpperCase()+j.substr(1).toLowerCase()})},remove:function(){var h=this.model;NProgress.start();artspace.utils.make_request("https://"+window.location.host+"/checkout/cart/remove",{quote_id:b.ddCart.model.get("quote_id"),item_id:h.item_id,use_user_currency:1},true).done(function(j){if(artspace.checkout){artspace.checkout.update_order(j)}if(j.data&&j.data.cart){b.ddCart.model.set(j.data.cart)}NProgress.done()});return false},render:function(){this.formatData(this.model);this.$el.html(this.template({data:this.model}));return this}}),e=Backbone.View.extend({model:new f(),template:b.templates["cart-template"],initialize:function(){_.bindAll(this,"drawItems","toggle","updateItemsCount");this.model.on("sync change",this.drawItems).set(b.cartData);this.model.on("add:items_count change:items_count",this.updateItemsCount);this.hoverShow();if(g("html").hasClass("isMobile")){this.$el.siblings("#cart-link").click(this.toggle)}},drawItems:function(h){if(h){this.render(h);_.each(h.get("items"),function(j){this.$(".cart-list").prepend(new c({model:j}).render().$el)},this)}},hoverShow:function(){var h=this.$el.parents(".dropdown");0<this.model.get("total_qty")&&(h.addClass("dropdown-enabled"))},fetch_show:function(){var h=g(".dropdown-container, .dropdown-cart-backdrop");h.fadeIn("slow");window.setTimeout(function(){if(g(".dropdown-container").is(":hover")){h.attr("style","");return false}h.fadeOut("slow",function(){h.attr("style","")})},10000);if(!g("#cart-link").parent(".dropdown").hasClass("dropdown-enabled")){g("#cart-link").parent(".dropdown").addClass("dropdown-enabled")}},render:function(j){var h;if(j.get("total_qty")>0){h="Your Cart ("+j.get("total_qty")+")"}else{h="Your Cart"}g("#cart-link").html(h);this.$el.html(this.template({link:d.document.getElementById("cart-link").href,total:j.get("total_qty")}));this.$el.siblings(".dropdown-cart-backdrop").click(this.toggle);this.$el.find(".continue-shopping").click(this.toggle)},toggle:function(){console.log("toggle");var h=this.$el.parent(".dropdown"),j=this.$el.add(this.$el.siblings(".dropdown-cart-backdrop"));if(this.$el.is(":visible")){h.removeClass("open-cart");j.removeAttr("style")}else{if(h.hasClass("dropdown-enabled")){h.addClass("open-cart")}}return false},updateItemsCount:function(j,k,h){this.$el.toggleClass("cart-empty",Boolean(k==0))}});if(g("#dropdown-cart").length>0){g(function(){b.ddCart=new e({el:"#dropdown-cart"})})}}(this,jQuery,(artspace||{})));(function(h,g,c){var f=c.headerPromo,e=c.templates["header-promo-template"],d=g("#header-promo");function b(l){var n=l.find("table"),o=l.find(".promo-banner"),k=0,m=o.length,j;if(1<m){setInterval(function(){n.css("left",-1*k%m*100+"%");j=o.eq(k++%m).addClass("active");o.not(j).removeClass("active")},f.rotation_interval)}}if(f.promos.length){d.find(".container").html(e(f));d.removeClass("hide");b(d)}}(window,jQuery,artspace));var artspace=artspace||{};jQuery(function(){if(typeof(artspace.track)=="undefined"){artspace.track=function(h,f,g){if(typeof artspace.track!=="undefined"){artspace.track(h,f,g)}}}var c=jQuery;var e={"":"a","":"e","":"i","":"o","":"u","":"y","":"c","":"th","":"n","":"s"};engine={compile:function(f){var g=_.template(f);return{render:function(h){return g(h)}}}};if(typeof(window.homepage_url)=="undefined"){window.homepage_url=""}var b=window.homepage_url+"/search/autocomplete/artists.json?term=%QUERY";var d=window.homepage_url+"/search/autocomplete/partners.json?term=%QUERY";c(".search-textbox").typeahead([{name:"artists",remote:b,header:'<h3 class="">Artists</h3>',template:"<p><%= html %></p>",engine:engine,charMap:e},{name:"partners",remote:d,header:'<h3 class="">Partners</h3>',template:"<p><%= html %></p>",engine:engine,charMap:e}]);c(".search-textbox").keydown(function(g){if(g.keyCode==13){var f=c(this).parents("form:first");f.submit()}});c(".search-textbox").each(function(){$this=c(this);c(this).bind("typeahead:selected",function(g,h){var f=c(this).parents("form:first");f.submit()})})});var artspace=artspace||{};$(document).ready(function(){$(".gallery-top-buttons-bar-container").removeClass("hide");$("#generate-pdf-link-id").click(function(b){var c=$("#mygallery .box_4").length;if(c>100){$("#alert_dialog").dialog({modal:true,buttons:{Ok:function(){$(this).dialog("close")}}});b.preventDefault()}});$("#gallery-create-form, #gallery-edit-form").validate();$("#gallery-create-form, #gallery-edit-form").submit(function(){if(!$(this).valid()){return false}});$(".gallery-delete-button").click(function(b){b.preventDefault();id=$(this).attr("id");galleryId=id.split("-");artspace.modals.show_confirm("Are you sure you want to delete this gallery?",function(){$("#gallery-delete-value").attr("value",galleryId[1]);$("#gallery-delete-form").submit()});return false});$(".gallery-edit-button").click(function(c){var b=$(this);c.preventDefault();galleryId=b.data("gallery-id");galleryName=b.data("title");galleryDescription=b.data("desc");$('#gallery-edit-form [name="gallery_id"]').attr("value",galleryId);$('#gallery-edit-form [name="name"]').val(galleryName);$('#gallery-edit-form [name="description"]').val(galleryDescription);return false});$(".work-delete-button").click(function(b){b.preventDefault();id=$(this).attr("id");galleryId=id.split("-");artspace.modals.show_confirm("Are you sure you want to delete this work?",function(){$("#work-delete-value").attr("value",galleryId[1]);$("#work-delete-form").submit()});return false});$("#work-edit-form").submit(function(){$("#work-edit-submit").attr("disabled","disabled");$("#gallery-loading").show()});if($("html").hasClass("isMobile")){$(".del-container").addClass("del-mobile");$(".del-container").removeClass("del-container");$(".artwork-buttons").addClass("ab-mobile");$(".artwork-buttons").removeClass("artwork-buttons")}});$(document).ready(function(){var b=false;$("#as-icon-sharelink").bind("click",function(){$("#sh-modal-window").dialog({height:283,width:465,dialogClass:"sh-modal-share-custom-style",resizable:false,draggable:false,modal:false,hide:"fold",show:"blind",position:"center",closeOnEscape:true,open:function(){closedialog=true;if(!b){$("#share-copy-to-clipboard").zclip({path:"/static/common/js/vendors/ZeroClipboard.swf",copy:function(){return $(".share-url").val()}});$(document).mouseup(function(d){var c=$("#sh-modal-window");if(c.has(d.target).length===0&&c.dialog("isOpen")&&!$(d.target).hasClass("ui-icon-closethick")){c.dialog("close")}})}}})});$(".custom-facebook-button").click(function(c){c.preventDefault();artspace.social.openPopup($(this).attr("data-href"),"facebook",550,450);artspace.social.eventTracking("Facebook Share","clicked",window.location.href)});$(".custom-tumblr-button").click(function(c){c.preventDefault();artspace.social.openPopup($(this).attr("data-href"),"tumblr",550,450);artspace.social.eventTracking("Tumblr Share","clicked",window.location.href)});$(".custom-twitter-button").click(function(c){c.preventDefault();var d=$(this);artspace.social.getBitlyUrl(window.location.href,function(e){var f=d.attr("data-href");if(f.indexOf("?")==-1){f+="?url="+encodeURIComponent(e)}else{f+="&url="+encodeURIComponent(e)}artspace.social.openPopup(f,"twitter",550,450);artspace.social.eventTracking("Twitter Share","clicked",window.location.href)})});$(".custom-pinterest-button").click(function(c){c.preventDefault();artspace.social.openPopup($(this).attr("data-href"),"pinterest",550,450);artspace.social.eventTracking("Pinterest Share","clicked",window.location.href)});$(".custom-email-button").click(function(c){c.preventDefault();artspace.social.eventTracking("Email Share","clicked",window.location.href)});$("#message").focus(function(){if($("#message").val()==$("#message").attr("orig_value")){$("#message").val("")}});$("#sender").focus(function(){if($("#sender").val()=="Enter your email"){$("#sender").val("")}});$("#emailShareSubmit").hover(function(){$("#emailShareSubmit").css("background-position","0px -1615px")},function(){$("#emailShareSubmit").css("background-position","0px -1575px")});$("#emailShareSubmit").click(function(){$("#emailShareSubmit").hide();$("#emailShareSpinner").show();artspace.social.emailShareRemoveErrors();$.ajax({type:"POST",url:"https://"+window.location.host+"/art/email_share",data:$("#emailShareForm").serialize(),dataType:"json",xhrFields:{withCredentials:true},async:true,crossDomain:true,success:function(c){$("#emailShareSpinner").hide();$("#emailShareSubmit").show();if(c.success==1){artspace.social.emailShareSuccess(c)}else{artspace.social.emailShareFailure(c)}}});return false})});var artspace=artspace||{};(function(d){var b=Backbone.Model.extend({submit:function(e){this.set(e);this.fetch({type:"POST",data:this.toJSON()})}}),c=Backbone.View.extend({request:null,events:{"submit form":"submit"},initialize:function(){_.bindAll(this,"submit","report","success","error","render");this.$form=this.$("form");this.$input=this.$(".form-input");this.$checkbox=this.$('.checkbox input[type="checkbox"]');this.$thankyou=this.$(".thank-you");this.request=new b();this.request.url=this.$form.attr("action");this.request.on("sync",this.report);this.render();if(_.isFunction(this.init)){this.init()}},submit:function(g,f){try{var h={};g.preventDefault();_.each(this.$form.serializeArray(),function(e){h[e.name]=e.value});if(f){h.email=f}if(!this.$checkbox.length||this.$checkbox.prop("checked")){this.request.submit(h);this.$input.val("working...").removeClass("error").addClass("loading")}else{this.$input.val("").addClass("error").attr("placeholder","* Please accept the terms.").focus()}}catch(g){this.catchErr(g)}},report:function(g){try{if(g.changed.created_at||g.changed.status=="ok"){this.$input.val("").removeClass("error").attr("placeholder","").removeClass("loading");this.success(g)}else{this.$input.val("").addClass("error").attr("placeholder","").removeClass("loading");this.error(g)}d(".email-form").fadeOut("slow",function(){d(".thank-you").fadeIn("fast")});d(".create_pref").children("a").attr("href","/account_creation?email="+g.attributes.email)}catch(f){this.catchErr(f)}},success:function(e){},error:function(e){},catchErr:function(f){this.$input.val("").removeClass("loading").addClass("error").attr("placeholder","Sorry, something went wrong :(").focus()},render:function(){}});artspace.FormView=c}(window.jQuery));$(function(){var b=artspace.FormView.extend({init:function(){this.request.set({json:true})},report:function(g){try{var c=g.get("statusCode");$ty=this.$thankyou,$cta=$ty.find(".cta"),$link=$ty.find("a"),$signin=$("#signin_modal"),$join=$("#join_modal");this.$input.val("");if(g.get("status")=="ok"||c==7){var d=g.get("data");if(c==7){$ty.addClass("subscribed")}if(artspace.user.logged_in){$cta.text(" to save your preferences.");$link.attr("href","/profiles/preferences")}else{if(d.is_customer){$cta.text(" to sign in and save your preferences.");$link.attr("href","#signin").click(artspace.modals.show);$signin.find('input[name="email"]').val(g.get("email"));artspace.modals.set_modal_target("/profiles/preferences")}else{$cta.text(" to create an account and save your preferences.");if($ty.hasClass("test-join")){$link.attr("href","#join").click(artspace.modals.show)}else{$link.attr("href","/account_creation?email="+encodeURIComponent(g.get("email")));artspace.modals.set_modal_target("/profiles/preferences")}$join.find('input[name="email"]').val(g.get("email"));dataLayer.push({event:"Newsletter Sign Up"})}}this.$form.fadeOut(function(){$ty.fadeIn()});if(typeof artspace.track!=="undefined"){artspace.track("Member Sign Up","Success")}}else{this.$input.addClass("error").removeClass("loading").attr("placeholder",g.get("message"))}artspace.modals.append_tracking_cookie(d.subscriber_id)}catch(f){this.$input.val("").removeClass("loading").addClass("error").attr("placeholder","Sorry, something went wrong :(").focus()}}});$(".newsletter-form").each(function(){new b({el:this})})});(function(f,d,b,e){var c=b.FormView.extend({events:{"submit form":"submit","click #wd-close":"toggleDialog","click #wd-phone-close":"toggleDialog"},init:function(){_.bindAll(this,"_alert","setLeft","expand","clearDialog","toggleDialog");d(f).on("resize",_.debounce(this.setLeft,100));this.clickCount=this.setClickCount();this.listen();this.setLeft()},_alert:function(g,h){this.$input.val("").addClass(g).attr("placeholder",h);return this.$input},setLeft:function(){var g=this.$el,h=d(".visible-phone").is(":visible")?0:20;g.css("margin-left",-(g.width()+h)/2+"px")},autoShow:function(){var h=this.urlParams.utm_medium=="email",g=/inspace/.test(f.location.href),j=this.clickCount;if(h||g||this.getSubscribeStatus()){return this.setSubscribeStatus(1)}if(this.urlParams.gclid){return this.expand("auto-show - paid-click")}if((1===j||0===j%6)&&!e.querySelector("body#checkout")){this.expand("auto-show - click-count: "+j)}},listen:function(){this.urlParams=d.deparam(f.location.search.substring(1));this.urlParams.utm_campaign=this.urlParams.utm_campaign||(this.urlParams.gclid?"rolldown-aboutus-paid-search":"rolldown-aboutus-organic");d("html").on("click",this.clearDialog);d("#about-us-toggle").on("click",this.toggleDialog);if(this.getSubscribeStatus()){this.$("#wd-signup").hide();this.setSubscribeStatus(1)}},expand:function(g){var h=this.$el;h.addClass("show");f.setTimeout(function(){h.addClass("expanded")},50);g&&this.track(g)},contract:function(g){var h=this.$el;h.removeClass("expanded");f.setTimeout(function(){h.removeClass("show")},500);g&&this.track(g)},clearDialog:function(j){var h=this.$el,g=d(j.target);h.is(":visible")&&!h.find(g).length&&!g.parents("#about-us-toggle").length&&this.contract("toggle-close")},toggleDialog:function(g){g.preventDefault;this.$el.is(":visible")?this.contract("toggle-close"):this.expand("toggle-open")},submit:function(l){try{var m={},h=this._alert,k=this.request,g=this.$form,n=this.$checkbox;l.preventDefault();_.each(g.serializeArray(),function(o){m[o.name]=o.value});m.utm_campaign=this.urlParams.utm_campaign||m.utm_campaign;if(!this.validate(m.email)){return h("error","* Please enter a valid email").focus()}if(n.length&&!n.prop("checked")){return h("error","* Please accept the terms.").focus()}k.url=g.attr("action");k.submit(m);h("loading","working...").removeClass("error")}catch(j){this.catchErr(j)}},success:function(k){var j=this,g=k.changed,h=k.get("data");this.setSubscribeStatus(1);this.pushSuccessState();if(typeof artspace.track!=="undefined"){artspace.track("Member Sign Up","Success")}this.track("email_signup - click-count: "+this.clickCount);this.$("#wd-signup").is(":visible")&&j.$("#wd-signup-form").fadeOut(200,function(){j.setSubscribeLink(k);j.$("#wd-success").fadeIn(200)});artspace.modals.append_tracking_cookie(h.subscriber_id);dataLayer.push({event:"Newsletter Sign Up"})},error:function(k){var h=this,g=k.changed,j=g.statusCode;if(6===j||7===j){this.setSubscribeStatus(1);this.$("#wd-signup").is(":visible")&&this.$("#wd-signup-form").fadeOut(200,function(){h.setSubscribeLink(k);h.$("#wd-success").addClass("subscribed").fadeIn(200)});return}this.$input.attr("placeholder",g.message).focus()},setSubscribeLink:function(l){var h=this.$thankyou.find("a"),g=d("#signin_modal"),j=d("#join_modal"),k=l.get("data");if(artspace.user.logged_in){h.attr("href","/profiles/preferences")}else{if(k.is_customer){h.attr("href","#signin").click(artspace.modals.show);g.find('input[name="email"]').val(l.get("email"));artspace.modals.set_modal_target("/profiles/preferences")}else{if(this.$thankyou.hasClass("test-join")){h.attr("href","#join").click(artspace.modals.show)}else{h.attr("href","/account_creation?email="+encodeURIComponent(l.get("email")));artspace.modals.set_modal_target("/profiles/preferences")}j.find('input[name="email"]').val(l.get("email"))}}},pushSuccessState:function(){try{var j=f.history,g=f.location.search;_.isFunction(j.pushState)&&j.pushState({success:"success"},null,g)}catch(h){}},track:function(g){b.track("rolldown-aboutus",g,this.urlParams.utm_campaign)},setSubscribeStatus:function(g){d.cookie("email_subscribe_status",g,{path:"/",expires:3650,domain:"artspace.com"})},getSubscribeStatus:function(){return !!(b.user&&(b.user.logged_in||b.user.get("email")||d.cookie("email_subscribe_status")))},setClickCount:function(){var g=f.parseFloat(d.cookie("rolldown_aboutus"))||0;0<=g&&(g+=1);d.cookie("rolldown_aboutus",g,{path:"/",expires:3650,domain:"artspace.com"});return g},validate:function(g){var h=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[?[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\]?)|[^\-](([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return h.test(g)}});d(function(){b.welcomeDialog=new c({el:"#welcome-dialog"})})}(window,jQuery,artspace,document));var CountryModel=Backbone.Model.extend({idAttribute:"country_id"});var CountryCollection=Backbone.Collection.extend({model:CountryModel});var AddressModel=Backbone.Model.extend({defaults:{firstname:"",lastname:"",street:"",city:"",region:"",postcode:"",country:""},idAttribute:"customer_address_id",initialize:function(){_.bindAll(this,"concat_street","set_country_name");this.listenTo(this,"add:street1 add:street2",this.concat_street).trigger("add:street1");this.listenTo(this,"change:street1 change:street2",this.concat_street)},concat_street:function(){if(this.get("street1")){this.set("street",$.trim(this.get("street1"))+" \n"+this.get("street2"))}else{if(this.get("street")){var b=this.get("street").split("\n");this.set({street1:$.trim(b[0]),street2:b[1]})}}return this},set_country_name:function(){var c=artspace.countries.get(this.get("country_id")),b="";if(c){b=c.get("name")}this.set("country",b);return this}});var AddressCollection=Backbone.Collection.extend({model:AddressModel});var GenericAddressFormView=Backbone.View.extend({initialize:function(){_.bindAll(this,"init_validation","city_blur","postcode_blur","save_original","postcode_prefill","region_change","update_regions","update_regions_render");this.init_validation();this.$('select[name="country_id"]').on("change",this.update_regions);this.$('input[name="postcode"]').on("focus",this.save_original);this.$('input[name="postcode"]').on("blur",this.postcode_blur);this.$('select[name="region_id"]').on("change",this.region_change);this.$('input[name="city"]').on("blur",this.city_blur)},init_validation:function(){$.validator.setDefaults({ignore:[],});$.validator.addMethod("validate_zip",this.validate_zip,"Invalid Zip/Postal Code.");$.validator.addMethod("validate_zip_state",this.validate_zip_state,"ZIP code does not match state.");$.validator.addMethod("validate_phone",this.validate_phone,"Please enter a valid phone number.");var b=this;this.validator=this.$el.validate({rules:{postcode:{required:function(c){return b.$('select[name="country_id"] option:selected').data("zip-required")==1},validate_zip:{depends:function(c){return b.$('select[name="country_id"]').val()=="US"}}},region_id:{required:{depends:function(c){return b.$('select[name="country_id"]').val()=="US"}},validate_zip_state:{depends:function(c){return b.$('select[name="country_id"]').val()=="US"}}},telephone:{validate_phone:true}}})},error:function(b){},city_blur:function(d){var c=$(d.currentTarget).data("prefill"),b=$(d.currentTarget).val();if(c!=b){artspace.track("Address change prefilled city","zip:"+this.$('input[name="postcode"]').val()+", prefilled_city:"+c+", new_city:"+b,1)}},get_postcode_info:function(c,b){artspace.utils.make_request("/common/postcode_info",{country:c,postcode:b}).done(this.postcode_prefill)},postcode_blur:function(b){var c=this.$('select[name="country_id"]').val();if($(b.currentTarget).data("original-value")!=b.currentTarget.value&&c=="US"){this.get_postcode_info(this.$('select[name="country_id"]').val(),b.currentTarget.value)}},postcode_prefill:function(b){if(b.status&&b.status=="ok"&&b.data){var c=b.data;if(c.city){this.$('input[name="city"]').val(c.city.name).data("prefill",c.city.name)}if(c.region){this.$('input[name="region"]').val(c.region.name);this.$('select[name="region_id"]').val(c.region.magento_id).selectpicker("refresh")}}},region_change:function(b){$(b.currentTarget).trigger("blur")},save_original:function(b){$(b.currentTarget).data("original-value",b.currentTarget.value)},update_regions:function(){var b=this.$('select[name="country_id"]').val();if(b){artspace.utils.make_request("/common/get_regions",{country:this.$('select[name="country_id"]').val()},true).done(this.update_regions_render).fail(this.error)}},update_regions_render:function(b){var e=b.data["regions"]||false,d=this.$('select[name="region_id"]');d.children().remove();if(e&&e.length>0){this.$(".state-holder").show();this.$(".province-holder").hide();d.append('<option value="">Choose a State</option>');for(var c=0;c<e.length;c++){d.append($("<option/>",{value:e[c].magento_id,text:e[c].name,"data-postcode-prefix":e[c].postcode_prefix}))}d.selectpicker("refresh")}else{this.$(".state-holder").hide();this.$(".province-holder").show()}},validate_phone:function(d,b){var c=d.replace(/[^0-9]/g,"");if(d.length>=7){return true}return false},validate_zip:function(d,c){var b=d.replace(/[^0-9]/g,"");if(b.length==5||b.length==9){return true}return false},validate_zip_state:function(e,c){var d=$(c).find(":selected").data("postcode-prefix"),b=$(c).parents("form").find('input[name="postcode"]').val();if(typeof d=="number"&&b[0]!=d){return false}return true}});artspace.modals=artspace.modals||{};artspace.modals.deferred={};artspace.modals.new_target="";$.extend(true,artspace.modals,{init:function(){$(".show-modal").click(this.show);$(".show-my-gallery").click(this.show_my_gallery_save_click);$(".show-inquire").click(this.show_inquire_click);$(".modal-target").bind("click",function(){artspace.modals.set_modal_target(this.getAttribute("data-target-value"))});var c=$.deparam(window.location.search.substring(1));var b=false;this.ad_modals(c);if(artspace.user.logged_in){if(c.mg){artspace.modals.show_my_gallery_save(c.mg);delete c.mg;b=true}else{if(c.ty){if(window.location.pathname.indexOf("/checkout")>=0){artspace.modals.show_thankyou(c.ty,c.fid)}}}}dc=$.cookie("dc");if(c.dc&&!dc){artspace.modals.show("#email_sub");delete c.dc;if(window.history&&window.history.replaceState){window.history.replaceState({},document.title,window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+$.param(c))}$.cookie("dc","true",{path:"/",expires:36500,domain:"artspace.com"})}if(c.dcas&&!dc){artspace.modals.show("#email_already_sub");delete c.dcas;if(window.history&&window.history.replaceState){window.history.replaceState({},document.title,window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+$.param(c))}$.cookie("dc","true",{path:"/",expires:36500,domain:"artspace.com"})}this.init_signin_join();this.init_forgot_pass();this.init_save_my_gallery();this.init_inquire();this.init_email_share();this.init_prereg();if($("#alist").length){artspace.modals.show("#signin",true)}},ad_modals:function(b){su=$.cookie("su");if("email" in b){console.log(b.email);email_field=$("#email-subscribe-input");email_field.val(b.email);console.log(email_field)}if("su" in b&&!su){this.show("#preference_join",true);if(window.history&&window.history.replaceState){window.history.replaceState({},document.title,window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+$.param(b))}}},email_success_cookie:function(){$.cookie("su","true",{path:"/",expires:36500,domain:"artspace.com"})},init_signin_join:function(){var c=$("form.signin, form.join");var b=true;c.validate();if($("#alist").length){artspace.track("alist-modal","pop",window.location.href)}c.each(function(){if($("#alist").length){var d=$(this);d.find(".col-sm-12 h2.h1sub").html("Welcome to the");d.find(".col-sm-12 p").html("Sign in to access your exclusive benefits.");d.find(".col-sm-12 h2.h1sub").after('<div class="alist-logo-holder"><span class="icon-a-list-a"></span><span class="icon-a-list-list"></span></div>')}$(this).keydown(function(f){if(f.keyCode==13){$(this).submit();return false}});$(this).submit(function(){var f={},g=$(this);g.find(".error-holder").text("");if(!g.valid()){return false}b=true;g.find(".submit-holder").addClass("loading");g.find("input").each(function(){var j=$(this);f[j.attr("name")]=j.val()});if($(this).hasClass("preference_modal")){artspace.profiles.signup_email=f.email}else{if($(this).hasClass("collector-type")){f.email=artspace.profiles.signup_email;var e=$("#collector_category_modal").find('input[type="checkbox"]:checked, input[type="radio"]:checked').attr("value");f.collector_type=e}}if(window.XDomainRequest&&!jQuery.support.cors){var h="jsonp"}else{var h="json"}artspace.modals.deferred=$.ajax({type:"POST",url:g.attr("action"),data:f,dataType:h,xhrFields:{withCredentials:true},async:true,crossDomain:true,success:function(j){if(j.status=="ok"){var k=g.parents(".modal").attr("id")||g.attr("class");artspace.modals.new_target=g.find('input[name="target_value"]').val()||window.location.href.split("#")[0];artspace.modals.email_success_cookie();if(j.data&&j.data.redirect){artspace.modals.new_target=j.data.redirect}if(k.indexOf("join")>=0){if(typeof artspace.track!=="undefined"){artspace.track("Member Sign Up","Success")}dataLayer.push({event:"Newsletter Sign Up"})}if(k.indexOf("join")==0){dataLayer.push({event:"Member Sign Up"})}if(k.indexOf("preference_join_modal")>=0||k.indexOf("net_join_modal")>=0){artspace.modals.show("#collector_category");artspace.track("Preference Modal","View Step One","Collector Category");b=false}else{if(k.indexOf("collector_category_modal")>=0){artspace.modals.show("#art_follow");artspace.user.logged_in=true;artspace.track("Preference Modal","View Step Two","Art Follow");b=false}}artspace.track(k.indexOf("join")>=0?"join":"signin",k,f.utm_campaign)}else{if(window.location.search=="?signin=1"){$("html, body").animate({scrollTop:"0px"})}if(g.hasClass("signin")&&j.data&&!j.data.is_customer&&j.data.is_subscriber){if(window.location.search!="?signin=1"){artspace.modals.show_error_join(g.parents(".modal"),g.find('input[name="email"]').val(),"You're on our email list, but don't have an account! Make a password to join now");g.find(".submit-holder").removeClass("loading")}else{$(".inpage-signin").find(".error-holder").text("You're on our email list, but don't have an account! Make a password to join now");$(".new-user").trigger("click");$(".submit-holder").removeClass("loading")}artspace.track("signin","error","You're on our email list, but don't have an account! Make a password to join now")}else{g.find(".submit-holder").removeClass("loading");g.find(".error-holder").text(j.message);if(j.message=="Already Registered. Please Sign in"&&window.location.search=="?signin=1"){$(".existing-user").trigger("click")}artspace.track("signin","error",j.message)}b=false}}});$.when(artspace.modals.deferred).then(function(){artspace.modals.append_tracking_cookie(artspace.modals.deferred.responseJSON.data.subscriber_id,b)});return false})})},init_prereg:function(){var c=$("form.prereg"),d=true,e="json",b=new GenericAddressFormView({el:c.selector});c.find('select[name="country_id"]').trigger("change");if(artspace.user.logged_in){c.find("#signup-info").addClass("hidden")}c.validate();c.keydown(function(f){if(f.keyCode==13){$(this).submit();return false}});c.submit(function(){var f={};c.find(".error-holder").text("");if(!c.valid()){return false}d=true;c.find(".submit-holder").addClass("loading");c.find(".bootstrap-select").each(function(){var g=$(this).find(".selected").attr("rel");$(this).closest(".sp-wrap").find("select option").eq(g).attr("selected","selected")});c.find(".form-input").each(function(){var g=$(this);f[g.attr("name")]=g.val()});artspace.profiles.signup_email=f.email;if(window.XDomainRequest&&!jQuery.support.cors){e="jsonp"}artspace.modals.deferred=$.ajax({type:"POST",url:c.attr("action"),data:f,dataType:e,xhrFields:{withCredentials:true},async:true,crossDomain:true,success:function(g){if(g.status=="ok"){var h=c.parents(".modal").attr("id")||c.attr("class");artspace.user.logged_in=true;artspace.modals.new_target=c.find('input[name="target_value"]').val()||window.location.href.split("#")[0];artspace.track("Member Preregistration","Success");dataLayer.push({event:"Member Preregistration"});artspace.track("prereg",h,f.utm_campaign);c.find(".submit-holder").removeClass("loading")}else{$("#prereg_modal").animate({scrollTop:"0px"});c.find(".submit-holder").removeClass("loading");c.find(".error-holder").text(g.message);artspace.track("prereg","error",g.message);d=false}}});$.when(artspace.modals.deferred).then(function(){if(artspace.modals.deferred.responseJSON.data){artspace.modals.append_tracking_cookie(artspace.modals.deferred.responseJSON.data.subscriber_id,d)}});return false});$("#prereg-signin").click(function(){var g=$(this),f={};c.find("#signup-info .form-input").each(function(){var h=$(this);f[h.attr("name")]=h.val()});artspace.profiles.signup_email=f.email;if(window.XDomainRequest&&!jQuery.support.cors){e="jsonp"}c.find(".prereg-signin-holder").addClass("loading");$.ajax({type:"POST",url:g.data("action"),data:f,dataType:e,xhrFields:{withCredentials:true},async:true,crossDomain:true,success:function(h){if(h.status=="ok"){var j=c.parents(".modal").attr("id")||c.attr("class");c.find("#signup-info").addClass("hidden");artspace.user.logged_in=true;artspace.modals.new_target=c.find('input[name="v"]').val()||window.location.href.split("#")[0];artspace.track("Member Preregistration Sign In","Success");dataLayer.push({event:"Member Preregistration Sign In"});artspace.track("prereg",j,f.utm_campaign);c.find(".prereg-signin-holder").removeClass("loading");c.find("#prereg_customer_id").val(h.data.customer.customer_id)}else{$("#prereg_modal").animate({scrollTop:"0px"});c.find(".prereg-signin-holder").removeClass("loading");c.find(".error-holder").text(h.message);artspace.track("prereg","error",h.message);d=false}}})})},append_tracking_cookie:function(c,b){artspace_id=parseInt($.cookie("artspace-uid"));id_value=artspace_id+"/"+c;$.cookie("artspace-uid",id_value,{path:"/",expires:36500,domain:"artspace.com"});if(b===true){artspace.modals.reload_window()}},reload_window:function(){if(!artspace.modals.new_target||artspace.modals.new_target[0]=="#"){window.location.reload()}else{window.location.assign(artspace.modals.new_target)}},init_forgot_pass:function(){$("form.forgot_pass").each(function(){var b=$(this);b.validate();b.submit(function(){var c={},d="json";b.find(".error-holder").text("");if(!b.valid()){return false}b.find(".submit-holder").addClass("loading");if(window.XDomainRequest&&!jQuery.support.cors){d="jsonp"}b.find("input").each(function(){var e=$(this);c[e.attr("name")]=e.val()});$.ajax({type:"POST",url:b.attr("action"),data:c,dataType:d,xhrFields:{withCredentials:true},async:true,crossDomain:true,success:function(e){b.find(".submit-holder").removeClass("loading");if(e.status&&e.status=="ok"){b.find(".form-holder").hide();b.find('button[type="submit"]').hide();b.find(".success").show()}else{var f="Something went wrong, please contact Customer Service.";if(e.message){f=e.message}b.find(".error-holder").html(f)}}});return false})})},init_preferences_join:function(){var b="/search/autocomplete/artists.json?term=%QUERY";var d="/search/autocomplete/partners.json?term=%QUERY";var c={compile:function(e){var f=_.template(e);return{render:function(g){return f(g)}}}};$("#artist_input").typeahead([{name:"artist",remote:b,template:"<p><%= html %></p>",engine:c}]);$("#partner_input").typeahead([{name:"partner",remote:d,template:"<p><%= html %></p>",engine:c}]);$("#artist_input, #partner_input").on("typeahead:selected",function(f,h,j){var g,e;e="#"+j+"_follow_modal";g='<div class="col-sm-4 '+j+'-follow-span">';g+='<div><input data-obj-id="'+h.id+'" data-obj-type="'+j;g+='" data-source="pref_modal" type="checkbox" style="display: none;">';g+="<label>"+h.value+"</label></div></div>";artspace.follows.follow(h.id,j,0,"pref_modal");$("."+j+"-follow-rows").children(".row:first-child").prepend(g);$(e).find('input[type="checkbox"]:first').customCheckbox();$(e).find('input[type="checkbox"]:first').trigger("click");artspace.modals.clear_typeahead(j);artspace.modals.bind_follow(j);$("#"+j+"_input").blur()});$("#artist_input").bind("click",artspace.modals.clear_typeahead("artist"));$("#partner_input").bind("click",artspace.modals.clear_typeahead("partner"))},clear_typeahead:function(c){var b="#"+c+"_input";$(b).val("");$(".tt-dropdown-menu").hide();$(b).typeahead("setQuery","")},bind_follow:function(c){var b="#"+c+"_follow_modal";$(b).find('input[type="checkbox"], input[type="radio"]').bind("click",function(){var e=$(this).attr("data-obj-id");var f=$(this).attr("data-obj-type");if($(this).prop("checked")){var d=""}else{var d="1"}artspace.follows.follow(e,f,d,"pref_modal")})},init_save_my_gallery:function(){var b=$("#mygallery_save_modal"),c=$(".modal-body");b.find("form").submit(function(){var e=$(this),d=e.find(".error");if(e.find('input[type="checkbox"]:not([disabled]):checked').length==0&&e.find('input[name="new-gallery"]').val()==""){d.text("Select or add a new gallery");return false}else{d.text("")}$.ajax({url:"http://"+window.location.host+e.attr("action"),data:e.serialize(),type:"POST",success:function(f){if(f.status=="ok"){e.hide();c.find(".confirmation").show();var g=$("body").attr("id");artspace.track("add","mygallery",g.indexOf("work")>=0?"work page":"not work page")}else{d.text("An error has occurred, please try again")}}});return false})},init_inquire:function(){var b=$("#inquire_modal form");b.find("a.inquire-sub").click(function(){if(!$(this).hasClass("btn-disabled")){b.submit()}return false});b.find('input[name="sb-filter"]').addClass("sb-filter");$.validator.addMethod("require-one",function(){return b.find(".require-one:checked").size()>0},"Please check at least one box.");b.validate({rules:{email:{required:true,email:true},phone:{required:{depends:function(d){var c=$(d).parents("form");if(c.find('[name="contact_me"][value="call"]').is(":checked")){return true}else{return false}}}},body:{maxlength:1000},},groups:{checks:"contact_me"}});b.find(".require-one").click(function(){$(".radio.error-holder").text("").addClass("hidden")});b.submit(function(){var e=$(this),d=artspace.utils.form_data(e);if(!e.valid()||!e.is(":visible")||e.find('input[name="sb-filter"]').val()!=""){return false}e.find("a.inquire-sub").addClass("btn-disabled");var c=e.serialize();c+="&source="+artspace.social.source+"&page_source="+$("title").text();$.ajax({type:"POST",url:"/art/inquire/",data:c,success:function(f){var h=e.parents(".form-holder"),g=h.siblings(".confirm-message");if(!f.status){g.find(".confirm-heading").html("An error occurred");g.find(".confirm-copy").html('There was an error sending your message. Please contact Customer Service at <a href="mailto:service@artspace.com">service@artspace.com</a>')}h.hide();g.show();artspace.modals.inquire_callback(f,d)}});return false})},init_email_share:function(){var c=$("#email_share_modal");if(c.length>0){var b=c.find("form");b.validate();b.submit(function(){if(!b.valid()){return false}var d=artspace.utils.form_data(b);artspace.utils.make_request("https://"+window.location.host+"/art/email_share",d).done(function(e){console.log(e);if(!e.success){if(e.errors&&e.errors.recipient){b.find(".error-holder").html(e.errors.recipient)}else{b.find(".error-holder").html("Something went wrong, please try again or contact customer service")}}else{b.hide();b.siblings(".confirmation").show()}});return false})}},show:function(c,b,d){if(typeof c!=="string"){c=$(this).attr("href")}b=false||b;artspace.modals.set_utm_campaign(c);$visible=$(".modal").is(":visible");if($visible){$(".modal").each(function(){var e=$(this);if(e.is(":visible")){e.modal("hide")}})}if(b){$("#join-signin-link").addClass("hide")}$(c+"_modal").find(".close").toggle(!b);$(c+"_modal").modal({backdrop:b?"static":true,show:true});return false},show_alert:function(b,e,d){var c=$("#confirm_modal");c.addClass("alert");artspace.modals.show_confirm(b,e,function(){c.removeClass("alert");if(typeof d=="function"){d()}})},show_confirm:function(b,e,d){var c=$("#confirm_modal");if(d){c.one("hidden.bs.modal",d)}c.find("h2.prompt").text(b);c.find(".confirm-button").off("click").click(function(){if(d){c.off("hidden.bs.modal",d)}e();c.modal("hide")});c.modal("show")},show_follow:function(d,b){var f=$(".modal").modal("hide").filter('[id*="follow"]'),e=$("#follow_join_modal").find('input[name="target_value"]'),c=e.val();f.find("h2.h1sub").text("Interested in "+b.data("obj-name")+"?");f.find(".follow_modal_follows").val(JSON.stringify([{obj_id:b.data("obj-id"),obj_type:b.data("obj-type"),obj_source:b.data("source")}]));c=c||"//"+window.location.host+window.location.pathname;params=$.deparam(window.location.search.substring(1));params.ty="follow_thankyou";params.fid=b.data("obj-id");params.sj=1;c+="?"+$.param(params);e.val(c);artspace.modals.show(d);return false},inquire_data:{buy:{heading:"Have a question? Ask an Advisor",copy:"For first-time buyers and avid collectors alike, a personal Artspace Art Advisor can assist you in learning about, discovering and falling in love with an artwork.",type:"expert"},expert:{heading:"Have a question? Ask an Advisor",copy:"For first-time buyers and avid collectors alike, a personal Artspace Art Advisor can assist you in learning about, discovering and falling in love with an artwork.",confirm:{heading:"Your message has been sent",copy:"Collector Services will contact you within two business days."},type:"expert"},inquire:{heading:"We are pleased to assist you in purchasing this work and to answer any inquiries.",copy:"",type:"buy"},restock:{heading:"Add to Wait List",copy:"We are sorry this work is currently unavailable online, but Artspace Art Advisors are available to assist you.",confirm:{heading:"Your Message Has Been Sent",copy:"Collector Services will contact you should the item become available. This item will be removed from your cart."},type:"restock"},service:{heading:"How can we assist you?",copy:"We are here to make sure you have a great experience browsing and buying artwork. Please send us your questions or feedback, and our Customer Service team will contact you shortly.",type:"service"},suggestions:{heading:"Suggestions &amp; Feedback",copy:"Tell us about artworks, artists, or site features that you would love to see on Artspace. We appreciate your feedback!",confirm:{heading:"Your message has been sent",copy:"Thank you for your feedback!"},type:"suggestions"}},show_inquire_click:function(){var $link=$(this),$modal=$("#inquire_modal"),$confirm_message=$modal.find(".confirm-message"),work=artspace.work_page&&artspace.work_page.work?artspace.work_page.work:false,work_id=$link.data("work-id")||((work&&work.get("work_id"))||""),work_title=$link.data("work-title")||((work&&work.get("title"))||""),work_artist=$link.data("work-artist")||((work&&work.get("artist_name"))||""),work_img=$link.data("work-img")||((work&&work.get("image"))||STATIC_URL+"common/img/modals/ask-an-expert-no-image.png"),modal_type=$link.data("modal-type")||"expert",callback=$link.data("callback")||false;artspace.social.source=$link.data("source");if(callback){artspace.modals.inquire_callback=eval(callback)}else{artspace.modals.inquire_callback=function(){}}$modal.find(".work-title").text(work_title);$modal.find(".work-artist").text(work_artist);$modal.find(".work-img").attr("src",work_img);$modal.find('input[name="work"]').val(work_id);$modal.find('textarea[name="body"]').val("");var inquire_data=artspace.modals.inquire_data[modal_type];if(inquire_data){$modal.find(".modal-heading").html(inquire_data.heading).toggle(inquire_data.heading!="");$modal.find(".modal-copy").html(inquire_data.copy).toggle(inquire_data.copy!="");$modal.find('input[name="inquiry_type"]').val(inquire_data.type);if(!inquire_data.confirm){inquire_data.confirm=artspace.modals.inquire_data.expert.confirm}$confirm_message.find(".confirm-heading").html(inquire_data.confirm.heading);$confirm_message.find(".confirm-copy").html(inquire_data.confirm.copy)}$modal.find("a.inquire-sub").removeClass("btn-disabled");$modal.find(".form-holder").show();$confirm_message.hide();artspace.modals.show("#inquire");return false},inquire_callback:function(){},show_my_gallery_save_click:function(){if(!artspace.user.logged_in){var b=$(this);artspace.modals.set_mygallery_data(b.data("work-id"),b.data("work-title"),b.data("work-img"),b.data("artist"));artspace.modals.show("#mygallery_signin");return false}artspace.modals.show_my_gallery_save($(this).data("work-id"));return false},show_my_gallery_save:function(b){var c=$("#mygallery_save_modal"),f=$(".modal-body"),e=c.data("user-hash"),d=_.template('<li><input type="checkbox" id="gallery-<%= d %>" name="gallery" value="<%= d %>"><label for="gallery-<%= d %>" class=""><%= n %></label></li>');f.addClass("loading");f.find('input[type="text"], textarea').val("");f.find(".confirmation").hide();c.find("form").show();c.find(".error").html("");$.ajax({url:"/galleries/add_work_form/"+e,type:"GET",data:{work:b},success:function(g){var h=f.find(".gallery-list ul"),k=null;artspace.modals.set_mygallery_data(g.work.d,g.work.t,g.work.i,g.work.a);h.html("");for(var j=0;j<g.galleries.length;j++){k=$(d(g.galleries[j]));if(g.galleries[j].i){k.find('input[type="checkbox"]').prop("checked",true).prop("disabled",true)}h.append(k)}f.find(".work-id").val(b);f.removeClass("loading")}});c.find("#addconf-share-facebook").click(function(g){artspace.social.openPopup($(this).attr("data-href"),"facebook",550,450);return false});c.find("#addconf-share-pinterest").click(function(g){artspace.social.openPopup($(this).attr("data-href"),"pinterest",550,450);return false});artspace.modals.show("#mygallery_save")},show_thankyou:function(d,c){if(!artspace.user.logged_in){return}if(c){var b=$('.follow-obj.following[data-obj-id="'+c+'"]'),e=b.data("obj-name");if(b&&e){$("#"+d+"_modal").find("h2.h1sub").text("Thank you for following "+e);artspace.modals.show("#"+d)}}else{artspace.modals.show("#"+d)}},set_mygallery_data:function(c,j,b,h){var f=$('.modal[id*="mygallery"]'),d=f.find(".artist-name"),g=f.find(".work-title"),e=f.find("img.work-image");d.text(h);g.text(j);e.attr("src",b);target_value="//"+window.location.host+window.location.pathname;params=$.deparam(window.location.search.substring(1));params.mg=c;target_value+="?"+$.param(params);artspace.modals.set_modal_target(target_value,"mygallery")},set_modal_target:function(c,b){if(typeof b!=="undefined"){$('[id*="'+b+'"].modal').find('input[name="target_value"]').val(c)}else{$("#signin_modal, #join_modal").find('input[name="target_value"]').val(c)}},set_utm_campaign:function(c){var b=c.replace("#",""),d=artspace.tracking.utm_campaign||(artspace.tracking.gclid?b+"-paid-search":b+"-organic");$(c+"_modal").find(".utm_campaign").val(d)},show_error_join:function(d,c,b){var f="#"+d.attr("id").replace("signin","join"),e=$(f);e.find(".error-holder").text("You're on our email list, but don't have an account! Make a password to join now");e.find('input[name="email"]').val(c);artspace.modals.show(f.replace("_modal",""))}});artspace.follows=artspace.follows||{};$.extend(true,artspace.follows,{init_follows:function(b){b.click(function(){var c=$(this);if(!artspace.user.logged_in){artspace.modals.show_follow("#follow_signin",c);return}artspace.follows.follow(c.data("obj-id"),c.data("obj-type"),c.data("following"),c.data("source"),null,c)});if($("html").hasClass("notMobile")){b.hover(artspace.follows.follow_hover,artspace.follows.follow_hover)}},follow_hover:function(f){var d=$(this).find(".following-text, .not-following-text").filter(":visible"),c=d.data("hover-default"),b=d.data("hover-toggle");if(b){if(f.type=="mouseenter"){d.css("min-width",d.width()).text(b)}else{d.css("min-width",0).text(c)}}},follow:function(c,f,e,j,d,h){var g=artspace.tracking.utm_campaign||"";d=d||function(){};if(typeof(h)!=="undefined"){artspace.follows.toggle_follow_state(c,f,!e);var b=function(l,k){result=$.parseJSON(l.responseText);if(k!=="success"||!result||!result.status){artspace.follows.toggle_follow_state(c,f,!e)}};d=[d,b]}$.ajax({data:{follow_id:c,follow_type:f,unfollow:e,source:j,utm:g},type:"POST",url:"/profiles/follow",complete:d})},toggle_follow_state:function(b,d,e){var c=$('.follow-obj[data-obj-id="'+b+'"][data-obj-type="'+d+'"]');if(e){c.addClass("following").data("following",1)}else{c.removeClass("following").data("following",0)}}});!function(f,m,l){var c,j=f.dataLayer=f.dataLayer||[],k=m.head,e=k.firstElementChild,o=("https:"===location.protocol),n=function(p,q,b){if(!m.getElementById(q)){c=m.createElement(l);q&&(c.id=q);c.src=p;c.type="text/javascript";c.async=true;b?k.insertBefore(c,e):k.appendChild(c)}},d=function(q){if("function"===typeof q){var p=f.onload;f.onload="function"===typeof p?function(){p();q()}:q}};j.push({"gtm.start":new Date().getTime(),event:"gtm.js"});n("//www.googletagmanager.com/gtm.js?id=GTM-NKDL29","google-tag-manager");if(artspace.include_third_party){if(artspace.include_facebook_like){n("//connect.facebook.net/en_US/all.js","facebook-jssdk")}n("//platform.twitter.com/widgets.js","twitter-wjs");n("//platform.tumblr.com/v1/share.js","tumblr-share");if(!m.querySelector("body#e404")&&!m.querySelector("body.is_preview")){n("//ak.sail-horizon.com/horizon/v1.js","sailthru-v1");var g=window.onload;window.onload=function(){if(typeof g==="function"){g()}Sailthru.setup({domain:"horizon.artspace.com"})}}f._sf_async_config={uid:25838,domain:"artspace.com"};f._sf_endpt=(new Date()).getTime();d(function h(){n((o?"https://a248.e.akamai.net/chartbeat.download.akamai.com/102508/":"http://static.chartbeat.com/")+"js/chartbeat.js","chartbeat")});f.adroll_adv_id="QJX67HRK4BDVNKJPEQKPFQ";f.adroll_pix_id="V5ECRZJ5HFFVZBTGNLBRHN";d(function h(){f.__adroll_loaded=!0;n((o?"https://s.adroll.com":"http://a.adroll.com")+"/j/roundtrip.js","adroll-roundtrip")})}}(window,document,"script");(function(c){var d={checkClass:"custom-checkbox",change:function(){}};function b(g,h){var k=this,j=false,f,e,h=h||_.pick(g.data(),_.keys(d));h=c.extend({},d,h);this.init=function(){f=c("<div>",{"class":h.checkClass,"data-input-name":g.attr("name")}),e=g.siblings('label[for="'+g.attr("id")+'"]');f.append(c("<span>"));if(g.prop("checked")){f.addClass("checked")}if(g.prop("disabled")){f.addClass("disabled");e.addClass("disabled")}if(g.attr("title")){f.attr("title",g.attr("title"))}g.change(function(){k.toggleBox()});f.click(function(){k.click();return false});g.hide().after(f);j=g.filter('input[type="radio"]').length>0?true:false;return g};this.click=function(){return g.click()};this.toggleBox=function(){if(g.prop("checked")){if(j){c('div[data-input-name="'+g.attr("name")+'"]').removeClass("checked")}f.addClass("checked")}else{f.removeClass("checked")}f.toggleClass("disabled",g.prop("disabled"));if(typeof change=="function"){change(g,g.prop("checked"))}return g};this.check=function(){if(!g.prop("checked")){g.prop("checked",true);k.toggleBox()}return g};this.uncheck=function(){if(g.prop("checked")){g.prop("checked",false);k.toggleBox()}return g};this.refresh=function(){k.toggleBox()};this.show=function(){f.show()};this.hide=function(){f.hide()};this.init()}c.fn.customCheckbox=function(e){return this.each(function(){if(typeof e=="object"||typeof e=="undefined"){c(this).data("customcheckbox",new b(c(this),e))}else{if(c(this).data("customcheckbox")){c(this).data("customcheckbox")[e]()}}})}})(jQuery);var artspace=artspace||{};artspace.profiles=artspace.profiles||{};$.extend(true,artspace.profiles,{follow_template:'<div class="col-sm-4"><p class="name"><%= name %></p><div class="follow following" data-obj-id="<%= obj_id %>" data-obj-type="<%= obj_type %>" data-following="1"><span class="icon"></span><div class="following-text" data-hover-toggle="Stop following" data-hover-default="You are following">You are following</div><div class="not-following-text">Interested in this?</div></div></div>',signup_choices_template:'<li><input type="checkbox" name="<%= obj_type %>_<%= obj_id %>" id="<%= obj_type %>_<%= obj_id %>" value="<%= obj_id %>" checked><label for="<%= obj_type %>_<%= obj_id %>"><%= name %></label></li>',signup_email:"",init_signup:function(){var c=$.deparam(window.location.search.substring(1));if(c.email){artspace.profiles.signup_email=c.email;$(".step.step1").find(".signup-bar").css("opacity",0);$(".step.step1").removeClass("current").addClass("completed");var b=$(".step.step2").addClass("current").offset().top*0.9;$("body,html").animate({scrollTop:b},"slow")}$(".step.current .overlay").hide();$(".step2").find('input[type="checkbox"], input[type="radio"]').customCheckbox();artspace.profiles.init_signup_forms();artspace.profiles.typeahead_autocomplete=artspace.profiles.typeahead_autocomplete_signup;artspace.profiles.init_typeahead();if(c.email_sp){$("input[name='email']").val(c.email_sp);setTimeout(function(){$("#subscribe-form .btn").click()},1000)}},init_preferences:function(){$(".collector-type").find(":input").change(function(){var b=$(this);if(b.prop("checked")){artspace.profiles.save_profile({collector_type:b.val()})}});$("#update_birthday").click(function(){var d=$("#birthday_month").val(),b=$("#birthday_day").val(),c=$("#birthday_year").val();artspace.profiles.save_profile({birthday:d+"/"+b+"/"+c},$(this))});$("#is_subscriber").on("change",function(){$('label[for="is_subscriber"]').toggleClass("subscribed");artspace.profiles.save_profile({is_subscriber:$(this).prop("checked")?1:0})});$(".sections").find('input[type="checkbox"], input[type="radio"]').customCheckbox();artspace.profiles.typeahead_autocomplete=artspace.profiles.typeahead_autocomplete_preferences;artspace.profiles.init_account_nav();artspace.profiles.init_add_buttons();artspace.profiles.init_typeahead()},init_account_nav:function(){var f=$(".nav-holder"),b=f.find("#nav-links"),e=f.find(".menu-more"),d=f.height(),c=f.find("#nav-links li").outerHeight();e.click(function(){if(f.hasClass("closed")){f.animate({height:d},function(){$(this).removeClass("closed")});b.animate({top:0})}else{f.animate({height:c},function(){$(this).addClass("closed")});b.animate({top:-1*f.find(".selected").position().top})}});if(e.is(":visible")){e.click()}},init_signup_forms:function(){$(".utm_campaign").val(artspace.tracking.utm_campaign||(artspace.tracking.gclid?"signup-page-paid-search":"signup-page-organic"));var d=$("#signup_preferences"),c=d.find('input[type="password"]'),b=$("#subscribe-form").attr("data-label"),e=d.attr("data-label");SubscribeView=artspace.FormView.extend({report:function(k){this.$input.blur();try{var g=k.get("data"),f=k.get("statusCode"),j=k.get("message");if(k.get("status")=="ok"||f==7){if(j=="Email Already Subscribed"){$(".header.completed").children("h2").html("You're Already Subscribed!")}artspace.profiles.signup_email=k.get("email");artspace.profiles.signup_is_customer=g.is_customer;if(artspace.profiles.signup_is_customer){d.attr("action","/profiles/login_save");c.attr("placeholder","Enter your password");$(".step3 .header.current h2").text("Your Preferences Have Been Updated")}artspace.profiles.signup_next();if(f!=7){artspace.track("Member Sign Up","Success");artspace.tracking.push_conversion_success(b)}}else{this.$input.val("").addClass("error").removeClass("loading").attr("placeholder",j)}artspace.modals.append_tracking_cookie(g.subscriber_id);dataLayer.push({event:"Newsletter Sign Up"})}catch(h){this.$input.val("").removeClass("loading").addClass("error").attr("placeholder","Sorry, something went wrong :(").focus()}}}),subscribe_view=new SubscribeView({el:".step1 .input-holder"});d.validate();d.submit(function(){var f=$(this);if(!f.valid()){return false}c.addClass("loading");f.find('input[type="password"]').blur();data=artspace.profiles.prep_signup_data();data.email=artspace.profiles.signup_email;$.ajax({type:"POST",url:f.attr("action"),data:data,success:function(g){c.removeClass("loading");if(g.status=="ok"){artspace.profiles.signup_next();artspace.profiles.suggest_works();artspace.track("Account Create","Account Create Success",e);dataLayer.push({event:"Member Sign Up"})}else{c.val("").attr("placeholder",g.message)}}});return false})},init_typeahead:function(){var b="/search/autocomplete/artists.json?term=%QUERY";var d="/search/autocomplete/partners.json?term=%QUERY";var c={compile:function(e){var f=_.template(e);return{render:function(g){return f(g)}}}};$("#artist_input").typeahead([{name:"artist",remote:b,template:"<p><%= html %></p>",engine:c}]);$("#partner_input").typeahead([{name:"partner",remote:d,template:"<p><%= html %></p>",engine:c}]);$("#artist_input, #partner_input").on("typeahead:selected",artspace.profiles.typeahead_autocomplete)},init_add_buttons:function(){$("#add_artist, #add_partner").click(function(){var g=$(this),b=g.data("obj-id"),e=g.data("obj-type"),c=g.data("obj-name");if(typeof(b)!=="undefined"&&b){var h=$("#"+e+"_follow"),f=false;$("#"+e+"_input").val("");h.find(".follow").each(function(){if($(this).data("obj-id")==b){f=true;return false}});if(f){return false}var j=$(_.template(artspace.profiles.follow_template,{obj_id:b,obj_type:e,name:c})),d=j.find(".follow");$row=h.find(".row").last();$row.prepend(j);artspace.follows.init_follows(d);artspace.follows.follow(b,e,g.data("following"),"pref_page",function(l,k){result=$.parseJSON(l.responseText);if(k!=="success"||!result||!result.status){artspace.follows.toggle_follow_state(b,e,false)}});g.data("obj-id",false)}});$("#artist_input, #partner_input").keydown(function(b){if(b.keyCode==13){$("#add_"+$(this).data("obj-type")).click()}})},init_order_toggle:function(){$(".order-brief").on("click",function(){var b=$(this).parent();b[b.hasClass("open")?"removeClass":"addClass"]("open")})},init_form_toggle:function(){$(".item-controls > a").on("click",function(c){var b=$(this.hash);b[b.hasClass("open")?"removeClass":"addClass"]("open");c.preventDefault()})},save_profile:function(e,d){if(typeof(d)!=="undefined"){var b=d.find("span"),f=d.data("save-toggle"),c=b.text();b.fadeOut("fast",function(){var g=$(this);g.text(f)}).fadeIn("fast",function(){var g=$(this);setTimeout(function(){g.fadeOut("fast",function(){g.text(c)}).fadeIn("fast")},2000)})}$.ajax({data:e,type:"POST",xhrFields:{withCredentials:true},crossDomain:true,url:"https://"+window.location.host+"/profiles/update_profile"})},prep_signup_data:function(){var b=$("#signup_preferences"),c=[],d={};b.find(".medium, .artist, .partner").find('input[type="checkbox"]').each(function(){var e=$(this);if(e.prop("checked")){c.push({obj_id:e.val(),obj_type:e.attr("name").replace("_"+e.val(),""),obj_source:"signup_page",obj_utm_campaign:artspace.tracking.utm_campaign})}});d.follows=JSON.stringify(c);b.find('input[type="hidden"], input[type="radio"], input[type="password"]').each(function(){var e=$(this);d[e.attr("name")]=e.val()});return d},signup_next:function(){var d=$(".step.current"),c=d.parent();d.addClass("completed");var b=c.next().find(".step");setTimeout(function(){d.removeClass("current").find(".overlay").fadeIn("fast",function(){if($(window).width()<767){new_st=c.offset().top;$("body,html").animate({scrollTop:new_st},"slow");c.animate({height:0})}else{new_st=b.offset().top-($(window).height()*0.1);$("body,html").animate({scrollTop:new_st},"slow")}b.addClass("current").find(".overlay").fadeOut()})},1000)},suggest_works:function(){$.ajax({type:"POST",url:"/profiles/get_personalized_works",data:{email:artspace.profiles.signup_email},success:function(b){$(".personalized-works").children().each(function(d){var e=$(this),c=b.works[d];e.animate({opacity:0},function(){e.find("a").attr("href",c.l);e.find("img").attr("src",c.i);e.find(".title").text(c.t);e.find(".artist").text(c.a)}).animate({opacity:1})})}})},typeahead_autocomplete_preferences:function(b,c,d){$("#add_"+d).data("obj-id",c.id).data("obj-name",c.value)},typeahead_autocomplete_signup:function(b,d,e){var c=$("ul.choices."+e);if(!$("ul.choices."+e).is(":visible")){c.show()}var f=$(_.template(artspace.profiles.signup_choices_template,{name:d.value,obj_id:d.id,obj_type:e}));f.prependTo(c).find('input[type="checkbox"]').customCheckbox();$("#"+e+"_input").val("")}});$(document).ready(function(){if($("#signup-landing").length>0){artspace.profiles.init_signup()}else{if($("#preferences").length>0){artspace.profiles.init_preferences()}else{if($("#my-orders").length>0){artspace.profiles.init_order_toggle();artspace.profiles.init_account_nav()}else{if($("#account-summary").length>0){artspace.profiles.init_form_toggle()}}}}});WallWorkModel=WorksGenericModel.extend({defaults:{artist_name:undefined,heights:undefined,image:undefined,medium:"",orig_image_size:undefined,title:undefined,units:undefined,widths:undefined,year:false,artist_link:undefined,work_link:undefined,artist_visible:undefined,frame_choice:false,size_choice:0,zoom_path:undefined},idAttribute:"work_id",initialize:function(){WorksGenericModel.prototype.initialize.call(this);if(this.valid_for_wall()){this.compact_sizes();this.convert_sizes()}},compact_sizes:function(){var d=this.get("heights"),e=this.get("widths"),f=this.get("depths");for(var c=0;c<d.length;c++){for(var b=c+1;b<d.length;b++){if(!_.isNumber(d[b])||d[b]==0||d[c]==d[b]){d.splice(b,1);e.splice(b,1);f.splice(b,1);b--}}}},convert_sizes:function(){var b={heights:_.clone(this.get("heights")),widths:_.clone(this.get("widths")),depths:_.clone(this.get("depths"))};for(s in b){if(this.get("units")=="cm"){_.each(b[s],function(d,c,e){e[c]=d*0.3937})}this.set("inch_"+s,b[s])}},get_frame_color:function(){if(this.has("frames")&&this.has("frame_choice")&&_.isNumber(this.get("frame_choice"))&&this.has("size_choice")){return this.attributes.frames[this.attributes.size_choice][this.attributes.frame_choice].color}return false},get_product_id:function(){if(this.attributes.products){return this.attributes.products[this.get("size_choice")]}return false},get_sizes:function(){var d=this.get("heights"),f=this.get("widths"),g=this.get("depths"),e=[];for(var c=0;c<d.length;c++){var b=parseInt(d[c]).toFixed(2)+'" x '+parseInt(f[c]).toFixed(2)+'"';if(g[c]){b+=" x "+parseInt(g[c]).toFixed(2)+'"'}e.push(b)}return e}});WallSolrWorkModel=WallWorkModel.extend({attr_map:{d:"work_id",dt:"depths",fr:"frames",ht:"heights",ip:"image_path",is:"orig_image_size",l:"image",m:"medium",n:"artist_name",t:"title",u:"units",wd:"widths",x:"exclude",y:"year",al:"artist_link",wl:"work_link",v:"artist_visible"},initialize:function(){this.map_attributes();return WallWorkModel.prototype.initialize.call(this)},map_attributes:function(){var b;for(a in this.attr_map){if(this.get(a)!==undefined){b=this.get(a);if(a=="is"&&_.isArray(b)){b={width:b[0],height:b[1]}}this.set(this.attr_map[a],b);delete this.attributes[a]}}}});WallWorksCollection=WorksGenericCollection.extend({model:WallSolrWorkModel,initialize:function(){this.listenTo(this,"add",this.check_allowed);this.listenTo(this,"reset",this.check_allowed_reset);this.listenTo(this,"remove",this.remove_model)},parse:function(b,c){if(b.works){return b.works}return{}},check_allowed:function(c,d,b){if(!c.valid_for_wall()){d.remove(c)}},check_allowed_reset:function(d,b){var d=this,c=[];_.each(this.models,function(f,e,g){if(!f.valid_for_wall()){c.push(f)}});d.remove(c)},remove_model:function(c,d,b){if(c.view){c.view.remove()}}});WallWorkView=Backbone.View.extend({initialize:function(b){this.template=_.template('<img class="wall-img" src="<%= image %>">');this.model=b.model;this.wall=b.wall;if(!this.model.attributes.size_choice){this.model.set("size_choice",0)}this.listenTo(this.model,"change:frame_choice",this.change_frame);_.bindAll(this,"click","error","loaded")},render:function(){this.$el=$(this.template(this.model.attributes));this.$spacer=$("<img>",{"class":"wall-spacer",src:"/static/common/img/blank.gif"});this.scale(true);this.$el.on("click",this.click);this.$el.on("load",this.loaded);this.$el.on("error",this.error);return this.$el.add(this.$spacer)},change_frame:function(e,d){console.log("blah change frame");var f=e.get("frames"),c=e.get("size_choice"),b=e.get("frame_choice");if(b!==false&&f[c][b]){this.size_frame();this.$el.addClass("framed").removeClass("black white maple").addClass(f[c][b].color);this.model.set("is_framed",true)}else{this.$el.css({margin:"0",padding:"0"});this.$el.removeClass("framed");this.model.set("is_framed",false)}},click:function(c){var b=this.get_index();if(b==this.wall.current_work_index){artspace.imagezoom.showWallZoom(this.model.attributes,this.$el.height(),true);this.wall.$el.addClass("zooming")}else{this.wall.change_work(this.get_index())}this.wall.pause();return false},error:function(){this.wall.collection.remove(this.model);this.$el.add(this.$spacer).remove();this.wall.reset_work_index();this.wall.move()},get_index:function(){return this.wall.collection.indexOf(this.model)},loaded:function(b){this.$el.addClass("loaded").width("auto")},normalize:function(){this.$el.css({height:"80%",top:"10%"})},remove:function(){this.stopListening();this.$el.remove();this.$spacer.remove()},scale:function(d){var f=50,b=false,c=100-((this.wall.hang_height/this.wall.wall_height)*100);var e=this.model.get("inch_heights")[this.model.get("size_choice")];if(!isNaN(e)){var g=this.model.get("orig_image_size");f=(e/this.wall.wall_height)*100;if(g.height>0&&d){b=Math.round((f/100*this.wall.el_height)*g.width/g.height)}}if(b&&d){this.$el.css("width",b)}this.$el.css({height:f+"%",top:c-(f/2)+"%"})},size_frame:function(){var f=this.model.get("frames"),j=this.model.get("size_choice"),c=this.model.get("frame_choice");if(c!==false&&f[j][c]){var m=f[j][c].size.split("x"),g=(m[0]/this.wall.wall_height),l=[g*this.wall.el_height,(g*this.wall.el_height)*(m[1]/m[0])],b=Math.round(this.$el.height()),k=Math.round(this.$el.width()),d=0,e=0,h=(1.5/this.wall.wall_height)*this.wall.el_height;if(b>k){d=(Math.max(l[0],l[1])-b)/2;e=(Math.min(l[0],l[1])-k)/2}else{e=(Math.max(l[0],l[1])-k)/2;d=(Math.min(l[0],l[1])-b)/2}if(d<0){d=b*0.15}if(e<0){e=k*0.15}this.$el.css({"border-width":h,"margin-top":-1*d-h,padding:d+"px "+e+"px"})}},show:function(){var b=this;if(this.$el.hasClass("loaded")){this.$el.addClass("show")}else{this.$el.on("load",function(){b.$el.addClass("show")})}}});WallView=Backbone.View.extend({current_work_index:0,current_work:null,el:"#wall-holder",events:{"click .next":"next","click .prev":"previous",'click .size-holder input[name="size"]':"change_size",'click .size-holder input[name*="frame"]':"change_frame","click .ss-controls":"play","click .fs-controls":"toggle_fs","click .scale-controls":"toggle_scale","click .info-controls":"toggle_info","touchend #wall-slider":"touch_end","touchmove #wall-slider":"touch_move","touchstart #wall-slider":"touch_start"},figure_height_m:77*1.03,figure_height_f:68.34*1.03,hang_height:64,wall_height:120,scaled:true,work_load_buffer:10,initialize:function(){_.bindAll(this,"change_frame","change_size","close","keydown","next","pause","play","previous","resize","_show_info","toggle_arrows","toggle_fs","touch_end","touch_move","touch_start");this.$slider=this.$("#wall-slider");this.$figure_m=this.$("#scale-figure-m");this.$figure_f=this.$("#scale-figure-f");this.$info=this.$("#wall-info");if(this["collection"]){this.collection.trigger("reset",this.collection)}$(document).on("keydown",this.keydown);$(window).on("resize",this.resize);$("#wall-modal").on("hide.bs.modal",this.close);this.toggle_controls()},render:function(){if(this.collection.length){this.set_sizes();this.$slider.empty();this.$figure_m.height((this.figure_height_m/this.wall_height*100)+"%");this.$figure_f.height((this.figure_height_f/this.wall_height*100)+"%");for(var c=0;c<this.collection.length;c++){var b=this.collection.at(c);b.view=new WallWorkView({model:b,wall:this});this.$slider.append(b.view.render())}this.change_work(this.current_work_index,true);this.show_works(this.current_work_index)}},change_size:function(c){$(c.currentTarget).blur();var b=$(c.currentTarget).parents("li");b.addClass("selected-size").siblings().removeClass("selected-size");b.find('.frame-holder input[value=""]').prop("checked",true);this.current_work.set({frame_choice:false,size_choice:c.currentTarget.value});this.current_work.view.scale();this.move();this._position_info_figure()},change_frame:function(b){$(b.currentTarget).blur();this.current_work.set("frame_choice",b.currentTarget.value);this.current_work.view.scale();this.move()},change_work:function(c,d){var b=this;if(!d){this.$slider.one($.support.transition.end,this._show_info)}this.move(c,!d,true);this.$figure_m.add(this.$figure_f).css("opacity",0);this.$info.stop(false,true).animate({opacity:0},200,function(){if(d||!$.support.transform3d){b._show_info()}});this.toggle_arrows()},_show_info:function(){this.fill_info();this.$info.stop().animate({opacity:1},200);this.$figure_m.add(this.$figure_f).css("opacity",1)},close:function(){this.remove();this.$figure_m.add(this.$figure_f).css("opacity",0);$("body").removeClass("disable-scroll")},_position_info_figure:function(){var b=$(window).width(),d=Math.max(this.current_work.view.$el.outerWidth(true)/b,300/b)*100,c=(50-d/2);this.$figure_m.css("left",(c-10)+"%");this.$figure_f.css("right",(c-10)+"%")},fill_info:function(){var c='<a href="'+this.current_work.get("work_link")+'">'+this.current_work.get("title")+"</a>";if(this.current_work.get("year")){c+=", <span>"+this.current_work.get("year")+"</span>"}this.$(".title").html(c);if(this.current_work.get("artist_visible")){var b='<a href="'+this.current_work.get("artist_link")+'">'+this.current_work.get("artist_name")+"</a>"}else{var b=this.current_work.get("artist_name")}this.$(".artist").html(b);this.$(".medium").html(this.current_work.get("medium"));this._position_info_figure();this.fill_size_info();this.fill_frame_info()},fill_frame_info:function(){var h=this.current_work.get("frames"),g=this.current_work.get("heights"),c=this.current_work.get("frame_choice"),k=_.template('<li class="work-frame-<%= color %>"><label><input type="radio" name="frame-<%= choice %>" value="<%= value %>"> <%= color %></label></li>');for(var e=0;e<g.length;e++){var b=this.$(".size-"+e+" .frame-holder");if(h&&h[e]){var f=h[e];b.append(k({value:"",choice:e,color:"none"}));for(var d=0;d<f.length;d++){b.append(k({value:d,choice:e,color:f[d].color}))}if(c&&e==this.current_work.get("size_choice")){b.find('[value="'+c+'"]').prop("checked",true)}else{b.find('[value=""]').prop("checked",true)}}else{b.remove()}}},fill_size_info:function(){var e=this.current_work.get_sizes(),f=this.current_work.get("frames");var b=this.$(".size-holder"),d=_.template('<li class="size-<%= value %>"><label><input type="radio" name="size" value="<%= value %>"> <%= text %></label><ul class="frame-holder"></ul></li>');b.empty();if(e.length>1||(f&&f[0])){for(var c=0;c<e.length;c++){b.append(d({value:c,text:e[c]}))}b.find("[value="+this.current_work.get("size_choice")+"]").prop("checked",true).parents("li").addClass("selected-size");b.show();this.$(".info-controls").show()}else{this.$(".info-controls").hide();b.hide()}},keydown:function(b){if(b.keyCode==37){this.previous()}else{if(b.keyCode==39){this.next()}}},load_after:function(){},load_before:function(){},_move:function(b,d){if($.support.transform3d){var c="translate3d("+d+"px, 0, 0)";b.css({"-webkit-transform":c,"-ms-transform":c,transform:c})}else{b.css("left",d)}},move:function(f,d,c){var e=$("#wall-floor");this.current_work_index=isNaN(f)?this.current_work_index:f;this.$slider.add(e).toggleClass("animate-slide",Boolean(d));if(this.current_work&&this.current_work.view){this.current_work.view.$el.removeClass("active-wall-img")}this.current_work=this.collection.at(this.current_work_index);this.current_work.view.$el.addClass("active-wall-img");var g=-1*(this.current_work.view.$el.position().left+this.current_work.view.$el.outerWidth(true)/2),b=g+this.el_width/2;this._move(this.$slider,b);if(c){this._move(e,g)}},next:function(b){if(this.current_work_index+1<this.collection.length){this.change_work(this.current_work_index+1);if(this.collection.length-this.current_work_index==this.work_load_buffer){this.load_after()}}else{this.pause()}return false},pause:function(){this.$(".ss-controls").removeClass("active");if(this.ss_interval){this.ss_interval=clearInterval(this.ss_interval)}},play:function(){if(!this.ss_interval){this.$(".ss-controls").addClass("active");this.ss_interval=setInterval(this.next,4000)}else{this.pause()}},previous:function(b){if(this.current_work_index-1>=0){this.change_work(this.current_work_index-1);if(this.current_work_index==this.work_load_buffer){this.load_before()}}return false},remove:function(){this.$el.attr("class","");this.$("#wall-controls").removeClass("active");$(document).off("keydown",this.keydown);$(window).off("resize",this.resize);$("#wall-modal").off("hide.bs.modal",this.close);this.collection.remove(this.collection.models);this.stopListening();this.undelegateEvents();this.collection.stopListening();delete this.current_work;delete this.collection;delete this.options},reset_work_index:function(){this.current_work_index=this.current_work.view.get_index()},resize:function(b){this.set_sizes();this.resize_frames();this.move()},resize_frames_handle:null,resize_frames:function(){var b=this;clearTimeout(this.resize_frames_handle);this.resize_frames_handle=setTimeout(function(){_.invoke(_.pluck(b.collection.where({is_framed:true}),"view"),"size_frame")},100)},set_sizes:function(){var b=this.$("#wall");this.el_height=b.height();this.el_width=b.width()},show:function(){$("#wall-modal").modal("show");this.render();$("body").addClass("disable-scroll");return this},show_works:function(c,b){if(c<0||c>=this.collection.length){return false}this.collection.at(c).view.show();if(!b){this.show_works(c-1,"left");this.show_works(c+1,"right")}else{if(b=="left"){return this.show_works(c-1,b)}else{return this.show_works(c+1,b)}}},toggle_arrows:function(){this.$(".prev").toggle(this.current_work_index!=0);this.$(".next").toggle(this.current_work_index<this.collection.length-1)},toggle_controls:function(){if(this.collection.length>1){this.$(".ss-controls, .fs-controls").css("display","inline-block")}else{this.$(".ss-controls, .fs-controls").hide()}},toggle_info:function(){this.$("#wall-info").toggleClass("open");this.$(".info-controls").toggleClass("active")},toggle_fs:function(){var c=this,b="normalize";this.$slider.css("visibility","hidden");this.$el.toggleClass("slideshow",this.scaled);this.$figure_m.add(this.$figure_f).hide();this.$(".fs-controls").toggleClass("active");if(!c.scaled){b="scale";this.$figure_m.add(this.$figure_f).hide()}var d=function(){_.each(c.collection.models,function(f,e,g){f.view[b]()});c.move();c._position_info_figure();c.$slider.css("visibility","visible");c.$figure_m.add(c.$figure_f).show();c.show_works(c.current_work_index)};this.current_work.view.$el.one($.support.transition.end,d);this.$(".wall-img").removeClass("show");this.scaled=!this.scaled;if(!$.support.transform3d){d()}},toggle_scale:function(d){var b=this.$(".scale-controls"),c=this.$figure_m.add(this.$figure_f);if(b.hasClass("active")){this.$figure_m.one($.support.transition.end,function(){c.hide()});c.css("opacity",0);b.removeClass("active")}else{c.show().css("opacity",1);b.addClass("active")}},touch_end:function(b){if(!this.touch_dir){return}if(this.touch_dir=="right"&&this.current_work_index>0){this.previous()}else{if(this.current_work_index<this.collection.length-1){this.next()}else{this.move(this.current_work_index,true)}}this.touch_dir=false},touch_move:function(b){b.preventDefault();curX=b.originalEvent.touches[0].pageX-this.touch_start_x;this.$slider.removeClass("animate-slide").css("left",this.touch_start_left+curX);this.touch_dir=curX>0?"right":"left"},touch_dir:false,touch_start_x:0,touch_start_left:0,touch_start:function(b){this.touch_start_x=b.originalEvent.touches[0].pageX;this.touch_start_left=parseInt(this.$slider.css("left"))},zoom_wall:function(b){this.$el.css("height",b+"%")}});SolrPageWallView=WallView.extend({current_page:1,lowest_loaded_page:1,highest_loaded_page:1,max_pages:false,work_placement:"after",initialize:function(b){_.bindAll(this,"add_works");WallView.prototype.initialize.call(this,b);if(b.module){this.module=b.module}else{return}var c=this;this.listenTo(artspace[this.module].collection,"sync",this.add_works);this.listenTo(artspace[this.module].collection.request,"change:page",function(e,f,d){c.current_page=f});this.lowest_loaded_page=this.highest_loaded_page=this.current_page=artspace[this.module].collection.request.get("page");if(this.collection.length){_.each(this.collection.models,function(e,d){e.set("page",c.lowest_loaded_page)})}this.pre_load_before()},add_works:function(g,d,e){if(d.pagination&&d.pagination.num_pages){this.max_pages=d.pagination.num_pages}if(d.works){var f=this,c=$();var b={};if(this.work_placement=="before"){b.at=0}_.each(d.works,function(h,j){h.page=f.work_placement=="before"?f.lowest_loaded_page:f.highest_loaded_page});this.collection.add(d.works,b);_.each(this.collection.models,function(j,h){if(!j.view){j.view=new WallWorkView({model:j,wall:f});c=c.add(j.view.render());if(!f.scaled){j.view.normalize()}}});this.limit_pages();if(this.work_placement=="before"){this.$slider.prepend(c)}else{this.$slider.append(c)}this.reset_work_index();this.move();this.toggle_arrows();this.show_works(this.current_work_index)}},close:function(){if(this.current_work){this.set_page(this.current_work.get("page"))}WallView.prototype.close.call(this)},load_after:function(){if(!this.max_pages||this.highest_loaded_page<this.max_pages){this.work_placement="after";this.set_page(++this.highest_loaded_page)}},load_before:function(){if(this.lowest_loaded_page>1){this.work_placement="before";this.set_page(--this.lowest_loaded_page)}},limit_pages:function(){if(this.highest_loaded_page-this.lowest_loaded_page>2){var b;if(this.work_placement=="before"){b=this.highest_loaded_page;this.highest_loaded_page--}else{b=this.lowest_loaded_page;this.lowest_loaded_page++}this.collection.remove(this.collection.where({page:b}));this.reset_work_index()}},pre_load_before:function(){if(this.lowest_loaded_page>1){this.load_before();this.set_page(++this.current_page)}},set_page:function(b){artspace[this.module].collection.request.set("page",b)}});$(function(){var b=false,c=[];if($("body#alist").length){b="art"}else{if($("body#partner").length){b="partner"}else{if($("body#collecting_detail").length){b="collecting"}}}if(b){$(".show-wall-view").click(function(){var d=new WallWorksCollection(artspace[b].collection.models[0].get("works"));if(d.valid_for_wall()){artspace.room_view=new SolrPageWallView({collection:d,module:b}).show()}return false})}else{if(artspace.works){if(artspace.works.valid_for_wall()){$(".show-wall-view").click(function(){artspace.room_view=new WallView({collection:new WallWorksCollection(_.pluck(artspace.works.models,"attributes"))}).show()})}else{$(".show-wall-view").hide()}}}});artspace.imagezoom={};artspace.imagezoom.zoomLevels=[33,66,100];artspace.imagezoom.tileSize=400;artspace.imagezoom.default_height=300;var rounding_allowance=10;artspace.imagezoom=artspace.imagezoom||{};artspace.imagezoom.ImageZoom=function(c,d,b,f,e){_.bindAll(this,"pinch","zoomIn","zoomOut");this.div_name=c;this.width=d;this.height=b;this.zoom=0;this.image=null;this.top=f||null;this.left=e||null};$.extend(true,artspace.imagezoom.ImageZoom.prototype,{pinch:function(b){return this.zoomEventHandler(b,b.originalEvent.scale-1)},render:function(b){if(typeof(b)=="undefined"){b=this.zoom}this.image.renderLayer(b);this.image.changeZoom(b,b)},setImage:function(b){this.image=b},_changeSlider:function(c){var b=$("#slider-vertical");if(!b.slider("option","disabled")){b.slider("option","value",b.slider("option","value")+c)}},setZoom:function(m){var b=m/100,g=$("#slider-vertical");if(this.divHeight!=undefined){var l=this.divHeight}if(this.divWidth!=undefined){var c=this.divWidth}var k=Math.round(artspace.imagezoom.starting_height)||artspace.imagezoom.default_height;if((this.image.height-k)<=0){g.slider("disable")}var j=Math.ceil((this.image.height-k)*b);j=Math.max(j,0);this.divHeight=k+j;this.divWidth=rounding_allowance+Math.ceil(this.image.width*(this.divHeight/this.image.height));if(b==0){var f=0}else{if(j==0){var f=2}else{for(var e=0;e<artspace.imagezoom.zoomLevels.length;e++){if(this.divHeight<=this.image.tileLayers[e].height&&f==undefined){var f=e}}}}if(f==this.zoom){if(f<2){this.image.tileLayers[f+1].preload()}}else{this.image.changeZoom(this.zoom,f);this.zoom=f;this.render()}var n=this.image.currentLayer.layerID();var d=this.divHeight/this.image.tileLayers[f].height;if(this.top==null){this.top=Math.floor(($(window).height()-this.divHeight)/2);this.left=Math.floor(($(window).width()-this.divWidth)/2)}else{if(m>0){this.top=this.top+((l-this.divHeight)/2);this.left=this.left+((c-this.divWidth)/2)}}var h=$("#"+n);h.css({height:this.divHeight,width:this.divWidth,top:this.top+"px",left:this.left+"px"});h.find(".tile").each(function(o,p){var t=$(this),q=Math.floor(t.attr("orig-height")*d),r=Math.floor(t.attr("orig-width")*d);t.children().add(t).css({height:q,width:r})})},zoomEventHandler:function(c,f){c.preventDefault();var d=$("#slider-vertical"),b=d.slider("option","value");if(f>0&&b<100){new_val=Math.min(b+3,100)}else{if(f<0&&b>0){new_val=Math.max(b-3,0)}}if(new_val&&!d.slider("option","disabled")){d.slider("option","value",new_val)}return false},zoomOut:function(b){this._changeSlider(-5)},zoomIn:function(b){this._changeSlider(5)}});artspace.imagezoom.Image=function(k,e,b,l){this.image_zoom=e;e.setImage(this);this.base_url=k;this.width=b;this.height=l;this.tileLayers=[];this.currentLayer=null;for(var d=0;d<artspace.imagezoom.zoomLevels.length;d++){var h=artspace.imagezoom.zoomLevels[d],f=h/100,j=f,c=b*j,g=l*j;if(c>g){if(c<artspace.imagezoom.tileSize){g=Math.floor(artspace.imagezoom.tileSize*(g/c));c=artspace.imagezoom.tileSize}}else{if(g<artspace.imagezoom.tileSize){c=Math.floor(artspace.imagezoom.tileSize*(c/g));g=artspace.imagezoom.tileSize}}g=Math.floor(g);c=Math.floor(c);this.tileLayers[d]=new artspace.imagezoom.TileLayer(this,d,c,g,artspace.imagezoom.tileSize)}this.currentLayer=this.tileLayers[0]};$.extend(true,artspace.imagezoom.Image.prototype,{changeZoom:function(d,c){for(var b=0;b<artspace.imagezoom.zoomLevels.length;b++){$("#"+this.currentLayer.layerID(b)).css({display:"none","z-index":0})}$("#"+this.currentLayer.layerID(c)).css({display:"block","z-index":10})},positionToPixels:function(d,c){var e=Math.floor(this.currentLayer.height*d+this.image_zoom.height/2);var b=Math.floor(this.currentLayer.width*c+this.image_zoom.width/2);return[b,e]},renderLayer:function(b){var c=this.tileLayers[b];this.currentLayer=c;c.render(b!=zoomer.zoom)}});artspace.imagezoom.TileLayer=function(f,r,c,p,q){this.base_url=f.base_url;this.image=f;this.zoom=r;this.width=c;this.height=p;this.tileSize=q;this.rendered=0;this.xCount=Math.ceil(c/q);this.yCount=Math.ceil(p/q);this.layerWidth=this.xCount*q;this.layerHeight=this.yCount*q;var k=this.layerHeight-this.height;var m=this.layerWidth-this.width;var l="";for(var h=0;h<this.yCount;h++){for(var j=0;j<this.xCount;j++){var g=h*q;var e=j*q;if((j+1)==this.xCount){var d=400-m}else{var d=400}if((h+1)==this.yCount){var n=400-k}else{var n=400}l+='<div id="'+this.tileID(j,h)+'" class="tile" orig-width="'+d+'" orig-height="'+n+'" style="width:'+d+"px;height:"+n+'px"></div>'}}var b=$('<div id="'+this.layerID()+'" class="tileLayer"  style="width:'+this.width+"px;height:"+this.height+'px">'+l+"</div>");var o=function(u,t){f.image_zoom.top=t.position.top;f.image_zoom.left=t.position.left};b.draggable({drag:o});$("#"+f.image_zoom.div_name).append(b)};$.extend(true,artspace.imagezoom.TileLayer.prototype,{imageSRC:function(b,f){var d=f*this.xCount+b;var c=(d%4)+1;var e=this.base_url.replace(/\/\/media[1-5]/i,"//media"+c).replace(/\/\/m[1-4]/i,"//m"+c);return e+artspace.imagezoom.zoomLevels[this.zoom]+"-tiles/"+this.leadingZeros(f*this.xCount+b,6)+".jpg"},layerID:function(b){if(b==null){b=this.zoom}return"layer_"+this.image.image_zoom.div_name+"_"+b},leadingZeros:function(c,b){c=c+"";while(c.length<b){c="0"+c}return c},preload:function(){if(!this.rendered){for(var b=0;b<this.yCount;b++){for(var c=0;c<this.xCount;c++){$thediv=$("#"+this.tileID(c,b),this.div);$thediv.html('<img src="'+this.imageSRC(c,b)+'">')}}this.rendered=1}},render:function(){if(!this.rendered){for(var b=0;b<this.yCount;b++){for(var c=0;c<this.xCount;c++){$thediv=$("#"+this.tileID(c,b),this.div);$thediv.html('<img src="'+this.imageSRC(c,b)+'">')}}this.rendered=1}},tileID:function(b,c){return"zm_"+this.image.image_zoom.div_name+"_"+this.zoom+"_"+b+"_"+c}});var zoomer={};zoomView=Backbone.View.extend({el:"#zoom-modal",events:{"click .close":"close"},initialize:function(b){this.workAttrs=b.workAttrs;$("#zoomwin").empty();this.buildZoomer();this.buildSlider();zoomer.render();zoomer.setZoom(this.getZoom());this.attachEvents();return false},attachEvents:function(){$("#zoomwin").off("mousewheel gesturechange").on("mousewheel",zoomer.zoomEventHandler).on("gesturechange",zoomer.pinch);$("#zoomwin .tileLayer").dblclick(function(){zoomer.zoomIn();zoomer.zoomIn()});$(".zoom-in").off("click").click(zoomer.zoomIn);$(".zoom-out").off("click").click(zoomer.zoomOut);$(".private-title").hide();_.bindAll(this,"close");$(document).on("keydown",this.close)},buildSlider:function(){this.$slider=$("#slider-vertical").slider({orientation:"vertical",range:"min",min:this.getZoom(),max:100,value:this.getZoom(),slide:this.sliderChange,change:this.sliderChange,disabled:false})},getZoom:function(h,g,d){h=h||0;g=g||100;d=d||false;var j=artspace.imagezoom.default_height,m=window.innerHeight,e=window.innerWidth,c=zoomer.image.height,k=zoomer.image.width,f,l,b;if((Math.abs(h-g)==1)||(d==true)){return h}f=Math.ceil((h+g)/2);l=(c-j)*(f/100)+j;b=rounding_allowance+Math.ceil(k*(l/c));if((l>m)||(b>e)){return this.getZoom(h,f,d)}else{if((l<m)&&(b<e)){if((Math.abs(l-m)<=20)||(Math.abs(b-e)<=20)){d=true;return this.getZoom(f,g,d)}return this.getZoom(f,g,d)}else{return this.getZoom(h,f,d)}}},buildZoomer:function(){var d,c;if(this.workOffset){d=this.workOffset.left;c=this.workOffset.top}zoomer=new artspace.imagezoom.ImageZoom("zoomwin",$(window).width(),$(document).height(),c,d);var b=new artspace.imagezoom.Image(this.workAttrs.zoom_path,zoomer,parseInt(this.workAttrs.orig_image_size.width),parseInt(this.workAttrs.orig_image_size.height))},close:function(){this.$el.hide();$(document).off("keydown",this.close);this.undelegateEvents();$(".private-title").show()},show:function(){this.$el.show()},sliderChange:function(b,c){zoomer.setZoom(c.value)}});wallZoomView=zoomView.extend({initialize:function(b){this.workOffset=b.workOffset;zoomView.prototype.initialize.call(this,b)},attachEvents:function(){this.$el.addClass("from-wall");zoomView.prototype.attachEvents.call(this)},close:function(){$("#wall-holder").removeClass("zooming");this.$el.removeClass("from-wall");artspace.room_view.show_works(artspace.room_view.current_work_index);zoomView.prototype.close.call(this)}});artspace.imagezoom.showZoom=function(b,c){this.starting_height=c;new zoomView({workAttrs:b}).show()};artspace.imagezoom.showWallZoom=function(c){var d,f,b=$("#zoom-modal"),e=$("#wall-slider").find(".active-wall-img");this.starting_height=e.height();f=parseInt(e.css("border-width"));d={top:e.offset().top-$(document).scrollTop()+parseInt(e.css("padding-top"))+f,left:e.offset().left+parseInt(e.css("padding-left"))+f};new wallZoomView({workAttrs:c,workOffset:d}).show()};$(document).ready(function(){$(".show-work-zoom").each(function(c,e){var d=$(e),b=d.data("work-id"),f=d.data();if(b&&artspace.works.get(b).valid_for_zoom()){d.show().click(function(g){artspace.imagezoom.showZoom(artspace.works.get(b).attributes);return false})}else{if(f.zoomPath&&f.origImageHeight&&f.origImageWidth){d.show().click(function(h){var g=$(this).data();artspace.imagezoom.showZoom({zoom_path:g.zoomPath,orig_image_size:{height:g.origImageHeight,width:g.origImageWidth}});return false})}else{if(!d.is("img")){d.hide()}}}})});